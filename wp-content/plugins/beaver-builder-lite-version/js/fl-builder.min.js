var FLBuilderColorPicker;function fl_slugify(e){e=encodeURIComponent(e.toString().toLowerCase().trim().replace(/["',]/g,"").replace(/\s/g,"-")).toLowerCase();const t="àáâäæãåāăąçćčđďèéêëēėęěğǵḧîïíīįìłḿñńǹňôöòóœøōõṕŕřßśšşșťțûüùúūǘůűųẃẍÿýžźż·/,:;";var i=new RegExp(t.split("").join("|"),"g");return e.toString().toLowerCase().replace(/\.+/g,"-").replace(/\:+/g,"").replace(/\s+/g,"-").replace(i,e=>"aaaaaaaaaacccddeeeeeeeegghiiiiiilmnnnnooooooooprrsssssttuuuuuuuuuwxyyzzz-----".charAt(t.indexOf(e))).replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")}!function(u){var i=[],t=navigator.userAgent.toLowerCase(),l="Microsoft Internet Explorer"===navigator.appName,n=l?parseFloat(t.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,o=l&&n<10,s=!1,r=["-moz-","-webkit-","-o-","-ms-"];function d(e,t){return e="top"===e?"top":"left",t=Array.isArray(t)?t:Array.prototype.slice.call(arguments,1),"webkit"===s?(n=[],i="top"===(i=e)?"0% 0%,0% 100%,":"0% 100%,100% 100%,",l=a(l=t),u.each(l,function(e,t){n.push("color-stop("+parseFloat(t.stop)/100+", "+t.color+")")}),"-webkit-gradient(linear,"+i+n.join(",")+")"):r[s]+"linear-gradient("+e+", "+t.join(", ")+")";var i,l,n}function a(e){var o=[],s=[],t=[],i=e.length-1;return u.each(e,function(e,t){var i=t,l=!1,n=t.match(/1?[0-9]{1,2}%$/);n&&(i=t.replace(/\s?1?[0-9]{1,2}%$/,""),l=n.shift()),o.push(i),s.push(l)}),!1===s[0]&&(s[0]="0%"),!1===s[i]&&(s[i]="100%"),s=function e(t){var i,l,n,o,s=0,r=t.length-1,d=0,a=!1;if(t.length<=2||u.inArray(!1,t)<0)return t;for(;d<t.length-1;)a||!1!==t[d]?a&&!1!==t[d]&&(r=d,d=t.length):(s=d-1,a=!0),d++;l=r-s;o=parseInt(t[s].replace("%"),10);i=(parseFloat(t[r].replace("%"))-o)/l;d=s+1;n=1;for(;d<r;)t[d]=o+n*i+"%",n++,d++;return e(t)}(s),u.each(s,function(e){t[e]={color:o[e],stop:s[e]}}),t}function c(e){var e=e.replace(/\s+/g,""),t=-1!==e.indexOf("rgba"),i=t?parseFloat(100*e.replace(/^.*,(.+)\)/,"$1")):100;return{value:e,alpha:i,rgba:t}}u.fn.flBuilderColorPickerGradient=function(){var e=arguments;return this.each(function(){o?function(e,l){var n,t,o,s,r;e="top"===e?"top":"left",l=Array.isArray(l)?l:Array.prototype.slice.call(arguments,1),n="top"===e?0:1,t=u(this),o=l.length-1,s='<div class="iris-ie-gradient-shim" style="position:absolute;'+(1==n?"height":"width")+":100%;"+(1==n?"left":"top")+":%start%;"+(1==n?"right":"bottom")+':%end%;filter:%filter%;" data-color:"%color%"></div>',r="","static"===t.css("position")&&t.css({position:"relative"}),l=a(l),u.each(l,function(e,t){var i;if(e===o)return!1;e=l[e+1],t.stop!==e.stop&&(i=100-parseFloat(e.stop)+"%",t.octoHex=new FLBuilderColor(t.color).toIEOctoHex(),e.octoHex=new FLBuilderColor(e.color).toIEOctoHex(),e="progid:DXImageTransform.Microsoft.Gradient(GradientType="+n+", StartColorStr='"+t.octoHex+"', EndColorStr='"+e.octoHex+"')",r+=s.replace("%start%",t.stop).replace("%end%",i).replace("%filter%",e))}),t.find(".iris-ie-gradient-shim").remove(),u(r).prependTo(t)}.apply(this,e):u(this).css("backgroundImage",d.apply(this,e))})},u.fn.flBuilderColorPickerRaninbowGradient=function(e,t){var i,l,n;for(e=e||"top",i="hsl(%h%,"+(t=u.extend({},{s:100,l:50},t)).s+"%,"+t.l+"%)",l=0,n=[];l<=360;)n.push(i.replace("%h%",l)),l+=30;return this.each(function(){u(this).flBuilderColorPickerGradient(e,n)})},(FLBuilderColorPicker=function(e){this._html='<div class="fl-color-picker-ui"><div class="iris-picker"><div class="iris-picker-inner"><div class="iris-square"><a class="iris-square-value" href="javascript:void(0);"><span class="iris-square-handle ui-slider-handle"></span></a><div class="iris-square-inner iris-square-horiz"></div><div class="iris-square-inner iris-square-vert"></div></div><div class="iris-slider iris-strip"><div class="iris-slider-offset"></div></div></div></div></div>';this.options=u.extend({},{elements:null,color:"",mode:"hsl",controls:{horiz:"s",vert:"l",strip:"h"},target:!1,width:200,presets:[],globals:function(){return{bb:[],wp:[],theme:[]}},labels:{colorPresets:"Color Presets",colorPicker:"Color Picker",placeholder:"Paste color here...",removePresetConfirm:"Are you sure?",noneColorSelected:"None color selected.",alreadySaved:"%s is already a saved preset.",noPresets:"Add a color preset first.",presetAdded:"%s added to presets!"}},e),(!1==o||!0==o&&7<n)&&this._init()}).prototype={_html:"",_color:"",_currentElement:"",_inited:!1,_defaultHSLControls:{horiz:"s",vert:"l",strip:"h"},_defaultHSVControls:{horiz:"h",vert:"v",strip:"s"},_scale:{h:360,s:100,l:100,v:100},_init:function(){var e=this;u(e.options.elements,window.parent.document);u("html",window.parent.document).hasClass("fl-color-picker-init")?(this._buildPresetsUI(),this._presetsControls(),this._globalColorControls(),this._prepareColorFields()):(this._color=new FLBuilderColor("#ff0000").setHSpace(e.options.mode),i=this.options.presets,!1===s&&function(){var i,l="backgroundImage";o?s="filter":(i=u('<div id="iris-gradtest" />'),u.each(r,function(e,t){if(i.css(l,t+"linear-gradient(top,#fff,#000)"),i.css(l).match("gradient"))return s=e,!1}),!1===s&&(i.css("background","-webkit-gradient(linear,0% 0%,0% 100%,from(#fff),to(#000))"),i.css(this.bgImageString).match("gradient"))&&(s="webkit"),i.remove())}(),e.picker=u(this._html).appendTo(u("body",window.parent.document)),l?9===n?e.picker.addClass("iris-ie-9"):n<=8&&e.picker.addClass("iris-ie-lt9"):t.indexOf("compatible")<0&&t.indexOf("khtml")<0&&t.match(/mozilla/)&&e.picker.addClass("iris-mozilla"),e.controls={square:e.picker.find(".iris-square"),squareDrag:e.picker.find(".iris-square-value"),horiz:e.picker.find(".iris-square-horiz"),vert:e.picker.find(".iris-square-vert"),strip:e.picker.find(".iris-strip"),stripSlider:e.picker.find(".iris-strip .iris-slider-offset")},"hsv"===e.options.mode&&e._has("l",e.options.controls)?e.options.controls=e._defaultHSVControls:"hsl"===e.options.mode&&e._has("v",e.options.controls)&&(e.options.controls=e._defaultHSLControls),e.hue=e._color.h(),this._setTemplates(),this._ui=u(".fl-color-picker-ui",window.parent.document),this._iris=u(".iris-picker",window.parent.document),this._wrapper=u("body",window.parent.document),this._ui.prepend(this._hexHtml).append(this._presetsHtml),e.element=this._ui.find(".fl-color-picker-input"),e._initControls(),e.active="external",e._change(),e._addInputListeners(e.element),this._buildPresetsUI(),this._presetsControls(),this._globalColorControls(),this._prepareColorFields(),this._pickerControls(),this._buildAlphaUI(),u("html",window.parent.document).addClass("fl-color-picker-init"))},_prepareColorFields:function(){var o=this;u(".fl-color-picker-value",window.parent.document).each(function(){var e=u(this),t=e.val(),i=e.parent().find(".fl-color-picker-color"),l=c(t),n="";t&&(i.hasClass("fl-color-picker-alpha-enabled")&&l.rgba?n=e.val().toString():e.hasClass("fl-react-color-picker-value")||i.hasClass("fl-color-picker-alpha-enabled")||!l.rgba?n=l.value.startsWith("var")?FLBuilderColor(l.value).toDisplay():"#"+e.val().toString():(l=(l=t.replace("rgba","rgb")).substr(0,l.lastIndexOf(","))+")",o._color._alpha=1,n=l,e.val(l)),i.css({backgroundColor:n}))})},_setTemplates:function(){this._alphaHtml='<div class="fl-alpha-wrap"><div class="fl-alpha-slider"></div><div class="fl-alpha-slider-offset"></div><div class="fl-alpha-text"></div></div>',this._presetsHtml='<div class="fl-color-picker-presets"><div class="fl-color-picker-presets-toggle"><div class="fl-color-picker-presets-open-label fl-color-picker-active">'+this.options.labels.colorPresets+' <span class="fl-color-picker-icon-arrow-up"></span></div><div class="fl-color-picker-presets-close-label">'+this.options.labels.colorPicker+' <span class="fl-color-picker-icon-arrow-down"></span></div></div><div class="fl-color-picker-presets-list-wrap"><div class="fl-color-picker-presets-label">Static Colors</div><ul class="fl-color-picker-presets-list"></ul><div class="fl-color-picker-globals-label" data-type="bb">Global Colors</div><ul class="fl-color-picker-globals-list" data-type="bb"></ul><div class="fl-color-picker-globals-label" data-type="theme">Theme Colors</div><ul class="fl-color-picker-globals-list" data-type="theme"></ul><div class="fl-color-picker-globals-label" data-type="wp">WordPress Colors</div><ul class="fl-color-picker-globals-list" data-type="wp"></ul></div></div>',this._hexHtml='<input type="text" class="fl-color-picker-input" placeholder="'+this.options.labels.placeholder+'"><div class="fl-color-picker-preset-add"></div>',this._presetsTpl='<li class="fl-color-picker-preset"><span class="fl-color-picker-preset-color"></span> <span class="fl-color-picker-preset-label"></span> <span class="fl-color-picker-preset-remove fl-color-picker-icon-remove"></span></li>',this._noPresetsTpl='<div class="fl-color-picker-no-preset"><span class="fl-color-picker-preset-label">'+this.options.labels.noPresets+"</span></div>"},_has:function(i,e){var l=!1;return u.each(e,function(e,t){if(i===t)return!(l=!0)}),l},_buildPresetsUI:function(){var i,l=this,e=this.options.globals(),t=!1;for(i in u(".fl-color-picker-presets-list").empty(),u(".fl-color-picker-globals-list").empty(),0<this.options.presets.length?u.each(this.options.presets,function(e,t){l._addPresetView(t)}):(u(".fl-color-picker-presets-label").hide(),u(".fl-color-picker-presets-list").hide()),Array.isArray(e.bb)&&(e.bb=e.bb.filter(function(e){return!!e.color})),e)0<e[i].length?(t=!0,u.each(e[i],function(e,t){l._addGlobalColorView(i,t)})):(u('.fl-color-picker-globals-label[data-type="'+i+'"]').hide(),u('.fl-color-picker-globals-list[data-type="'+i+'"]').hide());0!==this.options.presets.length||t||u(".fl-color-picker-presets-list-wrap").append(this._noPresetsTpl)},_addGlobalColorView:function(e,t){var i=u(this._presetsTpl),l=t.color;l.match(/^(var|rgb|hs(l|v))a?\(/)||l.startsWith("#")||(l="#"+l),i.data("color",t).find(".fl-color-picker-preset-color").css({backgroundColor:FLBuilderColor(l).toDisplay()}).end().find(".fl-color-picker-preset-label").html(t.name||t.label),u('.fl-color-picker-globals-label[data-type="'+e+'"]').attr("data-has-colors",1),u('.fl-color-picker-globals-list[data-type="'+e+'"]').attr("data-has-colors",1).append(i)},_toggleGlobalColorView:function(e){var t=this._ui.find(".fl-color-picker-globals-label[data-has-colors]"),i=this._ui.find(".fl-color-picker-globals-list[data-has-colors]"),l=!!e.find(".fl-global-color-field").length,e=!!e.find(".fl-field-connection").length;l||!e?(t.hide(),i.hide()):(t.show(),i.show())},_globalColorControls:function(){var l=this,n=l._ui.find(".fl-color-picker-presets-list-wrap");u(".fl-color-picker-globals-list").off("click").on("click",".fl-color-picker-preset",function(){var e=u(this),t=l._currentElement.parents(".fl-field"),t=!!t.find(".fl-field-connection-compound").length?l._currentElement:t,e=e.data("color"),i=(i=e.color).match(/^(var|rgb|hs(l|v))a?\(/)||i.startsWith("#")?FLBuilderColor(i).toDisplay():"#"+i,i=e.uid?"global_color_"+e.uid:"theme_color_"+e.slug,e=FLBuilderConfig.globalColorLabels[i],i={property:i,object:"site",field:"color",settings:null};n.slideToggle(500),l._togglePicker(),FLThemeBuilderFieldConnections._connectField(t,e,i)})},_addPresetView:function(e){u(".fl-color-picker-presets-label").show(),u(".fl-color-picker-presets-list").show(),u(".fl-color-picker-no-preset").remove();var t=u(this._presetsTpl),i=FLBuilderColor(e);t.attr("data-color",e).find(".fl-color-picker-preset-color").css({backgroundColor:i.toDisplay()}).end().find(".fl-color-picker-preset-label").html(i.toString()),u(".fl-color-picker-presets-list").append(t)},_addPresetFeedback:function(){this._ui.append('<div class="fl-color-picker-added"><div class="fl-color-picker-added-text"><div class="fl-color-picker-icon-check"></div> "'+this.options.labels.presetAdded.replace("%s",this._color.toString())+'"</div></div>'),this._ui.find(".fl-color-picker-added").hide().fadeIn(200).delay(2e3).fadeOut(200,function(){u(this).remove()})},_pickerControls:function(){var i=this;this._wrapper.on("click",".fl-color-picker-color",function(){var e=u(this);i._currentElement=e.parent().find(".fl-color-picker-value"),i._toggleGlobalColorView(e.parents(".fl-field")),i._ui.position({my:"left top",at:"left bottom",of:e,collision:"flip",within:window.parent,using:function(e,t){i._ui.hasClass("fl-color-picker-active")||i._togglePicker(e)}})}).on("click",".fl-color-picker-clear",function(){var e=u(this);i._currentElement=e.parent().find(".fl-color-picker-value"),e.prev(".fl-color-picker-color").css({backgroundColor:"transparent"}).addClass("fl-color-picker-empty"),i._setColor(""),i.element.val(""),i._currentElement.val("").trigger("change")}),u(window.parent.document).add(document).on("mousedown",function(e){u(e.target).closest(".fl-color-picker-ui").length||(presets=i._ui.find(".fl-color-picker-presets"),presetsCloseLabel=presets.find(".fl-color-picker-presets-close-label"),presetsList=presets.find(".fl-color-picker-presets-list"),presetsCloseLabel.hasClass("fl-color-picker-active")&&0<(list=presetsList.find("li").find("span.fl-color-picker-preset-label")).length&&(presets=[],u.each(list,function(e,t){presets.push(u(t).text())}),u(FLBuilder.colorPicker).trigger("presetSorted",{presets:presets})),u(".fl-color-picker-ui.fl-color-picker-active",window.parent.document).removeClass("fl-color-picker-active"))})},_presetsControls:function(){var i=this,e=i._ui.find(".fl-color-picker-preset-add"),l=i._ui.find(".fl-color-picker-presets"),n=l.find(".fl-color-picker-presets-open-label"),o=l.find(".fl-color-picker-presets-close-label"),s=l.find(".fl-color-picker-presets-list-wrap"),t=l.find(".fl-color-picker-presets-list");e.off("click").on("click",function(){i._addPreset(i.element.val())}),s.css({height:i.element.innerHeight()+i._iris.innerHeight()+14+"px"}).hide(),t.sortable(),l.off("click").on("click",".fl-color-picker-presets-toggle",function(){o.hasClass("fl-color-picker-active")&&0<(list=t.find("li").find("span.fl-color-picker-preset-label")).length&&(l=[],u.each(list,function(e,t){l.push(u(t).text())}),u(FLBuilder.colorPicker).trigger("presetSorted",{presets:l})),n.toggleClass("fl-color-picker-active"),o.toggleClass("fl-color-picker-active"),s.slideToggle(500)}),t.off("click").on("click",".fl-color-picker-preset",function(e){var t=new FLBuilderColor(u(this).data("color").toString());i._setColor(t),i._currentElement.parent().find(".fl-color-picker-color").css({backgroundColor:t.toDisplay()}).removeClass("fl-color-picker-empty"),n.toggleClass("fl-color-picker-active"),o.toggleClass("fl-color-picker-active"),s.slideToggle(500)}).on("click",".fl-color-picker-preset-remove",function(e){e.stopPropagation(),i._removePreset(u(this).parent().data("color"))})},_removePreset:function(e){var t;confirm(this.options.labels.removePresetConfirm)&&(e=e.toString(),-1<(t=i.indexOf(e))&&(i.splice(t,1),this.options.presets=i,u(".fl-color-picker-presets-list").find('.fl-color-picker-preset[data-color="'+e+'"]').slideUp(function(){u(this).remove()})),i.length<1&&(u(".fl-color-picker-presets-label").hide(),u(".fl-color-picker-presets-list").hide()),u(this).trigger("presetRemoved",{presets:i}))},_addPreset:function(e){if(!this._CheckValidColor(e))return alert(this.options.labels.noneColorSelected),!1;e=e.toString().replace(/^#/,"");""===e?alert(this.options.labels.noneColorSelected):-1<i.indexOf(e)?alert(this.options.labels.alreadySaved.replace("%s","#"+e)):(this._addPresetView(e),this._addPresetFeedback(),i.push(e),this.options.presets=i,u(this).trigger("presetAdded",{presets:i}))},_CheckValidColor:function(e){var t;return!!(e.match(/^#/)||e.match(/^rgb/)||e.match(/^hsl/)||e.match(/^var/))&&((t=window.parent.document.getElementById("divValidColor"))||((t=window.parent.document.createElement("div")).id="divValidColor"),t.style.borderColor="",t.style.borderColor=e,0!=t.style.borderColor.length)},_togglePicker:function(e){this._ui.hasClass("fl-color-picker-active")?this._ui.removeClass("fl-color-picker-active"):(e&&this._ui.css(e),this._setColor(this._currentElement.val()),this._ui.addClass("fl-color-picker-active"))},_paint:function(){this._paintDimension("right","strip"),this._paintDimension("top","vert"),this._paintDimension("left","horiz")},_paintDimension:function(e,t){var i,l=this,n=l._color,o=l.options.mode,s=l._getHSpaceColor(),r=l.controls[t],d=l.options.controls;if(t!==l.active&&("square"!==l.active||"strip"===t))switch(d[t]){case"h":if("hsv"===o){switch(s=n.clone(),t){case"horiz":s[d.vert](100);break;case"vert":s[d.horiz](100);break;case"strip":s.setHSpace("hsl")}i=s.toHsl()}else i="strip"===t?{s:s.s,l:s.l}:{s:100,l:s.l};r.flBuilderColorPickerRaninbowGradient(e,i);break;case"s":"hsv"===o?"vert"===t?i=[n.clone().a(0).s(0).toCSS("rgba"),n.clone().a(1).s(0).toCSS("rgba")]:"strip"===t?i=[n.clone().s(100).toCSS("hsl"),n.clone().s(0).toCSS("hsl")]:"horiz"===t&&(i=["#fff","hsl("+s.h+",100%,50%)"]):i="vert"===t&&"h"===l.options.controls.horiz?["hsla(0, 0%, "+s.l+"%, 0)","hsla(0, 0%, "+s.l+"%, 1)"]:["hsl("+s.h+",0%,50%)","hsl("+s.h+",100%,50%)"],r.flBuilderColorPickerGradient(e,i);break;case"l":i="strip"===t?["hsl("+s.h+",100%,100%)","hsl("+s.h+", "+s.s+"%,50%)","hsl("+s.h+",100%,0%)"]:["#fff","rgba(255,255,255,0) 50%","rgba(0,0,0,0) 50%","rgba(0,0,0,1)"],r.flBuilderColorPickerGradient(e,i);break;case"v":i="strip"===t?[n.clone().v(100).toCSS(),n.clone().v(0).toCSS()]:["rgba(0,0,0,0)","#000"],r.flBuilderColorPickerGradient(e,i)}},_getHSpaceColor:function(){return"hsv"===this.options.mode?this._color.toHsv():this._color.toHsl()},_dimensions:function(e){var t,i=this,l=i.options,n=i.controls.square,o=i.picker.find(".iris-strip"),s=l.border?l.width-20:l.width;if(e&&(n.css("width",""),o.css("width",""),i.picker.css({width:"",height:""})),e=s*(parseFloat("77.5%")/100),s=s*(parseFloat("12%")/100),t=l.border?20+e:e,n.width(e).height(e),o.height(e).width(s),i.picker.css({width:l.width,height:t}),!l.palettes)return i.picker.css("paddingBottom","")},_addInputListeners:function(n){function e(e){var t=new FLBuilderColor(n.val()),i=n.val().replace(/^#/,""),l=o._currentElement.hasClass("fl-color-picker-empty");if(n.removeClass("iris-error"),t.error)""!==i&&n.addClass("iris-error");else if(t.toString()!==o._color.toString()||""!==o._color.toString()&&l)if("keyup"===e.type)i.match(/^[0-9a-fA-F]{3}$/)||(o._setColor(i),o._currentElement.parent().find(".fl-color-picker-color").css({backgroundColor:FLBuilderColor(i).toDisplay()}).removeClass("fl-color-picker-empty"),o._currentElement.val(i).trigger("change"));else if("paste"===e.type)return i=e.originalEvent.clipboardData.getData("text").replace(/^#/,""),hex=FLBuilderColor(i).toString(),o._setColor(i),n.val(hex),o._currentElement.parent().find(".fl-color-picker-color").css({backgroundColor:FLBuilderColor(hex).toDisplay()}).removeClass("fl-color-picker-empty"),o._currentElement.val(i).trigger("change"),!1}var o=this;o._currentElement=n.parent().find(".fl-color-picker-value"),n.on("change",e).on("keyup",o._debounce(e,100))},_initControls:function(){var o=this,s=o.controls,e=s.square,i=o.options.controls,l=o._scale[i.strip];s.stripSlider.slider({orientation:"horizontal",max:l,slide:function(e,t){o.active="strip","h"===i.strip&&(t.value=l-t.value),o._color[i.strip](t.value),o._change.apply(o,arguments)}}),s.squareDrag.draggable({containment:s.square.find(".iris-square-inner"),zIndex:1e3,cursor:"move",drag:function(e,t){o._squareDrag(e,t)},start:function(){e.addClass("iris-dragging"),u(this).addClass("ui-state-focus")},stop:function(){e.removeClass("iris-dragging"),u(this).removeClass("ui-state-focus")}}).on("mousedown mouseup",function(e){var t="ui-state-focus";e.preventDefault(),"mousedown"===e.type?(o.picker.find("."+t).removeClass(t).blur(),u(this).addClass(t).focus()):u(this).removeClass(t)}).on("keydown",function(e){var t=s.square,i=s.squareDrag,l=i.position(),n=2;switch(e.altKey&&(n*=10),e.keyCode){case 37:l.left-=n;break;case 38:l.top-=n;break;case 39:l.left+=n;break;case 40:l.top+=n;break;default:return!0}l.left=Math.max(0,Math.min(l.left,t.width())),l.top=Math.max(0,Math.min(l.top,t.height())),i.css(l),o._squareDrag(e,{position:l}),e.preventDefault()}),e.mousedown(function(e){var t;1===e.which&&u(e.target).is("div")&&(t=o.controls.square.offset(),t={top:e.pageY-t.top,left:e.pageX-t.left},e.preventDefault(),o._squareDrag(e,{position:t}),e.target=o.controls.squareDrag.get(0),o.controls.squareDrag.css(t).trigger(e))})},_squareDrag:function(e,t){var i=this,l=i.options.controls,n=i._squareDimensions(),o=Math.round((n.h-t.position.top)/n.h*i._scale[l.vert]),n=i._scale[l.horiz]-Math.round((n.w-t.position.left)/n.w*i._scale[l.horiz]);i._color[l.horiz](n)[l.vert](o),i.active="square",i._change.apply(i,arguments)},_setColor:function(e){var t=this,i=t.options.color;""===e?(e="#ff0000",t.default=!0):t.default=!1,(e=""+(t.options.color=e)).replace(/^#/,""),(e=new FLBuilderColor(e).setHSpace(t.options.mode)).error?t.options.color=i:(t._color=e,t.options.color=t._color.toString(),t.active="external",t._change())},_squareDimensions:function(e){var t=this.controls.square;return void 0!==e&&t.data("dimensions")?t.data("dimensions"):(this.controls.squareDrag,e={w:t.width(),h:t.height()},t.data("dimensions",e),e)},_isNonHueControl:function(e,t){return"square"===e&&"h"===this.options.controls.strip||"external"!==t&&("h"!==t||"strip"!==e)},_change:function(){var l=this,n=l.controls,o=l._getHSpaceColor(),e=["square","strip"],s=l.options.controls,t=s[l.active]||"external",i=l.hue;"external"!==l.active&&(l._color._var=null),"strip"===l.active?e=[]:"external"!==l.active&&e.pop(),u.each(e,function(e,t){var i;if(t!==l.active)switch(t){case"strip":i="h"===s.strip?l._scale[s.strip]-o[s.strip]:o[s.strip],n.stripSlider.slider("value",i);break;case"square":i=l._squareDimensions(),i={left:o[s.horiz]/l._scale[s.horiz]*i.w,top:i.h-o[s.vert]/l._scale[s.vert]*i.h},l.controls.squareDrag.css(i)}}),o.h!==i&&l._isNonHueControl(l.active,t)&&l._color.h(i),l.hue=l._color.h(),l.options.color=l._color.toString(),l.element.is(":input")&&!l._color.error&&(l.element.removeClass("iris-error"),l.element.val()!==l._color.toString()&&l.element.val(l._color.toString()),this._currentElement)&&(!l.default||l.default&&"external"!==l.active?this._currentElement.val(l._color.toString().replace(/^#/,"")).parent().find(".fl-color-picker-color").css({backgroundColor:l._color.toDisplay()}).removeClass("fl-color-picker-empty"):this._currentElement.val(""),l._wrapper.find(".fl-alpha-slider-offset").css("background-color",l._color.toDisplay()),l._ui.hasClass("fl-color-picker-active"))&&this._currentElement.trigger("change"),l._paint(),l._inited=!0,l.active=!1},_debounce:function(n,o,s){var r,d;return function(){var e=this,t=arguments,i=function(){r=null,s||(d=n.apply(e,t))},l=s&&!r;return clearTimeout(r),r=setTimeout(i,o),d=l?n.apply(e,t):d}},_buildAlphaUI:function(){var t=this;t._wrapper.on("click",".fl-color-picker-color",function(){var e=u(this);t._currentElement.val();e.hasClass("fl-color-picker-alpha-enabled")?(t._ui.find(".fl-alpha-wrap").length<=0&&u(t._alphaHtml).insertAfter(t._iris),t.picker.addClass("fl-color-alpha-enabled"),t._pickerAlphaControls()):(t.picker.removeClass("fl-color-alpha-enabled"),t._ui.find(".fl-alpha-wrap").remove())})},_pickerAlphaControls:function(){var l=this,e=c(l._currentElement.val()),t=parseFloat(e.alpha/100),i=l._wrapper,n=l._ui.find(".fl-alpha-wrap"),o=n.find(".fl-alpha-slider"),s=n.find(".fl-alpha-text"),r=n.find(".fl-alpha-slider-offset");alphaHandle=n.find(".ui-slider-handle"),s.text(t<1?t:""),o.slider({orientation:"vertical",slide:function(e,t){var i=parseFloat(t.value/100);l._color._alpha=i,s.text(i<1?i:""),l._change.apply(l,arguments)},create:function(){r.css({backgroundColor:e.value}),i.on("click",".fl-color-picker-clear",function(){l._color._alpha=1,s.text(""),o.slider("value",100).trigger("slide")})},value:e.alpha,step:1,min:0,max:100})}}}(jQuery),!function(e,u){function o(e,t){return this instanceof o?this._init(e,t):new o(e,t)}o.fn=o.prototype={_color:0,_alpha:1,_var:null,error:!1,_hsl:{h:0,s:0,l:0},_hsv:{h:0,s:0,v:0},_hSpace:"hsl",_init:function(e){switch(typeof e){case"object":return e.a!==u&&this.a(e.a),this[e.r!==u?"fromRgb":e.l!==u?"fromHsl":e.v!==u?"fromHsv":"noop"](e);case"string":return this.fromCSS(e);case"number":return this.fromInt(parseInt(e,10))}return this},_error:function(){return this.error=!0,this},clone:function(){for(var e=new o(this.toInt()),t=["_alpha","_hSpace","_hsl","_hsv","error"],i=t.length-1;0<=i;i--)e[t[i]]=this[t[i]];return e},setHSpace:function(e){return this._hSpace="hsv"===e?e:"hsl",this},noop:function(){return this},fromCSS:function(e){var t,i=/^(var|rgb|hs(l|v))a?\(/;if(this.error=!1,(e=e.replace(/^\s+/,"").replace(/\s+$/,"").replace(/;$/,"")).match(i)&&e.match(/\)$/)){if(e.match(/^var/))return this.fromVar(e);if((t=e.replace(/(\s|%)/g,"").replace(i,"").replace(/,?\);?$/,"").split(",")).length<3)return this._error();if(4===t.length&&(this.a(parseFloat(t.pop())),this.error))return this;for(var l=t.length-1;0<=l;l--)if(t[l]=parseInt(t[l],10),isNaN(t[l]))return this._error();return e.match(/^rgb/)?this.fromRgb({r:t[0],g:t[1],b:t[2]}):e.match(/^hsv/)?this.fromHsv({h:t[0],s:t[1],v:t[2]}):this.fromHsl({h:t[0],s:t[1],l:t[2]})}return this.fromHex(e)},fromRgb:function(e,t){return"object"!=typeof e||e.r===u||e.g===u||e.b===u?this._error():(this.error=!1,this.fromInt(parseInt((e.r<<16)+(e.g<<8)+e.b,10),t))},fromHex:function(e){return 3===(e=e.replace(/^#/,"").replace(/^0x/,"")).length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),this.error=!/^[0-9A-F]{6}$/i.test(e),this.fromInt(parseInt(e,16))},fromHsl:function(e){var t,i,l,n,o;return"object"!=typeof e||e.h===u||e.s===u||e.l===u?this._error():(this._hsl=e,this._hSpace="hsl",n=e.h/360,o=e.s/100,e=e.l/100,0==o?t=i=l=e:(t=this.hue2rgb(o=2*e-(e=e<.5?e*(1+o):e+o-e*o),e,n+1/3),i=this.hue2rgb(o,e,n),l=this.hue2rgb(o,e,n-1/3)),this.fromRgb({r:255*t,g:255*i,b:255*l},!0))},fromHsv:function(e){var t,i,l,n,o,s,r,d,a;if("object"!=typeof e||e.h===u||e.s===u||e.v===u)return this._error();switch(this._hsv=e,this._hSpace="hsv",s=e.h/360,t=e.s/100,r=(i=e.v/100)*(1-t),d=i*(1-(s=6*s-(e=Math.floor(6*s)))*t),a=i*(1-(1-s)*t),e%6){case 0:l=i,n=a,o=r;break;case 1:l=d,n=i,o=r;break;case 2:l=r,n=i,o=a;break;case 3:l=r,n=d,o=i;break;case 4:l=a,n=r,o=i;break;case 5:l=i,n=r,o=d}return this.fromRgb({r:255*l,g:255*n,b:255*o},!0)},fromVar:function(e){var t=jQuery("body"),i=jQuery("<div />");return i.css({color:e,display:"none"}),this._var=e,t.append(i),e=this.fromCSS(getComputedStyle(i[0]).color),i.remove(),e},fromInt:function(e,t){return this._color=parseInt(e,10),isNaN(this._color)&&(this._color=0),16777215<this._color?this._color=16777215:this._color<0&&(this._color=0),t===u&&(this._hsv.h=this._hsv.s=this._hsl.h=this._hsl.s=0),this},hue2rgb:function(e,t,i){return i<0&&(i+=1),1<i&&--i,i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},toString:function(){if(this._var)return this._var;if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var e=parseInt(this._color,10).toString(16);if(this.error)return"";if(e.length<6)for(var t=6-e.length-1;0<=t;t--)e="0"+e;return"#"+e},toDisplay:function(){var e,t,i="";return this._var?(e=jQuery("body"),(t=jQuery("<div />")).css({color:this._var,display:"none"}),e.append(t),i=getComputedStyle(t[0]).color,t.remove()):i=this.toString(),i},toCSS:function(e,t){switch(e=e||"hex",t=parseFloat(t||this._alpha),e){case"rgb":case"rgba":var i=this.toRgb();return t<1?"rgba( "+i.r+", "+i.g+", "+i.b+", "+t+" )":"rgb( "+i.r+", "+i.g+", "+i.b+" )";case"hsl":case"hsla":i=this.toHsl();return t<1?"hsla( "+i.h+", "+i.s+"%, "+i.l+"%, "+t+" )":"hsl( "+i.h+", "+i.s+"%, "+i.l+"% )";default:return this.toString()}},toRgb:function(){return{r:255&this._color>>16,g:255&this._color>>8,b:255&this._color}},toHsl:function(){var e,t=this.toRgb(),i=t.r/255,l=t.g/255,n=t.b/255,t=Math.max(i,l,n),o=Math.min(i,l,n),s=(t+o)/2;if(t===o)e=d=0;else{var r=t-o,d=.5<s?r/(2-t-o):r/(t+o);switch(t){case i:e=(l-n)/r+(l<n?6:0);break;case l:e=(n-i)/r+2;break;case n:e=(i-l)/r+4}e/=6}return{h:e=0===(e=Math.round(360*e))&&this._hsl.h!==e?this._hsl.h:e,s:d=0===(d=Math.round(100*d))&&this._hsl.s?this._hsl.s:d,l:Math.round(100*s)}},toHsv:function(){var e,t=this.toRgb(),i=t.r/255,l=t.g/255,n=t.b/255,t=Math.max(i,l,n),o=Math.min(i,l,n),s=t,r=t-o,d=0===t?0:r/t;if(t===o)e=d=0;else{switch(t){case i:e=(l-n)/r+(l<n?6:0);break;case l:e=(n-i)/r+2;break;case n:e=(i-l)/r+4}e/=6}return{h:e=0===(e=Math.round(360*e))&&this._hsv.h!==e?this._hsv.h:e,s:d=0===(d=Math.round(100*d))&&this._hsv.s?this._hsv.s:d,v:Math.round(100*s)}},toInt:function(){return this._color},toIEOctoHex:function(){var e=this.toString(),t=parseInt(255*this._alpha,10).toString(16);return"#"+(t=1===t.length?"0"+t:t)+e.replace(/^#/,"")},toLuminosity:function(){var e=this.toRgb();return.2126*Math.pow(e.r/255,2.2)+.7152*Math.pow(e.g/255,2.2)+.0722*Math.pow(e.b/255,2.2)},getDistanceLuminosityFrom:function(e){var t;if(e instanceof o)return t=this.toLuminosity(),(e=e.toLuminosity())<t?(t+.05)/(e+.05):(e+.05)/(t+.05);throw"getDistanceLuminosityFrom requires a Color object"},getMaxContrastColor:function(){var e=this.toLuminosity();return new o(.5<=e?"000000":"ffffff")},getReadableContrastingColor:function(e,t){if(e instanceof o){var i=t===u?5:t,l=e.getDistanceLuminosityFrom(this),t=e.getMaxContrastColor();if(t.getDistanceLuminosityFrom(e)<=i)return t;if(!(i<=l))for(var n=0===t.toInt()?-1:1;l<i&&(this.l(n,!0),l=this.getDistanceLuminosityFrom(e),0!==this._color)&&16777215!==this._color;);}return this},a:function(e){return e===u?this._alpha:(e=parseFloat(e),isNaN(e)?this._error():(this._alpha=e,this))},darken:function(e){return this.l(-(e=e||5),!0)},lighten:function(e){return this.l(e=e||5,!0)},saturate:function(e){return this.s(e=e||15,!0)},desaturate:function(e){return this.s(-(e=e||15),!0)},toGrayscale:function(){return this.setHSpace("hsl").s(0)},getComplement:function(){return this.h(180,!0)},getSplitComplement:function(e){return this.h(180+30*(e=e||1),!0)},getAnalog:function(e){return this.h(30*(e=e||1),!0)},getTetrad:function(e){return this.h(60*(e=e||1),!0)},getTriad:function(e){return this.h(120*(e=e||1),!0)},_partial:function(l){var n=i[l];return function(e,t){var i=this._spaceFunc("to",n.space);return e===u?i[l]:(!0===t&&(e=i[l]+e),n.mod&&(e%=n.mod),n.range&&(e=e<n.range[0]?n.range[0]:e>n.range[1]?n.range[1]:e),i[l]=e,this._spaceFunc("from",n.space,i))}},_spaceFunc:function(e,t,i){t=t||this._hSpace;return this[e+t.charAt(0).toUpperCase()+t.substr(1)](i)}};var t,i={h:{mod:360},s:{range:[0,100]},l:{space:"hsl",range:[0,100]},v:{space:"hsv",range:[0,100]},r:{space:"rgb",range:[0,255]},g:{space:"rgb",range:[0,255]},b:{space:"rgb",range:[0,255]}};for(t in i)i.hasOwnProperty(t)&&(o.fn[t]=o.fn._partial(t));"object"==typeof exports?module.exports=o:(e.FLBuilderColor=o,e.Color=o)}(this),!function(s){(FLLightbox=function(e){this._init(e)}).closeParent=function(e){e=s(e).closest(".fl-lightbox-wrap").attr("data-instance-id");_.isUndefined(e)||FLLightbox._instances[e].close()},FLLightbox.getResizableControlClass=function(){var e=s(".fl-lightbox-resizable",window.parent.document).eq(0),t="far fa-window-maximize";return t=e.length&&e.hasClass("fl-lightbox-width-full")?"far fa-window-minimize":t},FLLightbox.unbindAll=function(){for(var e in FLLightbox._instances)FLLightbox._instances[e]._unbind()},FLLightbox.bindAll=function(){for(var e in FLLightbox._instances)FLLightbox._instances[e]._bind()},FLLightbox.closeAll=function(){for(var e in FLLightbox._instances)FLLightbox._instances[e].close()},FLLightbox._instances={},FLLightbox.prototype={_id:null,_node:null,_visible:!1,_allowClosing:!0,_resizeTimer:null,_defaults:{className:"",destroyOnClose:!1,resizable:!1},open:function(e){var t=this._node.find(".fl-lightbox"),i=t.closest(".fl-builder-ui-pinned").length,l=this._getPositionSettings();!i&&l&&this._defaults.resizable&&t.css(l),this._bind(),this._node.show(),this._visible=!0,void 0!==e?this.setContent(e):this._resize(),this.trigger("open"),FLBuilder.triggerHook("didShowLightbox",this)},close:function(){var e=this._node.data("parent");this._allowClosing&&(this.trigger("beforeCloseLightbox"),this._unbind(),this._node.hide(),this._visible=!1,this.trigger("close"),FLBuilder.triggerHook("didHideLightbox"),this._defaults.resizable&&_.isUndefined(e)&&FLBuilder.triggerHook("didHideAllLightboxes"),this._defaults.destroyOnClose)&&this.destroy()},disableClose:function(){this._allowClosing=!1},enableClose:function(){this._allowClosing=!0},setContent:function(e){this._node.find(".fl-lightbox-content").html(e),this._resize(),0==s(".fl-builder-content-panel-button",window.parent.document).length&&s(".fl-builder-panel-drag-handle",window.parent.document).show()},empty:function(){this._node.find(".fl-lightbox-content").empty()},on:function(e,t){this._node.on(e,t)},off:function(e,t){this._node.off(e,t)},trigger:function(e,t){this._node.trigger(e,t)},destroy:function(){this._node.empty(),this._node.remove(),FLLightbox._instances[this._id]="undefined";try{delete FLLightbox._instances[this._id]}catch(e){}},_init:function(e){var t=0,i=null;for(i in FLLightbox._instances)t++;this._defaults=s.extend({},this._defaults,e),this._id=(new Date).getTime()+t,(FLLightbox._instances[this._id]=this)._render(),this._resizable()},_render:function(){this._node=s('<div class="fl-lightbox-wrap" data-instance-id="'+this._id+'"><div class="fl-lightbox-mask"></div><div class="fl-lightbox"><div class="fl-lightbox-content-wrap"><div class="fl-lightbox-content"></div></div></div></div>'),this._node.addClass(this._defaults.className),s("body",window.parent.document).append(this._node)},_bind:function(){s(window.parent).on("resize.fl-lightbox-"+this._id,this._delayedResize.bind(this))},_unbind:function(){s(window.parent).off("resize.fl-lightbox-"+this._id)},_resizable:function(){s("body",window.parent.document);var e=this._node.find(".fl-lightbox-mask"),t=this._node.find(".fl-lightbox"),i=s(".fl-lightbox-resizable",window.parent.document).eq(0),l=getComputedStyle(document.documentElement),n=parseInt(l.getPropertyValue("--fl-builder-panel-min-width")),l=parseInt(l.getPropertyValue("--fl-builder-panel-min-height"));this._defaults.resizable?(e.hide(),t.addClass("fl-lightbox-resizable"),t.on("click",".fl-lightbox-resize-toggle",this._resizeClicked.bind(this)),t.draggable({cursor:"move",handle:".fl-lightbox-header",iframeFix:!0}).resizable({handles:"all",minHeight:l,minWidth:n,start:this._resizeStart.bind(this),stop:this._resizeStop.bind(this)}),i.length&&i.hasClass("fl-lightbox-width-full")?(t.addClass("fl-lightbox-width-full"),t.draggable("disable")):this._restorePosition()):e.show(),this._resize()},_delayedResize:function(){clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(this._resize.bind(this),250)},_resize:function(){var e=this._node.find(".fl-lightbox"),t=parseInt(this._node.css("padding-top")),i=parseInt(this._node.css("padding-bottom")),l=(parseInt(this._node.css("padding-left")),parseInt(this._node.css("padding-right")),e.height()),n=e.width(),o=s(window.parent),t=o.height()-t-i,i=(o.width(),"0px");this._defaults.resizable?(n<=600?e.addClass("fl-lightbox-width-slim"):e.removeClass("fl-lightbox-width-slim"),n<450?e.addClass("fl-lightbox-width-micro"):e.removeClass("fl-lightbox-width-micro"),this._resizeEditors()):(l<t&&(i=(t-l-46)/2+"px"),e.attr("style","").css("margin",i+" auto 0")),this.trigger("resized")},_resizeStart:function(){s("body",window.parent.document).addClass("fl-builder-resizable-is-resizing"),s(".fl-builder-lightbox:visible",window.parent.document).append('<div class="fl-builder-resizable-iframe-fix"></div>'),FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays()},_resizeStop:function(e,t){var i=s(".fl-lightbox-resizable:visible",window.parent.document);parseInt(i.css("top"))<0&&i.css("top","0"),this._savePosition(),s("body",window.parent.document).removeClass("fl-builder-resizable-is-resizing"),s(".fl-builder-resizable-iframe-fix",window.parent.document).remove(),FLBuilder._bindOverlayEvents()},_resizeClicked:function(){s(".fl-lightbox-resizable",window.parent.document).find(".fl-lightbox-resize-toggle");this._node.find(".fl-lightbox").hasClass("fl-lightbox-width-full")?this._resizeExitFull():this._resizeEnterFull(),this._resize()},_resizeEnterFull:function(){var e=s(".fl-lightbox-resizable",window.parent.document),t=e.find(".fl-lightbox-resize-toggle");this._node.find(".fl-lightbox");t.removeClass("fa-window-maximize").addClass("fa-window-minimize"),e.addClass("fl-lightbox-width-full"),e.draggable("disable"),e.resizable("disable")},_resizeExitFull:function(){var e=s(".fl-lightbox-resizable",window.parent.document),t=e.find(".fl-lightbox-resize-toggle");this._node.find(".fl-lightbox");t.removeClass("fa-window-minimize").addClass("fa-window-maximize"),e.removeClass("fl-lightbox-width-full"),e.draggable("enable"),e.resizable("enable")},_resizeEditors:function(){s(".fl-lightbox-resizable",window.parent.document).each(function(){var e=s(this),t=e.find(".fl-builder-settings-fields").height(),e=e.find(".mce-edit-area > iframe, textarea.wp-editor-area, .ace_editor"),i=null;t<350&&(t=350),e.each(function(){(i=s(this)).hasClass("ace_editor")?(i.height(t-60),i.closest(".fl-field").data("editor").resize()):i.closest(".mce-container-body").find(".mce-toolbar-grp .mce-toolbar.mce-last").is(":visible")?i.height(t-175):i.height(t-150)})})},_savePosition:function(){var e=this._node.find(".fl-lightbox"),t={width:e.width(),height:e.height(),top:parseInt(e.css("top"))<0?"0px":e.css("top"),left:e.css("left")};e.closest(".fl-builder-ui-pinned").length||(FLBuilderConfig.userSettings.lightbox=t,FLBuilder.ajax({action:"save_lightbox_position",data:t}))},_restorePosition:function(){var e=this._node.find(".fl-lightbox"),t=this._getPositionSettings();t?e.css(t):e.css({top:25,left:FLBuilderConfig.isRtl?"-25":25})},_getPositionSettings:function(){var e,t,i,l,n,o,s=FLBuilderConfig.userSettings.lightbox;return!!s&&(e=window.parent.innerHeight,t=FLBuilderConfig.isRtl,i=parseInt(s.height),l=parseInt(s.top),n=parseInt(s.left),parseInt(s.top),o=parseInt(s.width),!t&&n+o+100>screen.width&&(s.left=screen.width-o-250),!t&&n<0&&(s.left=50),n=parseInt(s.left),t&&0<n&&(s.left=-25),(e<i&&546<e||e<l+i)&&(e<i&&(s.height=e-50),s.top=0),s)}}}(jQuery),!function(s){FLIconSelector={_content:null,_lightbox:null,_rendered:!1,_filterText:"",_liveFilterText:"",open:function(i){FLIconSelector._rendered||FLIconSelector._render(),null===FLIconSelector._content?(FLIconSelector._lightbox.open('<div class="fl-builder-lightbox-loading"></div>'),FLBuilder.ajax({action:"render_icon_selector"},FLIconSelector._getContentComplete)):(FLIconSelector._lightbox.open(),s(".fl-icons-filter-text-live",window.parent.document).focus()),FLIconSelector._lightbox.on("icon-selected",function(e,t){FLIconSelector._lightbox.off("icon-selected"),FLIconSelector._lightbox.close(),i(t)})},_render:function(){FLIconSelector._lightbox=new FLLightbox({className:"fl-icon-selector"}),FLIconSelector._rendered=!0,FLBuilder.addHook("endEditingSession",function(){FLIconSelector._lightbox.close()})},_getContentComplete:function(e){e=FLBuilder._jsonParse(e);FLIconSelector._content=e.html,FLIconSelector._lightbox.setContent(e.html),s(".fl-icons-filter-text-live",window.parent.document).on("keyup",s.debounce(1e3,FLIconSelector.livefilter)),s(".fl-icons-filter-text-live",window.parent.document).focus(),s(".fl-icons-list i",window.parent.document).on("click",FLIconSelector._select),s(".fl-icon-selector-cancel",window.parent.document).on("click",s.proxy(FLIconSelector._lightbox.close,FLIconSelector._lightbox)),FLIconSelector.renderRecent()},renderRecent:function(){var e=FLBuilderConfig.recentIcons;if(e.length<1)return s(".fl-icons-section.recent h2.recent",window.parent.document).hide(),!1;s(".fl-icons-section.recent h2.recent",window.parent.document).show(),s(".fl-icons-section.recent",window.parent.document).show(),s(".recent-icons",window.parent.document).html(""),s.each(e,function(e,t){s(".recent-icons",window.parent.document).append('<i class="'+t+'"></i>')}),s(".recent-icons",window.parent.document).show(),s(".recent-icons i",window.parent.document).on("click",FLIconSelector._select);e=s(".recent-icons i",window.parent.document);s.each(e,function(e,t){"none"==window.parent.getComputedStyle(s(t)[0],":before").getPropertyValue("content")&&s(t).hide()})},livefilter:function(){var e=s(".fl-icons-filter-text-live",window.parent.document).val();if(e===FLIconSelector._liveFilterText)return!1;s(".fl-icons-section.results",window.parent.document).html(""),""===e?(FLIconSelector._liveFilterText="",s(".fl-icons-section",window.parent.document).show(),FLIconSelector.renderRecent()):(s(".fl-icons-section.recent",window.parent.document).hide(),s(".fl-icons-section.all-icons",window.parent.document).hide(),s(".fl-icons-section.results",window.parent.document).html('<i class="fas fa-spinner fa-spin"></i>'),FLIconSelector._liveFilterText=e,FLBuilder.ajax({action:"query_icons",text:e},FLIconSelector._query_result))},_query_result:function(e){var t=s(".fl-icons-section.results",window.parent.document),n="";if(!e||"[]"===e)return n="<h2>No Icons Found</h2>",FLIconSelector.renderRecent(),t.html(n),t.show(),!1;var e=FLBuilder._jsonParse(e),o="";s.each(e,function(e,l){n+="<h2>"+l.name+"</h2>",s.each(l.data,function(e,i){s.each(i.styles,function(e,t){switch(o="",t){case"solid":o="fas";break;case"regular":o="far";break;case"light":o="fal";break;case"duotone":o="fad";break;case"thin":o="fa-thin";break;case"brands":o="fa-brands fab";break;case"legacy":o=l.prefix}0<o.length&&(o+=" "),n+='<i class="'+o+i.tag+'" title="'+i.label+'"></i>'})})}),t.html(n),t.show(),s(".fl-icons-section.results i",window.parent.document).on("click",FLIconSelector._select)},_filter:function(){var e=s(".fl-icons-filter-select",window.parent.document).val(),t=s(".fl-icons-filter-text",window.parent.document).val()||"";("all"==e?s(".fl-icons-section",window.parent.document):(s(".fl-icons-section",window.parent.document).hide(),s(".fl-"+e,window.parent.document))).show(),""!==(FLIconSelector._filterText=t)?s(".fl-icons-list i",window.parent.document).each(FLIconSelector._filterIcon):s(".fl-icons-list i",window.parent.document).show()},_filterIcon:function(){var e=s(this);-1==e.attr("class").indexOf(FLIconSelector._filterText)?e.hide():e.show()},_select:function(){var e=s(this).attr("class");FLBuilder.ajax({action:"recent_icons",icon:e},FLIconSelector._updateRecents),FLIconSelector._lightbox.trigger("icon-selected",e)},_updateRecents:function(e){FLBuilderConfig.recentIcons=FLBuilder._jsonParse(e)}}}(jQuery),!function(i){(FLStyleSheet=function(e){"object"==typeof e&&i.extend(this,e),this._createSheet()}).prototype={id:null,_sheet:null,_sheetElement:null,updateRule:function(e,t,i){for(var l=this._sheet.cssRules||this._sheet.rules,n=null,o=0;o<l.length;o++)l[o].selectorText.toLowerCase().replace(/\s/g,"")==e.toLowerCase().replace(/\s/g,"")&&(n=l[o]);if(n)if("object"==typeof t)for(o in t)this.setProperty(n,o,t[o]);else this.setProperty(n,t,i);else this.addRule(e,t,i)},setProperty:function(e,t,i=""){var l="";e.style.setProperty?(-1<i.indexOf("!important")&&(l="important",i=i.replace("!important","").trim()),e.style.setProperty(t,i,l)):e.style[this._toCamelCase(t)]=i},addRule:function(e,t,i){var l="",n="";if("object"==typeof t)for(n in t)l+=n+":"+t[n]+";";else l=t+":"+i+";";this._sheet.insertRule?this._sheet.insertRule(e+" { "+l+" }",this._sheet.cssRules.length):this._sheet.addRule(e,l)},destroy:function(){this._sheetElement&&(this._sheetElement.remove(),this._sheetElement=null),this._sheet&&(this._sheet=null)},disable:function(){this._sheet.disabled=!0},enable:function(){this._sheet.disabled=!1},_createSheet:function(){var e=this.id?' id="'+this.id+'"':"",t=this.className?' class="'+this.className+'"':"";this._sheet||(this._sheetElement=i('<style type="text/css"'+e+t+"></style>"),i("body").append(this._sheetElement),this._sheet=this._sheetElement[0].sheet)},_toCamelCase:function(e){return e.toLowerCase().replace(/-(.)/g,function(e,t){return t.toUpperCase()})}}}(jQuery),!function(b){FLBuilder={preview:null,_actionsLightbox:null,_ajaxQueue:[],_ajaxRequest:null,_colResizeData:null,_colResizing:!1,_contentClass:!1,_dragEnabled:!1,_dragging:!1,_dragInitialScrollTop:0,_exitUrl:null,_layout:null,_layoutQueue:[],_layoutSettingsCSSCache:null,_layoutSettingsCSSTimeout:null,_lightbox:null,_lightboxScrollbarTimeout:null,_loadedModuleAssets:[],_moduleHelpers:{},_multiplePhotoSelector:null,_newColParent:null,_newColPosition:0,_newColGroupParent:null,_newColGroupPosition:0,_newModuleParent:null,_newModulePosition:0,_newRowPosition:0,_selectedTemplateId:null,_selectedTemplateType:null,_singlePhotoSelector:null,_singleVideoSelector:null,_multipleAudiosSelector:null,_codeDisabled:!1,_sandbox:{},_publishAndRemain:!1,_shapesEdited:!1,_fontFamilyCache:null,_init:function(){FL.Builder.utils.isBlockEditor()||(FLBuilder.UIIFrame.init(),FLBuilder._initJQueryReadyFix(),FLBuilder._initGlobalErrorHandling(),FLBuilder._initPostLock(),FLBuilder._initClassNames(),FLBuilder._initMediaUploader(),FLBuilder._initOverflowFix(),FLBuilder._initScrollbars(),FLBuilder._initLightboxes(),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder._initStrings(),FLBuilder._initSanityChecks(),FLBuilder._initTipTips(),FLBuilder._initTinyMCE(),FLBuilder._bindEvents(),FLBuilder._bindOverlayEvents(),FLBuilder._setupEmptyLayout(),FLBuilder._highlightEmptyCols(),FLBuilder._checkEnv(),FL.Builder.utils.colorScheme.init(),FLBuilder.addHook("didInitUI",FLBuilder._showTourOrTemplates.bind(FLBuilder)),FLBuilder.addHook("endEditingSession",FLBuilder._doStats.bind(this)),FLBuilder.triggerHook("init"))},_initJQueryReadyFix:function(){FLBuilderConfig.debug||(jQuery.fn.oldReady=jQuery.fn.ready,jQuery.fn.ready=function(e){return jQuery.fn.oldReady(function(){try{"function"==typeof e&&e(b)}catch(e){FLBuilder.logError(e)}})})},_initSanityChecks:function(){FLBuilderConfig.uploadPath&&"undefined"==typeof FLBuilderLayout&&(url='<a href="'+FLBuilderConfig.uploadUrl+'">wp-admin -> Settings -> Media</a>',FLBuilder.alert('<strong>Critcal Error</strong><p style="font-size:15px;">Please go to '+url+" and make sure uploads folder settings is blank</p>"),b(".fl-builder-alert-close",window.parent.document).hide())},_initGlobalErrorHandling:function(){FLBuilderConfig.debug||(window.onerror=function(e,t,i,l,n){return FLBuilder.logGlobalError(e,t,i,l,n),!0})},_initPostLock:function(){void 0!==wp.heartbeat&&(wp.heartbeat.interval(120),wp.heartbeat.enqueue("fl_builder_post_lock",{post_id:FLBuilderConfig.postId}))},_heartbeatError:function(e,t){void 0===t["wp-auth-check"]||t["wp-auth-check"]||(FLLightbox.closeAll(),FLBuilder.alert("You have been logged out. Please login to continue.<br />You will be redirected back here automatically.</p><p><button onclick=\"window.open('"+FLBuilderConfig.loginUrl+'\')" class="fl-builder-button fl-builder-button-large fl-builder-button-primary">Click to login</button></p>'),b(".fl-lightbox-footer").remove())},_initClassNames:function(){var e=b("html").add("html",window.parent.document),t=b("body").add("body",window.parent.document);e.addClass("fl-builder-edit"),t.addClass("fl-builder"),FLBuilderConfig.simpleUi&&t.addClass("fl-builder-simple"),FLBuilder._contentClass=".fl-builder-content-"+FLBuilderConfig.postId,b(FLBuilder._contentClass).addClass("fl-builder-content-editing")},_initMediaUploader:function(){wp.media.model.settings.post.id=FLBuilderConfig.postId},_initOverflowFix:function(){b(FLBuilder._contentClass).parents().css("overflow","visible")},_initScrollbars:function(){var e=b(".fl-nanoscroller",window.parent.document).nanoScroller({documentContext:window.parent.document,alwaysVisible:!1,preventPageScrolling:!0,paneClass:"fl-nanoscroller-pane",sliderClass:"fl-nanoscroller-slider",contentClass:"fl-nanoscroller-content"}).filter(".fl-builder-settings-fields"),t=e.find(".fl-nanoscroller-pane");t.length&&(t=t.get(0).style.display,e=e.find(".fl-nanoscroller-content"),"none"===t?e.removeClass("has-scrollbar"):e.addClass("has-scrollbar"))},_initSortables:function(){var e={frame:null,appendTo:FLBuilder._contentClass,scroll:!0,cursor:"move",cursorAt:{left:85,top:20},distance:1,helper:FLBuilder._blockDragHelper,start:FLBuilder._blockDragStart,sort:FLBuilder._blockDragSort,change:FLBuilder._blockDragChange,stop:FLBuilder._blockDragStop,placeholder:"fl-builder-drop-zone",tolerance:"intersect"},t="",i="",l="";FLBuilder.UIIFrame.isEnabled()&&(e.frame=b("#fl-builder-ui-iframe",window.parent.document),e.appendTo=b("body",window.parent.document),e.scroll=!1),b(FLBuilder._contentClass+" [data-children-wrapper]").each(function(){b(this).closest(".fl-module").attr("data-has-children-wrapper","true")}),l="row"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-content, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-module[data-accepts]:not([data-has-children-wrapper]):not(:has(> .fl-module-content)), "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-module[data-accepts]:not([data-has-children-wrapper]) > .fl-module-content, "+FLBuilder._contentClass+" [data-children-wrapper]":"column"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-col-drop-target, "+FLBuilder._contentClass+" .fl-col-content, "+FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]):not(:has(> .fl-module-content)), "+FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]) > .fl-module-content, "+FLBuilder._contentClass+" [data-children-wrapper]":"module"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]):not(:has(> .fl-module-content)), "+FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]) > .fl-module-content, "+FLBuilder._contentClass+" [data-children-wrapper]":FLBuilder._contentClass+" .fl-row-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col:not(.fl-builder-node-loading):not(.fl-node-global) .fl-col-content, "+FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]):not(:has(> .fl-module-content)):not(.fl-node-global), "+FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]):not(.fl-node-global) > .fl-module-content, "+FLBuilder._contentClass+" :not(.fl-node-global) [data-children-wrapper]",i="row"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target":FLBuilder._contentClass+" .fl-row-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target",t=FLBuilderConfig.nestedColumns?l:"row"==FLBuilderConfig.userTemplateType?FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target":FLBuilder._contentClass+" .fl-row-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-group-drop-target, "+FLBuilder._contentClass+" .fl-row:not(.fl-builder-node-loading) .fl-col-drop-target",b(".fl-builder-rows",window.parent.document).sortable(b.extend({},e,{connectWith:t,items:".fl-builder-block-row",stop:FLBuilder._rowDragStop})),b(".fl-builder-row-templates",window.parent.document).sortable(b.extend({},e,{connectWith:FLBuilder._contentClass+" .fl-row-drop-target",items:".fl-builder-block-row-template:not(.fl-builder-block-disabled)",stop:FLBuilder._nodeTemplateDragStop})),b(".fl-builder-saved-rows",window.parent.document).sortable(b.extend({},e,{cancel:".fl-builder-node-template-actions, .fl-builder-node-template-edit, .fl-builder-node-template-delete",connectWith:FLBuilder._contentClass+" .fl-row-drop-target",items:".fl-builder-block-saved-row",stop:FLBuilder._nodeTemplateDragStop})),b(".fl-builder-saved-columns",window.parent.document).sortable(b.extend({},e,{cancel:".fl-builder-node-template-actions, .fl-builder-node-template-edit, .fl-builder-node-template-delete",connectWith:i,items:".fl-builder-block-saved-column",stop:FLBuilder._nodeTemplateDragStop})),b(".fl-builder-modules, .fl-builder-widgets",window.parent.document).sortable(b.extend({},e,{connectWith:l,items:".fl-builder-block-module:not(.fl-builder-block-disabled)",stop:FLBuilder._moduleDragStop})),b(".fl-builder-module-templates",window.parent.document).sortable(b.extend({},e,{connectWith:l,items:".fl-builder-block-module-template",stop:FLBuilder._nodeTemplateDragStop})),b(".fl-builder-saved-modules",window.parent.document).sortable(b.extend({},e,{cancel:".fl-builder-node-template-actions, .fl-builder-node-template-edit, .fl-builder-node-template-delete",connectWith:l,items:".fl-builder-block-saved-module",stop:FLBuilder._nodeTemplateDragStop})),b(".fl-row-sortable-proxy",window.parent.document).sortable(b.extend({},e,{connectWith:FLBuilder._contentClass+" .fl-row-drop-target",helper:FLBuilder._rowDragHelper,start:FLBuilder._rowDragStart,stop:FLBuilder._rowDragStop})),b(".fl-col-sortable-proxy",window.parent.document).sortable(b.extend({},e,{connectWith:l,helper:FLBuilder._colDragHelper,start:FLBuilder._colDragStart,stop:FLBuilder._colDragStop})),b(".fl-module-sortable-proxy",window.parent.document).sortable(b.extend({},e,{connectWith:l,helper:FLBuilder._moduleDragHelper,start:FLBuilder._moduleDragStart,stop:FLBuilder._moduleDragStop})),b(FLBuilder._contentClass+" .fl-col-content").sortable(b.extend({},e,{cancel:".fl-module, .fl-col-group",handle:".fl-module-sortable-proxy"})),b(FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]):not(:has(> .fl-module-content))").sortable(b.extend({},e,{cancel:".fl-module",handle:".fl-module-sortable-proxy"})),b(FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper]) > .fl-module-content").sortable(b.extend({},e,{cancel:".fl-module",handle:".fl-module-sortable-proxy"})),b(FLBuilder._contentClass+" [data-children-wrapper]").sortable(b.extend({},e,{cancel:".fl-module",handle:".fl-module-sortable-proxy"})),b(FLBuilder._contentClass+" .fl-row-drop-target").sortable(e),b(FLBuilder._contentClass+" .fl-col-group-drop-target").sortable(e),b(FLBuilder._contentClass+" .fl-col-drop-target").sortable(e)},_refreshSortables:function(){var e=b(".ui-sortable").add(".ui-sortable",window.parent.document);e.sortable("refresh"),e.sortable("refreshPositions")},_initStrings:function(){b.validator.messages.required=FLBuilderStrings.validateRequiredMessage},_bindEvents:function(){var e;b("body").hasClass("wp-admin")||(e=b(".fl-builder-bar a, .fl-builder--content-library-panel a, .fl-page-nav .nav a"),b("a").not(e).on("click",FLBuilder._preventDefault),b(".fl-page-nav .nav a").on("click",FLBuilder._headerLinkClicked),b("body").on("click",".fl-builder-content a",FLBuilder._preventDefault),b("body").on("mouseup","button.fl-builder-button",this._buttonMouseUp.bind(this))),b(document).on("heartbeat-tick",FLBuilder._initPostLock),b(document).on("heartbeat-tick",FLBuilder._heartbeatError),b(window.parent).on("beforeunload",FLBuilder._warnBeforeUnload),b("body",window.parent.document).on("click",".fl-builder-blocks-pro-expand",FLBuilder._toggleProModules),b("body",window.parent.document).on("click",".fl-builder-upgrade-button",FLBuilder._upgradeClicked),b(".fl-builder-panel-actions .fl-builder-panel-close",window.parent.document).on("click",FLBuilder._closePanel),b("body",window.parent.document).on("mousedown",".fl-builder-node-template-actions",FLBuilder._stopPropagation),b("body",window.parent.document).on("mousedown",".fl-builder-node-template-edit",FLBuilder._stopPropagation),b("body",window.parent.document).on("mousedown",".fl-builder-node-template-delete",FLBuilder._stopPropagation),b("body",window.parent.document).on("click",".fl-builder-node-template-edit",FLBuilder._editNodeTemplateClicked),b("body",window.parent.document).on("click",".fl-builder-node-template-delete",FLBuilder._deleteNodeTemplateClicked),b("body",window.parent.document).on("mousedown",".fl-builder-block:not(.fl-builder-block-disabled)",FLBuilder._blockDragInit),b("body",window.parent.document).on("mouseup",FLBuilder._blockDragCancel),b("body",window.parent.document).on("click",".fl-builder-actions .fl-builder-cancel-button",FLBuilder._cancelButtonClicked),b("body",window.parent.document).on("click",".fl-builder-layout-settings .fl-builder-settings-save",FLBuilder._saveLayoutSettingsClicked),b("body",window.parent.document).on("click",".fl-builder-layout-settings .fl-builder-settings-cancel",FLBuilder._cancelLayoutSettingsClicked),b("body",window.parent.document).on("click",".fl-builder-global-settings .fl-builder-settings-save",FLBuilder._saveGlobalSettingsClicked),b("body",window.parent.document).on("click",".fl-builder-global-settings .fl-builder-settings-cancel",FLBuilder._cancelLayoutSettingsClicked),b("body",window.parent.document).on("click",".fl-user-template",FLBuilder._userTemplateClicked),b("body",window.parent.document).on("click",".fl-user-template-edit",FLBuilder._editUserTemplateClicked),b("body",window.parent.document).on("click",".fl-user-template-delete",FLBuilder._deleteUserTemplateClicked),b("body",window.parent.document).on("click",".fl-builder-template-replace-button",FLBuilder._templateReplaceClicked),b("body",window.parent.document).on("click",".fl-builder-template-append-button",FLBuilder._templateAppendClicked),b("body",window.parent.document).on("click",".fl-builder-template-actions .fl-builder-cancel-button",FLBuilder._templateCancelClicked),b("body",window.parent.document).on("click",".fl-builder-user-template-settings .fl-builder-settings-save",FLBuilder._saveUserTemplateSettings),b("body",window.parent.document).on("click",".fl-builder-no-tour-button",FLBuilder._noTourButtonClicked),b("body",window.parent.document).on("click",".fl-builder-yes-tour-button",FLBuilder._yesTourButtonClicked),b("body",window.parent.document).on("click",".fl-builder-alert-close",FLBuilder._alertClose),b("body",window.parent.document).on("click",".fl-builder-settings-save-as",FLBuilder._showNodeTemplateSettings),b("body",window.parent.document).on("click",".fl-builder-node-template-settings .fl-builder-settings-save",FLBuilder._saveNodeTemplate),b("body",window.parent.document).on("click",".fl-builder-settings-tabs a",FLBuilder._settingsTabClicked),b("body",window.parent.document).on("show",".fl-builder-settings-tabs a",FLBuilder._calculateSettingsTabsOverflow),b("body",window.parent.document).on("hide",".fl-builder-settings-tabs a",FLBuilder._calculateSettingsTabsOverflow),b("body",window.parent.document).on("click",".fl-builder-settings-cancel",FLBuilder._settingsCancelClicked),b("body",window.parent.document).on("click",".fl-builder-settings-tabs-overflow-menu > a",FLBuilder._settingsTabsToOverflowMenuItemClicked.bind(this)),b("body",window.parent.document).on("click",".fl-builder-settings-tabs-more",FLBuilder._toggleTabsOverflowMenu.bind(this)),b("body",window.parent.document).on("click",".fl-builder-settings-tabs-overflow-click-mask",FLBuilder._hideTabsOverflowMenu.bind(this)),b("body",window.parent.document).on("mouseover",".fl-help-tooltip-icon",FLBuilder._showHelpTooltip),b("body",window.parent.document).on("mouseout",".fl-help-tooltip-icon",FLBuilder._hideHelpTooltip),b("body",window.parent.document).on("click",".fl-builder-field-add",FLBuilder._addFieldClicked),b("body",window.parent.document).on("click",".fl-builder-field-copy",FLBuilder._copyFieldClicked),b("body",window.parent.document).on("click",".fl-builder-field-delete",FLBuilder._deleteFieldClicked),b("body",window.parent.document).on("click",".fl-photo-field .fl-photo-select",FLBuilder._selectSinglePhoto),b("body",window.parent.document).on("click",".fl-photo-field .fl-photo-edit",FLBuilder._selectSinglePhoto),b("body",window.parent.document).on("click",".fl-photo-field .fl-photo-replace",FLBuilder._selectSinglePhoto),b("body",window.parent.document).on("click",".fl-photo-field .fl-photo-remove",FLBuilder._singlePhotoRemoved),b("body",window.parent.document).on("click",".fl-multiple-photos-field .fl-multiple-photos-select",FLBuilder._selectMultiplePhotos),b("body",window.parent.document).on("click",".fl-multiple-photos-field .fl-multiple-photos-edit",FLBuilder._selectMultiplePhotos),b("body",window.parent.document).on("click",".fl-multiple-photos-field .fl-multiple-photos-add",FLBuilder._selectMultiplePhotos),b("body",window.parent.document).on("click",".fl-video-field .fl-video-select",FLBuilder._selectSingleVideo),b("body",window.parent.document).on("click",".fl-video-field .fl-video-replace",FLBuilder._selectSingleVideo),b("body",window.parent.document).on("click",".fl-video-field .fl-video-remove",FLBuilder._singleVideoRemoved),b("body",window.parent.document).on("click",".fl-multiple-audios-field .fl-multiple-audios-select",FLBuilder._selectMultipleAudios),b("body",window.parent.document).on("click",".fl-multiple-audios-field .fl-multiple-audios-edit",FLBuilder._selectMultipleAudios),b("body",window.parent.document).on("click",".fl-multiple-audios-field .fl-multiple-audios-add",FLBuilder._selectMultipleAudios),b("body",window.parent.document).on("click",".fl-icon-field .fl-icon-select",FLBuilder._selectIcon),b("body",window.parent.document).on("click",".fl-icon-field .fl-icon-replace",FLBuilder._selectIcon),b("body",window.parent.document).on("click",".fl-icon-field .fl-icon-remove",FLBuilder._removeIcon),b("body",window.parent.document).on("click",".fl-form-field .fl-form-field-edit",FLBuilder._formFieldClicked),b("body",window.parent.document).on("click",".fl-form-field-settings .fl-builder-settings-save",FLBuilder._saveFormFieldClicked),b("body",window.parent.document).on("click",".fl-layout-field-option",FLBuilder._layoutFieldClicked),b("body",window.parent.document).on("click",".fl-link-field-select",FLBuilder._linkFieldSelectClicked),b("body",window.parent.document).on("click",".fl-link-field-search-cancel",FLBuilder._linkFieldSelectCancelClicked),b("body",window.parent.document).on("change",".fl-loop-data-source-select select[name=data_source]",FLBuilder._loopDataSourceChange),b("body",window.parent.document).on("change",".fl-custom-query select[name=post_type]",FLBuilder._customQueryPostTypeChange),b("body",window.parent.document).on("change",'.fl-custom-query select[name="post_type[]"]',FLBuilder._customQueryPostTypesChange),b("body",window.parent.document).on("change",".fl-text-field-add-value",FLBuilder._textFieldAddValueSelectChange),b("body",window.parent.document).on("focus",".fl-field input[type=number]",FLBuilder._onNumberFieldFocus),b("body",window.parent.document).on("blur",".fl-field input[type=number]",FLBuilder._onNumberFieldBlur),FLBuilder.addHook("didCompleteAJAX",FLBuilder._refreshSettingsPreviewReference),FLBuilder.addHook("didRenderLayoutComplete",FLBuilder._refreshSettingsPreviewReference)},_unbindEvents:function(){b("a").off("click",FLBuilder._preventDefault),b(".fl-page-nav .nav a").off("click",FLBuilder._headerLinkClicked),b("body").undelegate(".fl-builder-content a","click",FLBuilder._preventDefault)},_rebindEvents:function(){b("a").on("click",FLBuilder._preventDefault),b(".fl-page-nav .nav a").on("click",FLBuilder._headerLinkClicked),b("body").on("click",".fl-builder-content a",FLBuilder._preventDefault)},_preventDefault:function(e){e.preventDefault()},_stopPropagation:function(e){e.stopPropagation()},_headerLinkClicked:function(e){var t=b(this).attr("href");this.hash||(e.preventDefault(),FLBuilderConfig.isUserTemplate)||(FLBuilder._exitUrl=-1<t.indexOf("?")?t:t+"?fl_builder",FLBuilder.triggerHook("triggerDone"))},_warnBeforeUnload:function(){var e=0<b(".fl-builder-row-settings",window.parent.document).length,t=0<b(".fl-builder-col-settings",window.parent.document).length,i=0<b(".fl-builder-module-settings",window.parent.document).length;if(!FLBuilder.isBlockEditor()&&(e||t||i))return FLBuilderStrings.unloadWarning},_upgradeClicked:function(){window.parent.open(FLBuilderConfig.upgradeUrl)},_toggleProModules:function(){var e=b(".fl-builder-blocks-pro-expand",window.parent.document),t=b(".fl-builder-blocks-pro-closed",window.parent.document),i=b(".fl-builder-blocks-pro-open",window.parent.document);e.toggleClass("fl-builder-blocks-pro-expand-rotate"),t.length?(t.removeClass("fl-builder-blocks-pro-closed"),t.addClass("fl-builder-blocks-pro-open")):(i.removeClass("fl-builder-blocks-pro-open"),i.addClass("fl-builder-blocks-pro-closed"))},_showProMessage:function(e){var t,i;FLBuilderConfig.lite&&(t=new FLLightbox({className:"fl-builder-pro-lightbox",destroyOnClose:!0}),i=wp.template("fl-pro-lightbox"),t.open(i({feature:e})))},_initTipTips:function(){var e=".fl-tip:not(.fl-has-tip)",e=b(e).add(e,window.parent.document);e.each(function(){var e=b(this);e.addClass("fl-has-tip"),null==e.attr("data-title")&&e.attr("data-title",e.attr("title"))}),FLBuilderLayout._isTouch()||e.tipTip({defaultPosition:"top",delay:300,maxWidth:"auto"})},_hideTipTips:function(){b("#tiptip_holder").stop().hide(),b("#tiptip_holder",window.parent.document).stop().hide()},_submenuParentClicked:function(e){var t=b("body"),i=b(this),l=i.find(".fl-builder-submenu");i.hasClass("fl-builder-submenu-open")?(t.removeClass("fl-builder-submenu-open"),i.removeClass("fl-builder-submenu-open"),i.removeClass("fl-builder-submenu-right")):(i.offset().left+l.width()>b(window).width()&&i.addClass("fl-builder-submenu-right"),t.addClass("fl-builder-submenu-open"),i.addClass("fl-builder-submenu-open")),l.closest(".fl-row-overlay").addClass("fl-row-menu-active"),FLBuilder._hideTipTips(),e.preventDefault(),e.stopPropagation()},_hoverMenuParentMouseEnter:function(e){e.stopPropagation();var e=b("body"),t=b(this),i=t.find(".fl-builder-submenu");b(".fl-builder-submenu").each(function(){var e=b(this).data("timeout");void 0!==e&&clearTimeout(e)}),b(".fl-builder-submenu-right").removeClass("fl-builder-submenu-right"),b(".fl-builder-submenu-open").removeClass("fl-builder-submenu-open"),b(".fl-row-menu-active").removeClass("fl-row-menu-active"),t.offset().left+i.width()>b(window).width()&&t.addClass("fl-builder-submenu-right"),t.closest(".fl-row-overlay").addClass("fl-row-menu-active"),e.addClass("fl-builder-submenu-open"),t.addClass("fl-builder-submenu-open")},_hoverMenuParentMouseLeave:function(e){var t=b(this),i=t.find(".fl-builder-submenu"),l=setTimeout(function(){t.removeClass("fl-builder-submenu-right"),t.removeClass("fl-builder-submenu-open"),t.closest(".fl-row-overlay").removeClass("fl-row-menu-active")},500);i.data("timeout",l)},_submenuChildClicked:function(e){var t=b("body"),i=b(this).parents(".fl-builder-has-submenu");i.parents(".fl-builder-has-submenu").length||(t.removeClass("fl-builder-submenu-open"),i.removeClass("fl-builder-submenu-open"))},_submenuMouseenter:function(e){var t;b(this).parent().hasClass("fl-builder-submenu-hover")||void 0!==(t=b(this).data("timeout"))&&clearTimeout(t)},_submenuMouseleave:function(e){var t,i,l;b(this).parent().hasClass("fl-builder-submenu-hover")||(t=b("body"),i=b(this),l=setTimeout(function(){t.removeClass("fl-builder-submenu-open"),i.closest(".fl-builder-has-submenu").removeClass("fl-builder-submenu-open")},500),i.closest(".fl-row-overlay").removeClass("fl-row-menu-active"),i.data("timeout",l))},_submenuNestedParentMouseenter:function(e){var t=b(this),i=t.find("> .fl-builder-submenu"),l=b(window).width(),n=t.offset().left,o=l-(t.width()+n);l<t.width()+n+i.width()&&i.width()<n?t.addClass("fl-builder-submenu-right"):i.width()>o&&(l=t.width()-(i.width()-o),i.css("left",l))},_closeAllSubmenus:function(){b(".fl-builder-submenu-open").removeClass("fl-builder-submenu-open")},_buttonMouseUp:function(e){b(e.currentTarget).blur()},_closePanel:function(){FLBuilder.triggerHook("hideContentPanel")},_showPanel:function(){FLBuilder.triggerHook("showContentPanel")},_togglePanel:function(){FLBuilder.triggerHook("toggleContentPanel")},_publishLayout:function(e,t){var i;FLBuilder._triggerSettingsSave(t,!0)&&(_.isUndefined(e)&&(e=!0),t=FL.Builder.data.getLayoutActions(),i=FLBuilder._onPublishComplete.bind(FLBuilder,e),t.saveLayout(!0,e,i))},_publishButtonClicked:function(e){FLBuilder._publishLayout(e)},_onPublishComplete:function(e){e&&(FLBuilderConfig.shouldRefreshOnPublish?FLBuilder._exit():FLBuilder._exitWithoutRefresh()),b("#wp-admin-bar-fl-builder-frontend-edit-link .fl-builder-admin-bar-status-dot").css("color","#6bc373"),FLBuilder.triggerHook("didPublishLayout",{shouldExit:e})},_draftButtonClicked:function(){FLBuilder.showAjaxLoader(),FL.Builder.data.getLayoutActions().saveDraft()},_discardButtonClicked:function(){confirm(FLBuilderStrings.discardMessage)?(FLBuilder.showAjaxLoader(),FL.Builder.data.getLayoutActions().discardDraft()):FLBuilder.triggerHook("didCancelDiscard")},_cancelButtonClicked:function(){FLBuilder._exitUrl=null,FLBuilder._actionsLightbox.close()},_exit:function(){var e=window.parent.location.href;try{var t=void 0!==window.parent.opener.FLBuilder}catch(e){t=!1}FLBuilderConfig.isUserTemplate&&void 0!==window.parent.opener&&window.parent.opener?(t&&("undefined"==typeof FLBuilderGlobalNodeId?window.parent.opener.FLBuilder._updateLayout():window.parent.opener.FLBuilder._updateNode(FLBuilderGlobalNodeId)),window.parent.close()):(e=FLBuilder._exitUrl||(e=(e=(e=e.replace("&fl_builder_ui","")).replace("?fl_builder&","?")).replace("?fl_builder","")).replace("&fl_builder",""),"playground.wordpress.net"===window.parent.location.host?(t='<meta http-equiv="refresh" content="0; URL=\''+e+"'\" />",b("head",window.parent.document).append(t)):window.parent.location.href=e)},_exitWithoutRefresh:function(){window.parent.location.href;try{var t=void 0!==window.parent.opener.FLBuilder}catch(e){t=!1}FLBuilderConfig.isUserTemplate&&t&&window.opener?(t&&("undefined"==typeof FLBuilderGlobalNodeId?window.parent.opener.FLBuilder._updateLayout():window.parent.opener.FLBuilder._updateNode(FLBuilderGlobalNodeId)),window.parent.close()):FLBuilder.triggerHook("endEditingSession")},_duplicateLayoutClicked:function(){FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"duplicate_post"},FLBuilder._duplicateLayoutComplete)},_duplicateLayoutComplete:function(e){var t=FLBuilderConfig.adminUrl;window.parent.location.href=t+"post.php?post="+e+"&action=edit"},_layoutSettingsClicked:function(){FLBuilderSettingsForms.render({id:"layout",className:"fl-builder-layout-settings",settings:FLBuilderSettingsConfig.settings.layout},function(){FLBuilder._layoutSettingsInitCSS()})},_layoutSettingsInitCSS:function(){var e=b(".fl-builder-settings #fl-field-css textarea:not(.ace_text-input)",window.parent.document);e.on("change",FLBuilder._layoutSettingsCSSChanged),FLBuilder._layoutSettingsCSSCache=e.val()},_layoutSettingsCSSChanged:function(){FLBuilder._layoutSettingsCSSTimeout&&clearTimeout(FLBuilder._layoutSettingsCSSTimeout),FLBuilder._layoutSettingsCSSTimeout=setTimeout(b.proxy(FLBuilder._layoutSettingsCSSDoChange,this),600)},_layoutSettingsCSSDoChange:function(){var e=b(".fl-builder-settings",window.parent.document),t=b(this);0<t.parents("#fl-field-css").find(".ace_error").length||((e.hasClass("fl-builder-layout-settings")?b("#fl-builder-layout-css"):b("#fl-builder-global-css")).html(t.val()),FLBuilder._layoutSettingsCSSTimeout=null)},_saveLayoutSettingsClicked:function(){for(var e=b(this).closest(".fl-builder-settings").serializeArray(),t={},i=0;i<e.length;i++)t[e[i].name]=e[i].value;FLBuilder.showAjaxLoader(),FLBuilder._lightbox.close(),FLBuilder._layoutSettingsCSSCache=null,FL.Builder.data.getLayoutActions().saveLayoutSettings(t)},_cancelLayoutSettingsClicked:function(){(b(".fl-builder-settings",window.parent.document).hasClass("fl-builder-layout-settings")?b("#fl-builder-layout-css"):b("#fl-builder-global-css")).html(FLBuilder._layoutSettingsCSSCache),FLBuilder._layoutSettingsCSSCache=null},_saveLayoutSettingsComplete:function(e){FLBuilder.triggerHook("didSaveLayoutSettingsComplete",e),FLBuilder._updateLayout()},_globalSettingsClicked:function(){var e=FLBuilderSettingsConfig.settings.global;e.color_scheme=FL.Builder.data.getSystemState().colorScheme,FLBuilderSettingsForms.render({id:"global",className:"fl-builder-global-settings",settings:e},function(){FLBuilder._layoutSettingsInitCSS(),FLBuilder.original_shapes=FLBuilderSettingsConfig.settings.global.shape_form})},_saveGlobalSettingsClicked:function(){var e=b(this).closest(".fl-builder-settings"),t=e.validate().form(),e=FLBuilder._getSettings(e);t&&(FLBuilder.showAjaxLoader(),FLBuilder._layoutSettingsCSSCache=null,FL.Builder.data.getLayoutActions().saveGlobalSettings(e),FLBuilder._lightbox.close(),void 0!==FLBuilder.original_shapes)&&FLBuilder.original_shapes.length!==e.shape_form?.length&&(FLBuilder._shapesEdited=!0)},_saveGlobalSettingsComplete:function(e){FLBuilder.triggerHook("didSaveGlobalSettingsComplete",FLBuilder._jsonParse(e)),FLBuilder._updateLayout(),!0===FLBuilder._shapesEdited&&window.parent.location.reload(!0)},_globalStylesClicked:function(){FLBuilderConfig.lite?FLBuilder._showProMessage("Global Styles"):"undefined"!=typeof FLBuilderGlobalStyles&&FLBuilderGlobalStyles._showPanel()},_initTemplateSelector:function(){0<b(FLBuilder._contentClass).find(".fl-row").length||FLBuilder.ContentPanel.show("modules")},_requestTemplateInsert:function(e,t){FLBuilder.layoutHasContent()?0==e?confirm(FLBuilderStrings.changeTemplateMessage)&&(FLBuilder._lightbox._node.hide(),FLBuilder._applyTemplate(0,!1,t)):(FLBuilder._selectedTemplateId=e,FLBuilder._selectedTemplateType=t,FLBuilder._showTemplateActions(),FLBuilder._lightbox._node.hide()):FLBuilder._applyTemplate(e,!1,t)},_showTemplateActions:function(){var e=[];e[10]={key:"template-replace",label:FLBuilderStrings.templateReplace},e[20]={key:"template-append",label:FLBuilderStrings.templateAppend},FLBuilder._showActionsLightbox({className:"fl-builder-template-actions",title:FLBuilderStrings.actionsLightboxTitle,buttons:e})},_templateReplaceClicked:function(){confirm(FLBuilderStrings.changeTemplateMessage)&&(FLBuilder._actionsLightbox.close(),FLBuilder._applyTemplate(FLBuilder._selectedTemplateId,!1,FLBuilder._selectedTemplateType))},_templateAppendClicked:function(){FLBuilder._actionsLightbox.close(),FLBuilder._applyTemplate(FLBuilder._selectedTemplateId,!0,FLBuilder._selectedTemplateType)},_templateCancelClicked:function(){FLBuilder.triggerHook("showContentPanel")},_applyTemplate:function(e,t,i){t=void 0!==t&&t?"1":"0",i=void 0===i?"core":i,FLBuilder._lightbox.close(),FLBuilder.showAjaxLoader(),FL.Builder.data.getLayoutActions().applyTemplate(e,t,i),FLBuilder.triggerHook("didApplyTemplate")},_applyTemplateComplete:function(e){e=FLBuilder._jsonParse(e);FLBuilder._renderLayout(e.layout),FLBuilder.triggerHook("didApplyTemplateComplete",e.config)},_applyUserTemplateComplete:function(e){e=FLBuilder._jsonParse(e);null!==e.layout_css&&b("#fl-builder-layout-css").html(e.layout_css),FLBuilder._renderLayout(e.layout),FLBuilder.triggerHook("didApplyTemplateComplete",e.config)},_saveUserTemplateClicked:function(){FLBuilderConfig.lite?FLBuilder._showProMessage("Saving Templates"):FLBuilderSettingsForms.render({id:"user_template",className:"fl-builder-user-template-settings",rules:{name:{required:!0}}})},_saveUserTemplateSettings:function(){var e=b(this).closest(".fl-builder-settings"),t=e.validate().form(),e=FLBuilder._getSettings(e);t&&(FL.Builder.data.getLayoutActions().saveUserTemplateSettings(e),FLBuilder._lightbox.close())},_saveUserTemplateSettingsComplete:function(e){e&&(e=FLBuilder._jsonParse(e),FLBuilderConfig.contentItems.template.push(e),FLBuilder.triggerHook("contentItemsChanged"))},_userTemplateClicked:function(){var e=b(this).attr("data-id");0<b(FLBuilder._contentClass).children(".fl-row").length?"blank"==e?confirm(FLBuilderStrings.changeTemplateMessage)&&(FLBuilder._lightbox._node.hide(),FLBuilder._applyTemplate("blank",!1,"user")):(FLBuilder._selectedTemplateId=e,FLBuilder._selectedTemplateType="user",FLBuilder._showTemplateActions(),FLBuilder._lightbox._node.hide()):FLBuilder._applyTemplate(e,!1,"user")},_editUserTemplateClicked:function(e){e.preventDefault(),e.stopPropagation(),window.parent.open(b(this).attr("href"))},_deleteUserTemplateClicked:function(e){var t=b(this).closest(".fl-user-template").attr("data-id"),i=(b(".fl-user-template[data-id="+t+"]",window.parent.document),null),l=null;if(confirm(FLBuilderStrings.deleteTemplate)){for(l in FL.Builder.data.getLayoutActions().deleteUserTemplate(t),FLBuilderConfig.contentItems.template)FLBuilderConfig.contentItems.template[l].postId==t&&(i=l);_.isNull(i)||(FLBuilderConfig.contentItems.template.splice(i,1),FLBuilder.triggerHook("contentItemsChanged"))}e.stopPropagation()},_showTourOrTemplates:function(){FLBuilderConfig.simpleUi||FLBuilderConfig.isUserTemplate||(FLBuilderConfig.help.tour&&FLBuilderConfig.newUser?FLBuilder._showTourLightbox():FLBuilder._initTemplateSelector())},_doStats:function(){1==FLBuilderConfig.statsEnabled&&(args={"screen-width":screen.width,"screen-height":screen.height,"pixel-ratio":window.devicePixelRatio,"user-agent":window.navigator.userAgent,isrtl:FLBuilderConfig.isRtl},FLBuilder.ajax({action:"save_browser_stats",browser_data:args}))},_showTourLightbox:function(){var e=wp.template("fl-tour-lightbox");FLBuilder._actionsLightbox.open(e())},_noTourButtonClicked:function(){FLBuilder._actionsLightbox.close(),FLBuilder._initTemplateSelector()},_yesTourButtonClicked:function(){FLBuilder._actionsLightbox.close(),FLBuilderTour.start()},_startHelpTour:function(){FLBuilder._actionsLightbox.close(),FLBuilderTour.start()},_setupEmptyLayout:function(){var e=b(FLBuilder._contentClass);FLBuilderConfig.isUserTemplate&&"module"==FLBuilderConfig.userTemplateType||FLBuilderConfig.isUserTemplate&&"column"==FLBuilderConfig.userTemplateType||(e.removeClass("fl-builder-empty"),e.find(".fl-builder-empty-message").remove(),e.find(".fl-row, .fl-module, .fl-builder-block").length)||(e.addClass("fl-builder-empty"),e.append('<span class="fl-builder-empty-message">'+FLBuilderStrings.emptyMessage+"</span>"),FLBuilder._initSortables())},_updateNode:function(e,t){b(".fl-node-"+e).length&&(FLBuilder._showNodeLoading(e),FL.Builder.data.getLayoutActions().renderNode(e,t))},_updateLayout:function(){FLBuilder.showAjaxLoader();var e=FL.Builder.data.getLayoutActions();e.renderLayout(),e.fetchLayout()},_renderLayout:function(e,t){FLBuilder._layout?FLBuilder._layoutQueue.push({data:e,callback:t}):FLBuilder._layout=new FLBuilderAJAXLayout(e,t)},_renderLayoutComplete:function(){var e;FLBuilder._layout&&(FLBuilder._layout._complete(),FLBuilder._layout=null),FLBuilder._layoutQueue.length&&(e=FLBuilder._layoutQueue.shift(),FLBuilder._layout=new FLBuilderAJAXLayout(e.data,e.callback))},_resizeLayout:function(){b(window).trigger("resize"),"undefined"!=typeof YUI&&YUI().use("node-event-simulate",function(e){e.one(window).simulate("resize")})},layoutHasContent:function(){return 0<b(FLBuilder._contentClass).children(".fl-row, .fl-module").length},_initMediaElements:function(){var e={};void 0!==b.fn.mediaelementplayer&&("undefined"!=typeof _wpmejsSettings&&(e.pluginPath=_wpmejsSettings.pluginPath),b(".wp-audio-shortcode, .wp-video-shortcode").not(".mejs-container").mediaelementplayer(e))},_initDropTargets:function(){var e="row"==FLBuilderConfig.userTemplateType?"":":not(.fl-node-global)",t=b(FLBuilder._contentClass+" .fl-row"),i=b(FLBuilder._contentClass+" .fl-row"+e).find(".fl-col-group"),l=null,n=null,o="column"==FLBuilderConfig.userTemplateType?b(FLBuilder._contentClass+"> .fl-col").eq(0):null,s=b(FLBuilder._contentClass).find("> .fl-module"),e=b(FLBuilder._contentClass+" .fl-row"+e).find(".fl-row-content > .fl-module"),r=0;for(b(".fl-col-drop-target").remove(),b(".fl-col-group-drop-target").remove(),b(".fl-row-drop-target").remove(),b(FLBuilder._contentClass).append('<div class="fl-drop-target fl-row-drop-target"></div>'),t.prepend('<div class="fl-drop-target fl-row-drop-target"></div>'),t.append('<div class="fl-drop-target fl-drop-target-last fl-row-drop-target fl-row-drop-target-last"></div>'),t.find(".fl-row-content").prepend('<div class="fl-drop-target fl-col-group-drop-target fl-col-group-drop-target-empty"></div>'),FLBuilder._initEmptyRowDropTargets(),s.prepend('<div class="fl-drop-target fl-row-drop-target"></div>'),s.append('<div class="fl-drop-target fl-drop-target-last fl-row-drop-target fl-row-drop-target-last"></div>'),e.append('<div class="fl-drop-target fl-col-group-drop-target"></div>'),e.append('<div class="fl-drop-target fl-drop-target-last fl-col-group-drop-target fl-col-group-drop-target-last"></div>'),r=0;r<i.length;r++)n=(l=i.eq(r)).find("> .fl-col"),l.hasClass("fl-col-group-nested")||(l.append('<div class="fl-drop-target fl-col-group-drop-target"></div>'),l.append('<div class="fl-drop-target fl-drop-target-last fl-col-group-drop-target fl-col-group-drop-target-last"></div>')),n.append('<div class="fl-drop-target fl-col-drop-target"></div>'),n.append('<div class="fl-drop-target fl-drop-target-last fl-col-drop-target fl-col-drop-target-last"></div>');o&&0===i.length&&(i=o.find(".fl-col-group"),o.append('<div class="fl-drop-target fl-col-drop-target"></div>'),o.append('<div class="fl-drop-target fl-drop-target-last fl-col-drop-target fl-col-drop-target-last"></div>'))},_initEmptyRowDropTargets:function(){var e=b(FLBuilder._contentClass+" .fl-row-content:not(:has(*:visible))");b(".fl-row-content-empty").removeClass(".fl-row-content-empty"),e.length&&e.addClass("fl-row-content-empty")},_blockDragHelper:function(e,t){var i=t.clone();return t.clone().insertAfter(t),i.addClass("fl-builder-block-drag-helper"),i},_blockDragInit:function(e){var t=b(e.currentTarget),i=null,l=b(window).scrollTop(),n=0;FLBuilder._dragEnabled=!0,FLBuilder._dragInitialScrollTop=l,0<t.closest("[data-node]").length?(i=t.closest("[data-node]")).addClass("fl-node-drag-init"):t.hasClass("fl-builder-block")&&b(".fl-row").each(function(){null===i&&0<b(this).offset().top-l&&(i=b(this))}),null!==i&&(n=i.offset().top-l),FLBuilder._highlightRowsAndColsForDrag(t),FLBuilder._adjustColHeightsForDrag(),FLBuilder._disableGlobalNodes(),FLBuilder._destroyOverlayEvents(),FLBuilder._initSortables(),b("body").addClass("fl-builder-dragging"),b("body",window.parent.document).addClass("fl-builder-dragging"),b(".fl-builder-empty-message").hide(),b(".fl-sortable-disabled").removeClass("fl-sortable-disabled"),"touchstart"===e.type||b(e.target).hasClass("fl-sortable-proxy-item ")||FLBuilder._removeAllOverlays(),0<n&&scrollTo(0,i.offset().top-n),FLBuilder.triggerHook("didInitDrag")},_blockDragStart:function(e,t){FLBuilder._dragging=!0,b(".fl-node-drag-init").removeClass("fl-node-drag-init"),FLBuilder.triggerHook("didStartDrag")},_blockDragSort:function(e,t){var i,l,n,o=t.placeholder.parent(),s=FLBuilderStrings.insert;FLBuilder._blockPreventSort(t.item,o)||(b(".fl-sortable-fixed-width").css("max-width","").removeClass("fl-sortable-fixed-width"),o.hasClass("fl-col-content")||o.hasClass("fl-module")||o.hasClass("fl-module-content")||o.data("children-wrapper")?(/flex/.test(o.css("display"))&&(t.placeholder.hide(),o.css("max-width",""),o.css("max-width",o.outerWidth()),o.addClass("fl-sortable-fixed-width"),t.placeholder.show()),s=/flex/.test(o.css("display"))&&/row|row-reverse/.test(o.css("flex-direction"))?"":t.item.hasClass("fl-builder-block-row")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-col-sortable-proxy-item")?FLBuilderStrings.column:t.item.hasClass("fl-builder-block-module")||t.item.hasClass("fl-builder-block-saved-module")||t.item.hasClass("fl-builder-block-module-template")?t.item.find(".fl-builder-block-title").text():t.item.data("name")):o.hasClass("fl-col-drop-target")||o.hasClass("fl-col-group-drop-target")?s="":o.hasClass("fl-row-drop-target")&&(s=t.item.hasClass("fl-builder-block-row")||t.item.hasClass("fl-builder-block-saved-row")||t.item.hasClass("fl-builder-block-saved-column")?t.item.find(".fl-builder-block-title").text():t.item.hasClass("fl-row-sortable-proxy-item")?FLBuilderStrings.row:t.item.hasClass("fl-builder-block-module")||t.item.hasClass("fl-module-sortable-proxy-item")?(i=t.item.data("type"),l=t.item.data("alias"),n=!!(o=FLBuilderConfig.contentItems.module.filter(e=>l===e.alias&&i===e.slug).pop())&&o.accepts,o=o?o.name:"",n&&n.length?o:FLBuilderStrings.newRow):t.item.hasClass("fl-builder-block-saved-module")?t.item.find(".fl-builder-block-title").text():FLBuilderStrings.newRow),t.placeholder.html(s),t.item.hasClass("fl-node-global")||t.item.hasClass("fl-builder-block-global")||b(".fl-node-dragging").hasClass("fl-node-global")?t.placeholder.addClass("fl-builder-drop-zone-global"):t.placeholder.removeClass("fl-builder-drop-zone-global"))},_blockDragChange:function(e,t){FLBuilder._initEmptyRowDropTargets(),t.placeholder.css("opacity","0"),t.placeholder.animate({opacity:"1"},100)},_blockPreventSort:function(e,t){var i,l=!1,n=e.hasClass("fl-builder-block-row"),o=e.hasClass("fl-col-sortable-proxy-item"),s=e.hasClass("fl-builder-block-module")||e.hasClass("fl-module-sortable-proxy-item"),r=t.data("accepts"),d=t.data("children-wrapper"),a=t.closest(".fl-col[data-template-url]").hasClass("fl-node-global"),u=t.hasClass("fl-col-content"),c=t.hasClass("fl-col-drop-target"),f=t.parents(".fl-col-group:not(.fl-col-group-nested)"),h=t.parents(".fl-col-group-nested"),p=t.data("type"),g=e.data("type");return(r||d)&&(r=!!(i=FLBuilderConfig.contentItems.module.filter(e=>g===e.slug).pop())&&i.accepts,n||o||"object"==typeof r&&r.length&&!r.includes(g))&&(l=!0),s&&"widget"!==g&&"object"==typeof(d=!!(i=FLBuilderConfig.contentItems.module.filter(e=>g===e.slug).pop())&&i.parents)&&!d.includes(p)&&(l=!0),(n||o)&&u&&0<h.length&&(l=!0),u&&!t.find(".fl-module, .fl-col").length&&(n&&"1-col"==e.data("cols")||o)&&(l=!0),n&&u&&-1<b.inArray(e.data("cols"),["5-cols","6-cols"])&&(l=!0),o&&0<b(".fl-node-dragging").find(".fl-col-group-nested").length&&(u||c&&0<h.length)&&(l=!0),c&&0<f.length&&0===h.length&&11<f.find("> .fl-col:visible").length&&(l=!0),c&&0<h.length&&3<h.find(".fl-col:visible").length&&(l=!0),s&&a&&"column"!==FLBuilderConfig.userTemplateType&&(l=!0),(l=t.closest(".fl-builder-shortcode-mask-wrap").length?!0:l)&&t.addClass("fl-sortable-disabled"),l},_blockDragStop:function(e,t){var i=b(window).scrollTop(),t=t.item.parent(),l=null,l=t.hasClass("fl-drop-target")&&t.closest("[data-node]").length?(t=t.closest("[data-node]")).offset().top-i:t.offset().top-i;t.hasClass("fl-builder-blocks-section-content")&&FLBuilder._showPanel(),FLBuilder._dragEnabled=!1,FLBuilder._dragging=!1,FLBuilder._bindOverlayEvents(),FLBuilder._removeEmptyRowAndColHighlights(),FLBuilder._highlightEmptyCols(),FLBuilder._enableGlobalNodes(),FLBuilder._setupEmptyLayout(),b("body").removeClass("fl-builder-dragging"),b("body",window.parent.document).removeClass("fl-builder-dragging"),scrollTo(0,t.offset().top-l),FLBuilder.triggerHook("didStopDrag")},_blockDragCancel:function(){FLBuilder._dragEnabled&&!FLBuilder._dragging&&(FLBuilder._dragEnabled=!1,FLBuilder._dragging=!1,FLBuilder._bindOverlayEvents(),FLBuilder._removeEmptyRowAndColHighlights(),FLBuilder._highlightEmptyCols(),FLBuilder._enableGlobalNodes(),FLBuilder._setupEmptyLayout(),b("body").removeClass("fl-builder-dragging"),b("body",window.parent.document).removeClass("fl-builder-dragging"),b(".fl-node-drag-init").removeClass("fl-node-drag-init"),b(".fl-node-dragging").removeClass("fl-node-dragging"),scrollTo(0,FLBuilder._dragInitialScrollTop),FLBuilder.triggerHook("didCancelDrag"))},_reorderNode:function(e,t){FL.Builder.getActions().moveNode(e,t)},_reorderNodeComplete:function(e){var e=FLBuilder._jsonParse(e),t="didMove"+e.nodeType.charAt(0).toUpperCase()+e.nodeType.slice(1);FLBuilder.triggerHook("didMoveNode",e),FLBuilder.triggerHook(t,e)},_moveNodeUpClicked:function(e){var e=b(e.target).closest("[data-node]"),t=e.attr("data-node"),i=FL.Builder.data.getNode(t),l=i.position-1,n=e.find(".fl-block-move-up").first(),o=e.find(".fl-block-move-down").first();l<=0?n.addClass("fl-builder-submenu-disabled"):n.removeClass("fl-builder-submenu-disabled"),o.removeClass("fl-builder-submenu-disabled"),FLBuilder._reorderNode(t,l),FLBuilder._selectNodeOverlay(e,!1),FL.Builder.data.updateNode(t,{...i,position:l})},_moveNodeDownClicked:function(e){var e=b(e.target).closest("[data-node]"),t=e.attr("data-node"),i=FL.Builder.data.getNode(t),l=i.position+1,n=e.find(".fl-block-move-up").first(),o=e.find(".fl-block-move-down").first();l>=e.parent().find("> [data-node]").length-1?o.addClass("fl-builder-submenu-disabled"):o.removeClass("fl-builder-submenu-disabled"),n.removeClass("fl-builder-submenu-disabled"),FLBuilder._reorderNode(t,l),FLBuilder._selectNodeOverlay(e,!1),FL.Builder.data.updateNode(t,{...i,position:l})},_moveNode:function(e,t,i){var l=FL.Builder.getActions();b(".fl-node-"+t).attr("data-parent",e),l.moveNode(t,i,e)},_moveNodeComplete:function(e){var e=FLBuilder._jsonParse(e),t="didMove"+e.nodeType.charAt(0).toUpperCase()+e.nodeType.slice(1);FLBuilder.triggerHook("didMoveNode",e),FLBuilder.triggerHook(t,e)},_getJQueryElement:function(e){return b(FLBuilder._contentClass).find('[data-node="'+e+'"]')},_getNodeLayoutDirection:function(e){var t=/flex/.test(e.parent().css("display")),i=/row|row-reverse/.test(e.parent().css("flex-direction")),l=/grid/.test(e.parent().css("display")),n=l&&"1 / 1 / -1 / -1"===e.css("grid-area"),e=1===window.getComputedStyle(e.parent()[0]).getPropertyValue("grid-template-columns").split(" ").length;if(t&&i)return"horizontal";if(l){if(n)return"layered";if(!e)return"horizontal"}return"vertical"},_needsDeleteConfirmation:function(e){return"module"===e.type||0<FLBuilder._getJQueryElement(e.node).find(".fl-module").length},_disableGlobalNodes:function(){"row"!==FLBuilderConfig.userTemplateType&&b(".fl-row.fl-node-global").addClass("fl-node-disabled"),"column"!==FLBuilderConfig.userTemplateType&&b(".fl-row:not(.fl-node-global) .fl-col.fl-node-global").addClass("fl-node-disabled"),"module"!==FLBuilderConfig.userTemplateType&&b(".fl-module.fl-node-global[data-accepts][data-template-url]").addClass("fl-node-disabled")},_enableGlobalNodes:function(){b(".fl-node-disabled").removeClass("fl-node-disabled")},_nodeSettingsClicked:function(e){var t=b(this),i=t.attr("data-target-node"),l=FL.Builder.getActions(),i=i||t.parents("[data-node]").attr("data-node");l.openSettings(i),e.stopPropagation()},_nodeDuplicateClicked:function(e){var t=b(this),i=t.attr("data-target-node"),l=FL.Builder.getActions(),i=i||t.parents("[data-node]").attr("data-node");l.copyNode(i),e.stopPropagation()},_nodeRemoveClicked:function(e){var t=b(this),i=t.attr("data-target-node"),l=FL.Builder.getActions(),i=i||t.parents("[data-node]").attr("data-node");l.deleteNode(i),e.stopPropagation()},_rowDragHelper:function(){return b('<div class="fl-builder-block-drag-helper">'+FLBuilderStrings.row+"</div>")},_rowDragInit:function(e){var t=b(e.target),i=b(".fl-row-sortable-proxy-item",window.parent.document),l=t.closest(".fl-row");t.closest(".fl-block-move-menu").length||(l.addClass("fl-node-dragging"),FLBuilder._blockDragInit(e),e.target=i[0],i.trigger(e))},_rowDragInitTouch:function(t){var e=b(t.target),i=b(".fl-row-sortable-proxy-item",window.parent.document),l=e.closest(".fl-row"),n=!1;e.on("touchmove",function(e){n||(t.currentTarget=l[0],FLBuilder._rowDragInit(t),n=!0),e.target=i[0],i.trigger(e)}),e.on("touchend",function(e){e.target=i[0],i.trigger(e),e.stopPropagation()})},_rowDragStart:function(e,t){var i=b(FLBuilder._contentClass).find(".fl-row, .fl-module"),l=b(".fl-node-dragging");1===i.length&&b(FLBuilder._contentClass).addClass("fl-builder-empty"),l.hide(),FLBuilder._blockDragStart(e,t)},_rowDragStop:function(e,t){var i=t.item,l=i.parent(),n=null,o=0;FLBuilder._blockDragStop(e,t),l.hasClass("fl-builder-rows")?i.remove():l.hasClass("fl-row-sortable-proxy")?b(".fl-node-dragging").removeClass("fl-node-dragging").show():i.hasClass("fl-builder-block")?(l.hasClass("fl-sortable-disabled")||(l.hasClass("fl-col-content")?FLBuilder._addColGroup(i.closest(".fl-col").attr("data-node"),i.attr("data-cols"),l.find("> .fl-module, .fl-col-group, .fl-builder-block").index(i)):l.hasClass("fl-col-drop-target")?FLBuilder._addCols(l.closest(".fl-col"),l.hasClass("fl-col-drop-target-last")?"after":"before",i.attr("data-cols"),0<l.closest(".fl-col-group-nested").length):l.hasClass("fl-col-group-drop-target")?(e=i.closest(".fl-col-group, .fl-module"),o=i.closest(".fl-row").find(".fl-row-content").find("> .fl-col-group, > .fl-module").index(e),FLBuilder._addColGroup(i.closest(".fl-row").attr("data-node"),i.attr("data-cols"),l.hasClass("fl-drop-target-last")?o+1:o)):(n=i.closest(".fl-row, .fl-module"),o=b(FLBuilder._contentClass).find("> .fl-row, > .fl-module").index(n),o=n.length?o:0,FLBuilder._addRow(i.attr("data-cols"),l.hasClass("fl-drop-target-last")?o+1:o))),i.remove(),FLBuilder._showPanel()):(n=b(".fl-node-dragging").removeClass("fl-node-dragging").show(),l.parent().hasClass("fl-builder-content")||(l.hasClass("fl-drop-target-last")?l.parent().after(n):l.parent().before(n),FLBuilder._reorderNode(n.attr("data-node"),n.index())),b(".fl-row-sortable-proxy",window.parent.document).append(t.item))},_addRow:function(e,t,i){FLBuilder._showNodeLoadingPlaceholder(b(FLBuilder._contentClass),t),FLBuilder._newRowPosition=t,FL.Builder.data.getLayoutActions().addRow(e,t,i)},_addRowComplete:function(e){var e="object"==typeof e?e:FLBuilder._jsonParse(e),t=b(FLBuilder._contentClass),i=b(e.html).data("node");e.nodeParent=t,e.nodePosition=FLBuilder._newRowPosition,FLBuilder._renderLayout(e,function(){FLBuilder._removeNodeLoadingPlaceholder(b(".fl-node-"+i)),FLBuilder.triggerHook("didAddRow",i)})},_deleteRowClicked:function(e){var t=b(e.target).closest(".fl-row").data("node");FL.Builder.getActions().deleteNode(t),e.stopPropagation()},_deleteRow:function(e){var t=e.attr("data-node");FL.Builder.data.getLayoutActions().deleteNode(t),e.empty(),e.remove(),FLBuilder._setupEmptyLayout(),FLBuilder._removeRowOverlays(),FLBuilder.triggerHook("didDeleteRow",t)},_rowCopyClicked:function(e){var t=b(this).closest(".fl-row").attr("data-node");FLBuilder._copyRow(t),e.stopPropagation()},_rowCopySettingsClicked:function(){var e=b(this);let t=e.data("target-node");t=t||e.closest(".fl-row").data("node"),FLBuilderSettingsCopyPaste._bindCopyToElement(e,"row",t,!0)},_rowPasteSettingsClicked:function(){const e=b(this),t=e.text();let i=e.data("target-node");i=i||e.closest(".fl-row").data("node"),FLBuilderSettingsCopyPaste._importFromClipboard("row",i)||(e.text(FLBuilderStrings.module_import.error),setTimeout(()=>{e.text(t)},1e3))},_copyRow:function(t){var e=FLBuilder._getJQueryElement(t),i=e.clone(),l=b(".fl-builder-settings[data-node]",window.parent.document),n=l.attr("data-node"),o=n===t?e:e.find('[data-node="'+n+'"]'),s=null;l.length&&o.length&&(s=FLBuilder._getSettings(l),FLBuilderSettingsConfig.nodes[n]=s),i.addClass("fl-node-"+t+"-clone fl-builder-node-clone"),i.find(".fl-block-overlay").remove(),i.removeAttr("data-node"),e.after(i),FLBuilder._showNodeLoading(t+"-clone"),i.get(0).scrollIntoView({behavior:"smooth",block:"center"});FL.Builder.data.getLayoutActions().copyRow(t,s,n,function(e){e=FLBuilder._jsonParse(e);e.nodeParent=b(FLBuilder._contentClass),e.nodePosition=b(FLBuilder._contentClass+" > .fl-row").index(i),e.duplicatedRow=t,e.onAddNewHTML=function(){i.remove()},FLBuilder._rowCopyComplete(e)})},_rowCopyComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder.triggerHook("didDuplicateRow",{newNodeId:e.nodeId,oldNodeId:e.duplicatedRow})})},_rowSettingsClicked:function(e){var t=b(this),i=b(this).closest(".fl-row").attr("data-node");t.closest(".fl-block-overlay-global").length;FL.Builder.getActions().openSettings(i),e.stopPropagation()},_showRowSettings:function(e,t){t&&"row"!=FLBuilderConfig.userTemplateType?FLBuilderConfig.userCanEditGlobalTemplates&&(window.parent.open(b('.fl-row[data-node="'+e+'"]').attr("data-template-url")).FLBuilderGlobalNodeId=e):FLBuilderSettingsForms.render({id:"row",nodeId:e,className:"fl-builder-row-settings",attrs:'data-node="'+e+'"',buttons:t||FLBuilderConfig.lite||FLBuilderConfig.simpleUi?[]:["save-as"],badges:t?[FLBuilderStrings.global]:[],settings:FLBuilderSettingsConfig.nodes[e],preview:{type:"row"}},function(){b("#fl-field-width select",window.parent.document).on("change",FLBuilder._rowWidthChanged),b("#fl-field-content_width select",window.parent.document).on("change",FLBuilder._rowWidthChanged),b("#fl-field-aspect_ratio input",window.parent.document).on("input",FLBuilder._rowToggleContentAlignment)})},_rowWidthChanged:function(){var e=b("#fl-field-width select",window.parent.document).val(),t=b("#fl-field-content_width select",window.parent.document).val(),i=b("#fl-field-max_content_width",window.parent.document);"fixed"==e||"full"==e&&"fixed"==t?i.show():i.hide()},_rowToggleContentAlignment:function(e){var t=b("#fl-field-content_alignment",window.parent.document);""===b(e.target).val().trim()?t.hide():t.show()},_resetRowWidthClicked:function(e){var t=b(this).closest(".fl-row"),i=t.attr("data-node"),l=t.find(".fl-row-content"),n=FLBuilderConfig.global.row_width+"px",o=b(".fl-builder-row-settings",window.parent.document);t.hasClass("fl-row-fixed-width")&&t.css("max-width",n),l.css("max-width",n),o.length&&o.find("[name=max_content_width]").val(""),FL.Builder.data.getLayoutActions().resetRowWidth(i),FLBuilder._closeAllSubmenus(),FLBuilder.triggerHook("didResetRowWidth",i),e.stopPropagation()},_highlightEmptyCols:function(){var e=FLBuilderConfig.userTemplateType?"":":not(.fl-node-global)",t=b(FLBuilder._contentClass+" .fl-col"+e),e=b(FLBuilder._contentClass+" .fl-module[data-accepts]:not([data-has-children-wrapper])"+e),i=b(FLBuilder._contentClass+" [data-children-wrapper]");t.removeClass("fl-col-highlight").find(".fl-col-content").css("min-height",""),e.removeClass("fl-module-highlight"),i.removeClass("fl-module-highlight"),t.each(function(){var e=b(this);e.find(".fl-module, .fl-col").length||e.closest(".fl-builder-shortcode-mask-wrap").length||e.addClass("fl-col-highlight")}),e.each(function(){var e=b(this);e.find(".fl-module").length||e.closest(".fl-builder-shortcode-mask-wrap").length||e.addClass("fl-module-highlight")}),i.each(function(){var e=b(this);e.find(".fl-module").length||e.closest(".fl-builder-shortcode-mask-wrap").length||e.addClass("fl-module-highlight")})},_highlightRowsAndColsForDrag:function(e){var t="row"==FLBuilderConfig.userTemplateType?"":":not(.fl-node-global)",e=("column"==FLBuilderConfig.userTemplateType&&(t=":not(:first)"),b(FLBuilder._contentClass+" > .fl-row").addClass("fl-row-highlight"),e&&e.closest(".fl-row-overlay").length||b(FLBuilder._contentClass+" .fl-col"+t).each(function(){b(this).closest(".fl-builder-shortcode-mask-wrap").length||b(this).addClass("fl-col-highlight")}),FLBuilder._contentClass+" .fl-module[data-accepts]"),t=FLBuilder._contentClass+" [data-children-wrapper]";b(e+", "+t).each(function(){b(this).closest(".fl-builder-shortcode-mask-wrap").length||(b(this).addClass("fl-module-highlight"),0===parseInt(b(this).css("padding"))&&b(this).css("padding","10px"))})},_removeEmptyRowAndColHighlights:function(){b(".fl-row-highlight").removeClass("fl-row-highlight"),b(".fl-col-highlight").removeClass("fl-col-highlight"),b(".fl-module-highlight[data-accepts]").css("padding",""),b(".fl-module-highlight").removeClass("fl-module-highlight"),b(".fl-sortable-fixed-width").css("max-width","").removeClass("fl-sortable-fixed-width")},_adjustColHeightsForDrag:function(){var e="row"==FLBuilderConfig.userTemplateType?"":".fl-row:not(.fl-node-global) ",t="column"==FLBuilderConfig.userTemplateType?"":".fl-col:not(.fl-node-global) ",i=b(FLBuilder._contentClass),l=i.find(e+".fl-col-group:not(.fl-col-group-nested) > "+t+"> .fl-col-content"),n=i.find(e+".fl-col-group-nested "+t+".fl-col-content"),o=0;for(b(".fl-node-drag-init").hide();o<n.length;o++)n.eq(o).closest(".fl-builder-shortcode-mask-wrap").length||FLBuilder._adjustColHeightForDrag(n.eq(o));for(o=0;o<l.length;o++)l.eq(o).closest(".fl-builder-shortcode-mask-wrap").length||FLBuilder._adjustColHeightForDrag(l.eq(o));b(".fl-node-drag-init").show()},_adjustColHeightForDrag:function(e){e.find(".fl-module:visible, .fl-col:visible").length&&e.css("min-height",e.height()+45)},_colDragHelper:function(){return b('<div class="fl-builder-block-drag-helper">'+FLBuilderStrings.column+"</div>")},_colDragInit:function(e){var t=b(e.target),i=b(".fl-col-sortable-proxy-item",window.parent.document),l=t.closest(".fl-col");t.closest(".fl-block-move-menu").length||(t.hasClass("fl-block-col-move-parent")?l=l.parents(".fl-col"):t.data("target-node")&&(l=b(".fl-col[data-node="+t.data("target-node")+"]")),l.addClass("fl-node-dragging"),FLBuilder._blockDragInit(e),e.target=i[0],i.trigger(e))},_colDragInitTouch:function(t){var e=b(t.target),i=b(".fl-col-sortable-proxy-item",window.parent.document),l=e.closest(".fl-col"),n=!1;e.data("target-node")&&(l=b(".fl-col[data-node="+e.data("target-node")+"]")),e.on("touchmove",function(e){n||(t.currentTarget=l[0],FLBuilder._colDragInit(t),n=!0),e.target=i[0],i.trigger(e)}),e.on("touchend",function(e){e.target=i[0],i.trigger(e),e.stopPropagation()})},_colDragStart:function(e,t){var i=b(".fl-node-dragging");i.hide(),FLBuilder._resetColumnWidths(i.parent()),FLBuilder._blockDragStart(e,t)},_colDragStop:function(e,t){FLBuilder._blockDragStop(e,t);var e=b(".fl-node-dragging").removeClass("fl-node-dragging").show(),i=e.attr("data-node"),l=t.item.parent(),n=e.parent(),o=n.attr("data-node");if(newGroup=l.closest(".fl-col-group"),newGroupId=newGroup.attr("data-node"),newRow=l.closest(".fl-row, .fl-module"),position=0,actions=FL.Builder.data.getLayoutActions(),l.closest('[data-node="'+i+'"]').length)FLBuilder._resetColumnWidths(n);else if(l.hasClass("fl-sortable-disabled"))FLBuilder._resetColumnWidths(n);else if(l.hasClass("fl-col-sortable-proxy"))FLBuilder._resetColumnWidths(n);else if(l.hasClass("fl-col-content"))e.remove(),0===n.find(".fl-col").length&&(actions.removeNode(n.attr("data-node")),n.remove()),position=l.find("> .fl-module, .fl-col-group, .fl-col-sortable-proxy-item").index(t.item),FLBuilder._addColGroup(l.closest(".fl-col").attr("data-node"),i,position);else if(l.hasClass("fl-col-drop-target")){l.hasClass("fl-col-drop-target-last")?l.parent().after(e):l.parent().before(e),FLBuilder._resetColumnWidths(newGroup);const actions=FL.Builder.data.getLayoutActions();o==newGroupId?FL.Builder.getActions().moveNode(i,e.index()):FL.Builder.getActions().moveNode(i,e.index(),newGroupId,[o,newGroupId]),FLBuilder._resizeLayout()}else l.hasClass("fl-col-group-drop-target")?(e.remove(),0===n.find(".fl-col").length&&(actions.removeNode(n.attr("data-node")),n.remove()),position=newRow.find(".fl-row-content").find(" > .fl-col-group,  > .fl-module").index(newGroup),position=l.hasClass("fl-drop-target-last")?position+1:position,FLBuilder._addColGroup(newRow.attr("data-node"),i,position)):l.hasClass("fl-row-drop-target")&&(e.remove(),position=l.closest(".fl-builder-content").find(".fl-row, > .fl-module").index(newRow),position=l.hasClass("fl-drop-target-last")?position+1:position,FLBuilder._addRow(i,position));0===n.find(".fl-col").length&&(actions.removeNode(n.attr("data-node")),n.remove()),b(".fl-col-sortable-proxy",window.parent.document).append(t.item),FLBuilder._highlightEmptyCols(),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder._closeAllSubmenus()},_colSettingsClicked:function(e){var t=b(this),i=t.closest(".fl-col"),l=i.attr("data-node"),n=0<t.closest(".fl-block-overlay-global").length;FLBuilder._colResizing||n&&!FLBuilderConfig.userCanEditGlobalTemplates||(t.hasClass("fl-block-col-edit-parent")&&(l=i.parents(".fl-col").attr("data-node")),FL.Builder.data.getLayoutActions().displaySettings(l),e.stopPropagation())},_colCopySettingsClicked:function(){var e=b(this);let t=e.data("target-node");t=t||e.closest(".fl-col").data("node"),FLBuilderSettingsCopyPaste._bindCopyToElement(e,"column",t)},_colPasteSettingsClicked:function(){const e=b(this),t=e.text();let i=e.data("target-node");i=i||e.closest(".fl-col").data("node"),FLBuilderSettingsCopyPaste._importFromClipboard("column",i)||(e.text(FLBuilderStrings.module_import.error),setTimeout(()=>{e.text(t)},1e3))},_showColSettings:function(e,t,i){t&&i&&"row"!==FLBuilderConfig.userTemplateType?FLBuilderConfig.userCanEditGlobalTemplates&&(window.parent.open(b('.fl-col[data-node="'+e+'"]').attr("data-template-url")).FLBuilderGlobalNodeId=e):FLBuilderSettingsForms.render({id:"col",nodeId:e,className:"fl-builder-col-settings",attrs:'data-node="'+e+'"',buttons:t||FLBuilderConfig.lite||FLBuilderConfig.simpleUi?[]:["save-as"],badges:t?[FLBuilderStrings.global]:[],settings:FLBuilderSettingsConfig.nodes[e],preview:{type:"col"}},function(){0===b(".fl-col.fl-node-"+e).siblings(".fl-col").length&&b("#fl-field-equal_height, #fl-field-content_alignment",window.parent.document).hide()})},_copyColClicked:function(e){var t=b(this).closest(".fl-col").attr("data-node");FLBuilder._copyColumn(t),e.stopPropagation()},_copyColumn:function(t){var e=FLBuilder._getJQueryElement(t),i=e.clone(),l=e.parent(),n=b(".fl-builder-settings[data-node]",window.parent.document),o=n.attr("data-node"),s=o===t?e:e.find('[data-node="'+o+'"]'),r=null;n.length&&s.length&&(r=FLBuilder._getSettings(n),FLBuilderSettingsConfig.nodes[o]=r),i.addClass("fl-node-"+t+"-clone fl-builder-node-clone"),i.find(".fl-block-overlay").remove(),i.removeAttr("data-node"),e.after(i),FLBuilder._showNodeLoading(t+"-clone"),FLBuilder._resetColumnWidths(l);FL.Builder.data.getLayoutActions().copyColumn(t,r,o,function(e){e=FLBuilder._jsonParse(e);e.nodeParent=l,e.nodePosition=i.index(),e.duplicatedColumn=t,e.onAddNewHTML=function(){i.remove()},FLBuilder._copyColComplete(e)})},_copyColComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder._resetColumnWidths(e.nodeParent),FLBuilder.triggerHook("didDuplicateColumn",{newNodeId:e.nodeId,oldNodeId:e.duplicatedColumn})})},_deleteColClicked:function(e){var t=b(e.target).closest(".fl-col").data("node");FL.Builder.getActions().deleteNode(t),e.stopPropagation()},_getColToDelete:function(e){var t=e.closest(".fl-col-group"),i=e.parents(".fl-col:not(:has(.fl-builder-content-primary))"),l=0<i.length,n=i.find("> .fl-col-content > .fl-module, > .fl-col-content > .fl-col-group"),o=e.siblings(".fl-col");return l&&1===n.length&&(0===o.length?e=i:1!==o.length||o.find(".fl-module").length||(e=t)),e},_deleteCol:function(e){var t=e.attr("data-node"),i=e.closest(".fl-row"),l=e.closest(".fl-col-group"),n=0;e.remove(),rowCols=i.find(".fl-row-content > .fl-col-group > .fl-col, .fl-row-content > .fl-module"),groupCols=l.find(" > .fl-col"),0===rowCols.length&&"row"!=FLBuilderConfig.userTemplateType&&"column"!=FLBuilderConfig.userTemplateType?FLBuilder._deleteRow(i):(0===groupCols.length?l.remove():(n=6===groupCols.length?16.65:7===groupCols.length?14.28:Math.round(100/groupCols.length*100)/100,groupCols.css("width",n+"%"),FLBuilder.triggerHook("didResetColumnWidths",{cols:groupCols})),FL.Builder.data.getLayoutActions().deleteColumn(t,n),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder.triggerHook("col-deleted"),FLBuilder.triggerHook("didDeleteColumn",t))},_deleteColGroup:function(e){var t=e.attr("data-node");FL.Builder.data.getLayoutActions().deleteNode(t),e.empty(),e.remove(),FLBuilder.triggerHook("didDeleteColumnGroup",t)},_addCols:function(e,t,i,l,n){var o=(e="string"==typeof e?b(".fl-node-"+e):e).closest(".fl-col-group"),s=o.find(".fl-col").index(e),e=e.attr("data-node");i=void 0===i?"1-col":i,l=(l=void 0!==l&&l)?1:0,"after"==t&&s++,FLBuilder._showNodeLoadingPlaceholder(o,s),FLBuilder._removeAllOverlays(),FL.Builder.data.getLayoutActions().addColumns(e,t,i,l,n)},_addColsComplete:function(e){var t="object"==typeof e?e:FLBuilder._jsonParse(e);t.nodeParent=FLBuilder._newColParent,t.nodePosition=FLBuilder._newColPosition,FLBuilder._renderLayout(t,function(){FLBuilder._removeNodeLoadingPlaceholder(b(".fl-node-"+t.nodeId)),FLBuilder.triggerHook("didAddColumn",t.nodeId),FLBuilder.triggerHook("didResetColumnWidths",{cols:b(".fl-node-"+t.nodeId).find("> .fl-col")})})},_addColGroup:function(e,t,i,l){var n=b(".fl-node-"+e);FLBuilder._newColGroupPosition=i,n.hasClass("fl-col")?FLBuilder._newColGroupParent=n.find(" > .fl-col-content"):FLBuilder._newColGroupParent=n.find(".fl-row-content"),FLBuilder._showNodeLoadingPlaceholder(FLBuilder._newColGroupParent,i),FL.Builder.data.getLayoutActions().addColumnGroup(e,t,i,l)},_addColGroupComplete:function(e){var t=FLBuilder._jsonParse(e),e=b(t.html),i=e.data("node");e.find(".fl-col").data("node");t.nodeParent=FLBuilder._newColGroupParent,t.nodePosition=FLBuilder._newColGroupPosition,FLBuilder._renderLayout(t,function(){t.nodeParent.hasClass("fl-col-content")&&t.nodeParent.parents(".fl-col").addClass("fl-col-has-cols"),FLBuilder._removeNodeLoadingPlaceholder(b(".fl-node-"+i)),FLBuilder.triggerHook("didAddColumnGroup",i)})},_initColDragResizing:function(){b(".fl-block-col-resize").not(".fl-block-row-resize").draggable({axis:"x",start:FLBuilder._colDragResizeStart,drag:FLBuilder._colDragResize,stop:FLBuilder._colDragResizeStop})},_colDragResizeStart:function(e,t){for(var i=b(t.helper),l="",n=i.hasClass("fl-block-col-resize-parent"),o=n?i.closest(".fl-col").parents(".fl-col"):null,s=n?o.parents(".fl-col-group"):i.closest(".fl-col-group"),r=s.find("> .fl-col"),d=n?o:i.closest(".fl-col"),n=d.attr("data-node"),o=b("[data-node="+n+"] #fl-field-size input",window.parent.document),a=null,u=100,c=0,n=null,f=null,h=(a=(i.hasClass("fl-block-col-resize-e")?(l="e",d.nextAll(".fl-col")):(l="w",d.prevAll(".fl-col"))).first()).attr("data-node"),h=b("[data-node="+h+"] #fl-field-size input",window.parent.document);c<r.length;c++)r.eq(c).data("node")!=d.data("node")&&r.eq(c).data("node")!=a.data("node")&&(u-=parseFloat(r.eq(c)[0].style.width));o.length?(n=o,f="col"):h.length&&(n=h,f="sibling"),FLBuilder._colResizeData={handle:i,feedbackLeft:i.find(".fl-block-col-resize-feedback-left"),feedbackRight:i.find(".fl-block-col-resize-feedback-right"),direction:l,groupWidth:s.outerWidth(),col:d,id:d.attr("data-node"),colWidth:parseFloat(d[0].style.width)/100,sibling:a,siblingId:a.attr("data-node"),offset:t.position.left,availWidth:u,setting:n,settingType:f,layoutActions:FL.Builder.data.getLayoutActions()},FLBuilder._colResizing=!0,b("body").addClass("fl-builder-col-resizing"),FLBuilder._closePanel(),FLBuilder._destroyOverlayEvents(),FLBuilder.triggerHook("col-resize-start")},_colDragResize:function(e,t){var i=FLBuilder._colResizeData,l=FLBuilderConfig.isRtl?"w":"e",n=i.handle.closest(".fl-block-overlay"),t=(i.offset-t.position.left)/i.groupWidth,t=l==i.direction?100*(i.colWidth-t):100*(i.colWidth+t),o=Math.round(100*t)/100,t=i.availWidth-t,s=Math.round(100*t)/100,t=Math.round(100*(i.availWidth-8))/100;o<8?(o=8,s=t):s<8&&(o=t,s=8),i.feedbackLeft.show(),i.feedbackRight.show(),requestAnimationFrame(()=>{l==i.direction?(i.feedbackLeft.html(o.toFixed(1)+"%"),i.feedbackRight.html(s.toFixed(1)+"%")):(i.feedbackLeft.html(s.toFixed(1)+"%"),i.feedbackRight.html(o.toFixed(1)+"%")),i.col.css("width",o+"%"),i.sibling.css("width",s+"%"),i.setting&&("col"===i.settingType?i.setting.val(parseFloat(i.col[0].style.width)):"sibling"===i.settingType&&i.setting.val(parseFloat(i.sibling[0].style.width))),i.layoutActions.resizeColumn(i.id,o,i.siblingId,s,!1),FLBuilder._buildOverlayOverflowMenu(n)}),FLBuilder.triggerHook("col-resize-drag")},_colDragResizeStop:function(e,t){var i=FLBuilder._colResizeData,l=FLBuilder._colResizeData.handle.closest(".fl-block-overlay"),n=i.id,o=parseFloat(i.col[0].style.width),s=i.sibling.data("node"),i=parseFloat(i.sibling[0].style.width);FLBuilder._colResizeData.feedbackLeft.hide(),FLBuilder._colResizeData.feedbackRight.hide(),FL.Builder.data.getLayoutActions().resizeColumn(n,o,s,i),FLBuilder._buildOverlayOverflowMenu(l),FLBuilder._colResizeData=null,b("body").removeClass("fl-builder-col-resizing"),FLBuilder._bindOverlayEvents(),setTimeout(function(){FLBuilder._colResizing=!1},50),FLBuilder.triggerHook("col-resize-stop"),FLBuilder.triggerHook("didResizeColumn",{colId:n,colWidth:o,siblingId:s,siblingWidth:i})},_resetColumnWidthsClicked:function(e){var t=b(this),i=!!t.closest(".fl-row-overlay").length,l=null,n=[],o=null,s=0,r=b(".fl-builder-col-settings",window.parent.document);(i?t.closest(".fl-row").find(".fl-row-content > .fl-col-group"):t.parents(".fl-col-group").last()).each(function(){for(l=b(this),o=l.find(".fl-col-group"),n.push(l.data("node")),FLBuilder._resetColumnWidths(l),s=0;s<o.length;s++)FLBuilder._resetColumnWidths(o.eq(s)),n.push(o.eq(s).data("node"))}),r.length&&(i=b(".fl-node-"+r.attr("data-node")),r.find("#fl-field-size input").val(parseFloat(i[0].style.width))),FL.Builder.data.getLayoutActions().resetColWidths(n),FLBuilder.triggerHook("col-reset-widths"),FLBuilder._closeAllSubmenus(),e.stopPropagation()},_resetColumnWidths:function(e){var e=(e instanceof jQuery?e:b(e)).find(" > .fl-col:visible"),t=0,t=6===e.length?16.65:7===e.length?14.28:Math.round(100/e.length*100)/100;e.css("width",t+"%"),FLBuilder.triggerHook("didResetColumnWidths",{cols:e})},_moduleDragHelper:function(e,t){t=b(".fl-node-"+t.data("node"));return b('<div class="fl-builder-block-drag-helper">'+t.attr("data-name")+"</div>")},_moduleDragInit:function(e){var t=b(e.target),i=b(".fl-module-sortable-proxy-item",window.parent.document),l=t.closest(".fl-module");t.closest(".fl-block-move-menu").length||(t.data("target-node")&&(l=b(".fl-module[data-node="+t.data("target-node")+"]")),i.data("type",l.data("type")),l.addClass("fl-node-dragging"),FLBuilder._blockDragInit(e),e.target=i[0],i.data("node",l.data("node")),i.data("name",l.data("name")),i.data("type",l.data("type")),i.trigger(e))},_moduleDragInitTouch:function(t){var e=b(t.target),i=b(".fl-module-sortable-proxy-item",window.parent.document),l=e.closest(".fl-module"),n=!1;e.data("target-node")&&(l=b(".fl-module[data-node="+e.data("target-node")+"]")),e.on("touchmove",function(e){n||(t.currentTarget=l[0],FLBuilder._moduleDragInit(t),n=!0),e.target=i[0],i.trigger(e)}),e.on("touchend",function(e){e.target=i[0],i.trigger(e),e.stopPropagation()})},_moduleDragStart:function(e,t){var i=b(".fl-node-dragging");1===b(FLBuilder._contentClass).find(".fl-row, .fl-module").length&&b(FLBuilder._contentClass).addClass("fl-builder-empty"),i.hide(),FLBuilder._removeRowOverlays(),FLBuilder._blockDragStart(e,t)},_moduleDragStop:function(e,t){FLBuilder._blockDragStop(e,t);var i,e=b(".fl-node-dragging").removeClass("fl-node-dragging"),l=e.attr("data-accepts"),n=t.item,t=t.item.parent(),o=null,s=0,r=0;if(t.hasClass("fl-builder-modules")||t.hasClass("fl-builder-widgets"))n.remove();else{if(n.hasClass("fl-builder-block")){if(t.hasClass("fl-sortable-disabled"))return n.remove(),void FLBuilder._showPanel();t.hasClass("fl-row-drop-target")?(t=n.closest(".fl-builder-content"),r=0,o=n.closest(".fl-row, .fl-module"),s=t.find(".fl-row, > .fl-module").index(o)):t.hasClass("fl-col-group-drop-target")?(r=(t=n.closest(".fl-row-content")).closest(".fl-row").attr("data-node"),o=n.closest(".fl-col-group, .fl-module"),s=t.find("> .fl-col-group, > .fl-module").index(o)):t.hasClass("fl-col-drop-target")?(r=(t=n.closest(".fl-col-group")).attr("data-node"),o=n.closest(".fl-col"),s=t.find(" > .fl-col").index(o)):r=(t.hasClass("fl-module")?(s="layered"===(i=FLBuilder._getNodeLayoutDirection(n))?t.find("> .fl-module").length:t.find("> .fl-module, .fl-builder-block").index(n),t):t.hasClass("fl-module-content")||t.attr("data-children-wrapper")?(s=t.find("> .fl-module, .fl-builder-block").index(n),n.closest(".fl-module")):(s=t.find("> .fl-module, .fl-col-group, .fl-builder-block").index(n),n.closest(".fl-col"))).attr("data-node"),n.closest(".fl-drop-target-last").length&&(s+=1),FLBuilder._addModule(t,r,n.attr("data-type"),s,n.attr("data-widget"),n.attr("data-alias")),n.remove()}else t.hasClass("fl-sortable-disabled")?(FLBuilder._highlightEmptyCols(),e.show()):t.hasClass("fl-row-drop-target")?(o=n.closest(".fl-row, .fl-module"),s=n.closest(".fl-builder-content").children(".fl-row, .fl-module").index(o),s=n.closest(".fl-drop-target-last").length?s+1:s,l?(FLBuilder._moveNode(0,e.attr("data-node"),s),e.show()):(FLBuilder._addRow("1-col",s,e.attr("data-node")),e.remove())):t.hasClass("fl-col-group-drop-target")?(o=n.closest(".fl-col-group, .fl-module"),s=n.closest(".fl-row-content ").find(" > .fl-col-group, > .fl-module").index(o),s=n.closest(".fl-drop-target-last").length?s+1:s,r=n.closest(".fl-row").attr("data-node"),l?(FLBuilder._moveNode(r,e.attr("data-node"),s),e.show()):(FLBuilder._addColGroup(r,"1-col",s,e.attr("data-node")),e.remove())):t.hasClass("fl-col-drop-target")?(o=n.closest(".fl-col"),s=n.closest(".fl-col-drop-target-last").length?"after":"before",FLBuilder._addCols(o,s,"1-col",0<n.closest(".fl-col-group-nested").length,e.attr("data-node")),e.remove()):(l=n.closest("[data-accepts]").length,i=FLBuilder._getNodeLayoutDirection(n),l&&"layered"===i?n.parent().append(e):n.after(e),n.remove(),e.show(),FLBuilder._reorderModule(e)),b(".fl-module-sortable-proxy",window.parent.document).append(n);FLBuilder._resizeLayout(),FLBuilder._initDropTargets(),FLBuilder.triggerHook("didDropModule")}},_reorderModule:function(e){var t=e.parents(".fl-row, .fl-col, .fl-module").eq(0).attr("data-node"),i=e.attr("data-parent"),l=e.attr("data-node"),e=e.parent().find("> .fl-col-group, > .fl-module").index(e);t==i?FLBuilder._reorderNode(l,e):FLBuilder._moveNode(t,l,e)},_deleteModuleClicked:function(e){var t=b(e.target).closest(".fl-module").data("node");FL.Builder.getActions().deleteNode(t),e.stopPropagation()},_deleteModule:function(e){var t=e.closest(".fl-row"),i=t.find("[data-node]"),l=e.attr("data-node"),n=e.parents("[data-node]").attr("data-node"),o=e.attr("data-accepts");FL.Builder.data.getLayoutActions().deleteNode(l),o&&1===i.length&&FLBuilder._deleteRow(t),e.empty(),e.remove(),t.removeClass("fl-block-overlay-muted"),FLBuilder._setupEmptyLayout(),FLBuilder._highlightEmptyCols(),FLBuilder._removeAllOverlays(),FLBuilder.triggerHook("didDeleteModule",{nodeId:l,parentId:n,moduleType:e.attr("data-type")})},_moduleCopyClicked:function(e){var t=b(this).closest(".fl-module").data("node");FL.Builder.getActions().copyNode(t),e.stopPropagation()},_copyModule:function(t){var e=FLBuilder._getJQueryElement(t),i=e.clone(),l=e.parent(),n=b(".fl-builder-module-settings[data-node="+t+"]",window.parent.document),o={},s=e.length;n.length&&(o=FLBuilder._getSettings(n),FLBuilderSettingsConfig.nodes[t]=o),i.addClass("fl-node-"+t+"-clone fl-builder-node-clone"),i.find(".fl-block-overlay").remove(),i.removeAttr("data-node"),1==s&&e.after(i),FLBuilder._showNodeLoading(t+"-clone"),1==s&&i.get(0).scrollIntoView({behavior:"smooth",block:"center"});FL.Builder.data.getLayoutActions().copyModule(t,o,function(e){e=FLBuilder._jsonParse(e);e.nodeParent=l,e.nodePosition=l.find(" > .fl-col-group, > .fl-module").index(i),e.duplicatedModule=t,e.onAddNewHTML=function(){i.remove()},FLBuilder._moduleCopyComplete(e)})},_moduleCopyComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder.triggerHook("didDuplicateModule",{newNodeId:e.nodeId,oldNodeId:e.duplicatedModule,moduleType:e.moduleType})})},_moduleSettingsClicked:function(e){var t=b(this),i=(t.closest(".fl-block-overlay"),t.closest(".fl-module").attr("data-type"),t.closest(".fl-module").attr("data-node")),t=(t.closest(".fl-col").attr("data-node"),0<t.closest(".fl-block-overlay-global").length);e.stopPropagation(),FLBuilder._colResizing||t&&!FLBuilderConfig.userCanEditGlobalTemplates||FL.Builder.getActions().openSettings(i)},_moduleCopySettingsClicked:function(){var e=b(this);let t=e.data("target-node");t=t||e.closest(".fl-module").data("node");var i=b(".fl-node-"+t).data("type");FLBuilderSettingsCopyPaste._bindCopyToElement(e,i,t)},_modulePasteSettingsClicked:function(){const e=b(this),t=e.text();let i=e.data("target-node");i=i||e.closest(".fl-module").data("node");var l=b(".fl-node-"+i).data("type");FLBuilderSettingsCopyPaste._importFromClipboard(l,i)||(e.text(FLBuilderStrings.module_import.error),setTimeout(()=>{e.text(t)},1e3))},_showModuleSettings:function(e,t){var i,l,n,o;FLBuilderSettingsConfig.modules&&(i=FLBuilderSettingsConfig.modules[e.type],l=e.settings||FLBuilderSettingsConfig.nodes[e.nodeId],n=b("head",window.parent.document),o=b('.fl-module[data-node="'+e.nodeId+'"]'),e.global&&!FLBuilderConfig.userTemplateType&&o.attr("data-accepts")?FLBuilderConfig.userCanEditGlobalTemplates&&((win=window.parent.open(o.attr("data-template-url"))).FLBuilderGlobalNodeId=e.nodeId):(-1===b.inArray(e.type,FLBuilder._loadedModuleAssets)&&(""!==i.assets.css&&n.append(i.assets.css),""!==i.assets.js&&n.append(i.assets.js),FLBuilder._loadedModuleAssets.push(e.type)),FLBuilderSettingsForms.render({type:"module",id:e.type,nodeId:e.nodeId,className:"fl-builder-module-settings fl-builder-"+e.type+"-settings",attrs:'data-node="'+e.nodeId+'" data-parent="'+e.parentId+'" data-type="'+e.type+'"',buttons:e.global||FLBuilderConfig.lite||FLBuilderConfig.simpleUi?[]:["save-as"],badges:e.global?[FLBuilderStrings.global]:[],settings:l,legacy:e.legacy,helper:FLBuilder._moduleHelpers[e.type],rules:FLBuilder._moduleHelpers[e.type]?FLBuilder._moduleHelpers[e.type].rules:null,messages:FLBuilder._moduleHelpers[e.type]?FLBuilder._moduleHelpers[e.type].messages:null,hide:!(FLBuilderConfig.userCanEditGlobalTemplates||!e.global),lightbox:e.lightbox||null,preview:{type:"module",layout:e.layout,callback:function(){FLBuilder._initModuleMarginPlaceholders(),FLBuilder.triggerHook("didAddModule",{nodeId:e.nodeId,moduleType:l.type,settings:l,newNodes:e.newNodes,updatedNodes:e.updatedNodes})}}},t)))},_saveModuleClicked:function(){var e=b(this).closest(".fl-builder-settings"),t=e.attr("data-type"),t=(e.attr("data-node"),FLBuilder._moduleHelpers[t]),i=!0;void 0!==t&&(e.find("label.error").remove(),e.validate().hideErrors(),i=(i=e.validate().form())&&t.submit()),i?FLBuilder._saveSettings():FLBuilder._toggleSettingsTabErrors()},_addModule:function(e,t,i,l,n,o){FLBuilder._showNodeLoadingPlaceholder(e,l),e.hasClass("fl-col-group")?(FLBuilder._newModuleParent=null,FLBuilder._newModulePosition=0):(FLBuilder._newModuleParent=e,FLBuilder._newModulePosition=l),FL.Builder.data.getLayoutActions().addModule(i,t,l,{widget:void 0===n?"":n,alias:void 0===o?"":o,nodePreview:1})},_addModuleComplete:function(e){var e=FLBuilder._jsonParse(e),t=!1;if(!1===e)return FLBuilder.alert(FLBuilderStrings.savedModuleNotExists),FLBuilder._newModuleParent.find(".fl-builder-node-loading-placeholder").remove(),!1;e.layout&&(FLBuilder._newModuleParent&&FLBuilder._newModuleParent.find(".fl-builder-node-loading-placeholder").remove(),e.layout.nodeParent=FLBuilder._newModuleParent,e.layout.nodePosition=FLBuilder._newModulePosition),e.settings||(e.settings=FLBuilderSettingsConfig.defaults.modules[e.type]),b("form.fl-builder-settings",window.parent.document).length?e.layout&&(FLBuilder._renderLayout(e.layout),t=!0):t=!0,t&&FLBuilder._showModuleSettings(e,function(){b(".fl-builder-module-settings",window.parent.document).data("new-module","1")})},registerModuleHelper:function(e,t){FLBuilder._moduleHelpers[e]=b.extend({},{node:null,form:null,rules:{},init:function(){},submit:function(){return!0},preview:function(){},getForm:function(){return this.form||(this.form=b("form.fl-builder-settings:visible",window.parent.document).get(0)),this.form},getSettings:function(){return FLBuilder._getSettings(b(this.form))},getNodeID:function(){return this.getForm().dataset.node},getNode:function(){return this.node||(this.node=document.querySelector(`${FLBuilder._contentClass} .fl-module[data-node="${this.getNodeID()}"]`)),this.node}},t)},_registerModuleHelper:function(e,t){FLBuilder.registerModuleHelper(e,t)},_initModuleMarginPlaceholders:function(){var e=b(".fl-builder-module-settings:visible",window.parent.document),t=e.data("node"),i=b(".fl-node-"+t),l=i.find("> .fl-node-content"),n=["top","right","bottom","left"];if(e.length&&i.closest(".fl-module[data-accepts]").length)for(var o in l.length||(l=i),n){var s=e.find('input[name="margin_'+n[o]+'"]');i.removeClass("fl-node-"+t),s.attr("placeholder",parseInt(l.css("margin-"+n[o]))),i.addClass("fl-node-"+t)}},_showNodeTemplateSettings:function(e){var t=b(".fl-builder-settings-lightbox .fl-builder-settings",window.parent.document),i=t.attr("data-node"),l=FLBuilderStrings.saveModule;if(t.hasClass("fl-builder-row-settings")?l=FLBuilderStrings.saveRow:t.hasClass("fl-builder-col-settings")&&(l=FLBuilderStrings.saveColumn),!FLBuilder._triggerSettingsSave(!1,!1,!1))return!1;FLBuilderSettingsForms.render({id:"node_template",nodeId:i,title:l,attrs:'data-node="'+i+'"',className:"fl-builder-node-template-settings",rules:{name:{required:!0}}},function(){var e=b(".fl-builder-settings:visible"),t=FLBuilderConfig.nodeCategoies;select=e.find("#fl-field-categories").find("select"),desc=select.parent().find(".fl-field-description").hide(),b.each(t,function(e,t){select.append(b("<option>",{value:t.id,text:t.name}))}),select.on("change",function(){"add_new"===b(this).val()&&(b('<input type="text" name="categories" value="" class="text text-full">').insertBefore(select),select.remove(),desc.show())}),FLBuilderConfig.userCanEditGlobalTemplates||b("#fl-field-global",window.parent.document).hide()})},_saveNodeTemplate:function(){var e=b(".fl-builder-node-template-settings",window.parent.document),t=e.attr("data-node");e.validate().form()&&(FLBuilder._showNodeLoading(t),FL.Builder.data.getLayoutActions().saveNodeTemplate(t,FLBuilder._getSettings(e)),FLBuilder._lightbox.close())},_saveNodeTemplateComplete:function(e){var t,i=FLBuilder._jsonParse(e),l=b(".fl-builder-saved-"+i.type+"s",window.parent.document),n=l.find(".fl-builder-block"),o=null,s=i.name.toLowerCase(),r=0,d=wp.template("fl-node-template-block"),e={name:i.name,isGlobal:i.global,content:i.type,id:i.id,postID:i.postID,kind:"template",type:"user",link:i.link,category:{uncategorized:FLBuilderStrings.uncategorized}};if(FLBuilderConfig.contentItems.template.push(e),FLBuilder.triggerHook("contentItemsChanged"),i.layout&&(FLBuilder._renderLayout(i.layout),FLBuilder.triggerHook("didSaveGlobalNodeTemplate",i.config)),0===n.length)l.append(d(i));else for(;r<n.length;r++){if(t=(o=n.eq(r)).text().toLowerCase().trim(),0===r&&s<t){l.prepend(d(i));break}if(s<t){o.before(d(i));break}if(n.length-1===r){l.append(d(i));break}}l.find(".fl-builder-block-no-node-templates").remove()},_nodeTemplateDragStop:function(t,i){FLBuilder._blockDragStop(t,i);var t=i.item,i=t.parent(),l=null,n=0,o=null,s="",r=null;if(!i.hasClass("fl-builder-blocks-section-content")){if(t.hasClass("fl-builder-block-saved-row")||t.hasClass("fl-builder-block-row-template"))o=t.closest(".fl-row, .fl-module"),n=b(FLBuilder._contentClass).find(".fl-row, > .fl-module").index(o),n=o.length?n:0,n=i.hasClass("fl-drop-target-last")?n+1:n,l=null,s="render_new_row_template",r=FLBuilder._addRowComplete,FLBuilder._newRowPosition=n,FLBuilder._showNodeLoadingPlaceholder(b(FLBuilder._contentClass),n);else if(t.hasClass("fl-builder-block-saved-column")){if(o=t.closest(".fl-col"),colGroup=i.closest(".fl-col-group"),colGroupId=colGroup.attr("data-node"),s="render_new_col_template",r=FLBuilder._addColsComplete,i.hasClass("fl-sortable-disabled"))return t.remove(),void FLBuilder._showPanel();i.hasClass("fl-row-drop-target")?(o=t.closest(".fl-row, .fl-module"),l=0,i=b(FLBuilder._contentClass),n=o.length?i.find(".fl-row, > .fl-module").index(o):0):i.hasClass("fl-col-group-drop-target")?(i=t.closest(".fl-row-content"),l=t.closest(".fl-row").attr("data-node"),n=t.closest(".fl-row").find(".fl-row-content").find(" > .fl-col-group,  > .fl-module").index(t.closest(".fl-col-group, .fl-module"))):i.hasClass("fl-col-drop-target")&&(n=(i=t.closest(".fl-col-group")).children(".fl-col").index(t.closest(".fl-col")),l=i.attr("data-node")),t.closest(".fl-drop-target-last").length&&(n+=1),i.hasClass("fl-col-group")?FLBuilder._newColParent=null:FLBuilder._newColParent=i,FLBuilder._newColPosition=n,FLBuilder._showNodeLoadingPlaceholder(i,n)}else if(t.hasClass("fl-builder-block-saved-module")||t.hasClass("fl-builder-block-module-template")){if(s="render_new_module",r=FLBuilder._addModuleComplete,i.hasClass("fl-sortable-disabled"))return t.remove(),void FLBuilder._showPanel();i.hasClass("fl-row-drop-target")?(l=0,n=(i=t.closest(".fl-builder-content")).find(".fl-row, > .fl-module").index(t.closest(".fl-row, .fl-module"))):i.hasClass("fl-col-group-drop-target")?(l=(i=t.closest(".fl-row-content")).closest(".fl-row").attr("data-node"),n=i.find(" > .fl-col-group, > .fl-module").index(t.closest(".fl-col-group, .fl-module"))):l=(i.hasClass("fl-col-drop-target")?(n=(i=t.closest(".fl-col-group")).children(".fl-col").index(t.closest(".fl-col")),i):i.hasClass("fl-module")?(n="layered"===FLBuilder._getNodeLayoutDirection(t)?i.find("> .fl-module").length:i.find("> .fl-module, .fl-builder-block").index(t),i):i.hasClass("fl-module-content")||i.hasClass("fl-loop-item")?(n=i.find("> .fl-module, .fl-builder-block").index(t),t.closest(".fl-module")):(n=i.children(".fl-module, .fl-builder-block").index(t),t.closest(".fl-col"))).attr("data-node"),t.closest(".fl-drop-target-last").length&&(n+=1),i.hasClass("fl-col-group")?(FLBuilder._newModuleParent=null,FLBuilder._newModulePosition=0):(FLBuilder._newModuleParent=i,FLBuilder._newModulePosition=n),FLBuilder._showNodeLoadingPlaceholder(i,n)}o=t.attr("data-id"),i=t.attr("data-type");let e="render_new_row_template"===s?"row":"render_new_col_template"===s?"column":"module";FL.Builder.data.getLayoutActions().addNodeTemplate(e,o,i,l,n,function(e){var t=FLBuilder._jsonParse(e);-1<s.indexOf("row")?(FLBuilder.triggerHook("didApplyRowTemplateComplete",t.config),r(t.layout)):-1<s.indexOf("col")?(FLBuilder.triggerHook("didApplyColTemplateComplete",t.config),r(t.layout)):(FLBuilder.triggerHook("didApplyModuleTemplateComplete",t.config),r(e))})}t.remove()},_editNodeTemplateClicked:function(e){e.preventDefault(),e.stopPropagation(),window.parent.open(b(this).attr("href"))},_deleteNodeTemplateClicked:function(e){var e=b(e.target),t=e.closest(".fl-builder-blocks-section").find(".fl-builder-blocks-section-content"),i=t.find(".fl-builder-block"),e=e.closest(".fl-builder-block"),l=e.hasClass("fl-builder-block-global"),n=l?FLBuilderStrings.deleteGlobalTemplate:FLBuilderStrings.deleteTemplate,o=e.attr("data-id");confirm(n)&&(e.remove(),1===i.length&&(e.hasClass("fl-builder-block-saved-row")?t.append('<span class="fl-builder-block-no-node-templates">'+FLBuilderStrings.noSavedRows+"</span>"):t.append('<span class="fl-builder-block-no-node-templates">'+FLBuilderStrings.noSavedModules+"</span>")),e.hasClass("fl-builder-block-global")&&FLBuilder.showAjaxLoader(),FL.Builder.data.getLayoutActions().deleteNodeTemplate(o,l),n=_.findIndex(FLBuilderConfig.contentItems.template,{id:e.attr("data-id"),type:"user"}),FLBuilderConfig.contentItems.template.splice(n,1),FLBuilder.triggerHook("contentItemsChanged"))},_initSettingsForms:function(){var e=b(".fl-builder-settings:visible",window.parent.document);FL.Builder.settingsForms.initEvents(e),FLBuilder._CodeFieldSSLCheck(),FLBuilder._initCodeFields(),FLBuilder._initColorPickers(),FLBuilder._initGradientPickers(),FLBuilder._initIconFields(),FLBuilder._initPhotoFields(),FLBuilder._initSelectFields(),FLBuilder._initEditorFields(),FLBuilder._initMultipleFields(),FLBuilder._initAutoSuggestFields(),FLBuilder._initLinkFields(),FLBuilder._initFontFields(),FLBuilder._initPostTypeFields(),FLBuilder._initOrderingFields(),FLBuilder._initTimezoneFields(),FLBuilder._initDimensionFields(),FLBuilder._initFieldPopupSliders(),FLBuilder._initPresetFields(),FLBuilder._initModuleMarginPlaceholders(),FL.Builder.settingsForms.focusFirstSettingsControl(),FLBuilder._calculateSettingsTabsOverflow(),FLBuilder._lightbox._resizeEditors(),b(".fl-builder-settings-fields",window.parent.document).css("visibility","visible"),b(".fl-builder-settings button",window.parent.document).on("click",function(e){e.preventDefault()}),FLBuilder.triggerHook("settings-form-init")},_reinitSettingsForms:function(){FLBuilder._reinitEditorFields(),FLBuilder.triggerHook("settings-form-init")},_destroySettingsForms:function(){FLBuilder._destroyEditorFields(),FLBuilder._hideColorPicker()},_setSettingsFormContent:function(e){b(".fl-legacy-settings",window.parent.document).remove(),b("body",window.parent.document).append(e)},_settingsTabClicked:function(e){var t=b(this),i=t.closest(".fl-builder-settings"),t=t.attr("href").split("#").pop();FLBuilder._resetSettingsTabsState(),i.find(".fl-builder-settings-tab").removeClass("fl-active"),i.find("#"+t).addClass("fl-active"),i.find(".fl-builder-settings-tabs .fl-active").removeClass("fl-active"),i.find("a[href*="+t+"]").addClass("fl-active"),FLBuilderConfig.rememberTab?localStorage.setItem("fl-builder-settings-tab",t):localStorage.setItem("fl-builder-settings-tab",""),FL.Builder.settingsForms.focusFirstSettingsControl(),e.preventDefault()},_resetSettingsTabsState:function(){var e=b(".fl-lightbox:visible",window.parent.document);FLBuilder._hideTabsOverflowMenu(),e.find(".fl-builder-settings-tabs .fl-active").removeClass("fl-active"),e.find(".fl-builder-settings-tabs-overflow-menu .fl-active").removeClass("fl-active"),e.find(".fl-contains-active").removeClass("fl-contains-active")},_calculateTextWidth:function(e){var t=b("<span>").hide().appendTo(document.body),e=(e=b(e),t.text(e.val()||e.text()).css("font",e.css("font")),t.width());return t.remove(),e},_calculateSettingsTabsOverflow:function(){var e=b(".fl-lightbox:visible",window.parent.document),t=e.outerWidth(),i=e.hasClass("fl-lightbox-width-slim"),l=e.find(".fl-builder-settings-tabs"),n=e.find(".fl-builder-settings-tabs-overflow-menu"),o=e.find(".fl-builder-settings-tabs-more"),l=l.find("a"),s=!1,r=t-44,d=0,a=i?10:20;n.html(""),FLBuilder._hideTabsOverflowMenu(),l.removeClass("fl-overflowed"),l.each(function(){if(!b(this).is(":visible"))return!0;var e,t,i;s||(e=FLBuilder._calculateTextWidth(this),r<=(d+=e+a+12)&&(s=!0)),s?(e=b(this).html(),i=b(this).attr("href"),t="",b(this).hasClass("fl-active")&&(t="fl-active"),b(this).hasClass("error")&&(t+=" error"),i=b('<a href="'+i+'" '+(t=""!==t?'class="'+t+'"':t)+">"+e+"</a>"),n.append(i),b(this).addClass("fl-overflowed")):b(this).removeClass("fl-overflowed")}),s?e.addClass("fl-lightbox-has-tab-overflow"):e.removeClass("fl-lightbox-has-tab-overflow"),0<n.find(".fl-active").length?o.addClass("fl-contains-active"):o.removeClass("fl-contains-active"),0<n.find(".error").length?o.addClass("fl-contains-errors"):o.removeClass("fl-contains-errors")},_settingsTabsToOverflowMenuItemClicked:function(e){var t=b(e.currentTarget,window.parent.document),i=t.attr("href"),l=t.closest(".fl-lightbox-header-wrap").find(".fl-builder-settings-tabs"),i=l.find('a[href="'+i+'"]'),l=l.find(".fl-builder-settings-tabs-more");FLBuilder._resetSettingsTabsState(),i.trigger("click"),t.addClass("fl-active"),l.addClass("fl-contains-active"),FLBuilder._hideTabsOverflowMenu(),e.preventDefault()},_hasOverflowTabs:function(){return 0<b(".fl-lightbox:visible",window.parent.document).find(".fl-builder-settings-tabs-overflow-menu a").length},_showTabsOverflowMenu:function(){var e;FLBuilder._hasOverflowTabs()&&((e=b(".fl-lightbox:visible",window.parent.document)).find(".fl-builder-settings-tabs-overflow-menu").css("display","flex"),e.find(".fl-builder-settings-tabs-overflow-click-mask").show(),this.isShowingSettingsTabsOverflowMenu=!0)},_hideTabsOverflowMenu:function(){var e=b(".fl-lightbox:visible",window.parent.document);e.find(".fl-builder-settings-tabs-overflow-menu").css("display","none"),e.find(".fl-builder-settings-tabs-overflow-click-mask").hide(),this.isShowingSettingsTabsOverflowMenu=!1},_toggleTabsOverflowMenu:function(e){FLBuilder.isShowingSettingsTabsOverflowMenu?FLBuilder._hideTabsOverflowMenu():FLBuilder._showTabsOverflowMenu(),e.stopPropagation()},_settingsCancelClicked:function(e){var t=b(".fl-builder-lightbox[data-parent]",window.parent.document),i=b(".fl-builder-module-settings",window.parent.document),l=null,n=null,o=null,s="column"==FLBuilderConfig.userTemplateType;0<t.length?FLBuilder._closeNestedSettings():(0<i.length&&void 0!==i.data("new-module")?(l=b(FLBuilder.preview.state.html),t=(n=b(".fl-node-"+i.data("node"))).parents(".fl-module[data-accepts]"),o=n.closest(".fl-col"),i=l.find(".fl-node-"+o.data("node")),0<t.length||0<i.length||s?FLBuilder._deleteModule(n):FLBuilder._deleteCol(o)):FLBuilder.preview&&FLBuilder.preview.revert(),FL.Builder.data.getLayoutActions().cancelDisplaySettings(),FLBuilder.preview=null,FLLightbox.closeParent(this),FLBuilder.triggerHook("didCancelNodeSettings"))},_initSettingsValidation:function(e,t){b(".fl-builder-settings",window.parent.document).last().validate({ignore:".fl-ignore-validation",rules:e,messages:t=t||{},errorPlacement:FLBuilder._settingsErrorPlacement})},_settingsErrorPlacement:function(e,t){e.appendTo(t.parent())},_toggleSettingsTabErrors:function(){for(var e,t=b(".fl-builder-settings:visible",window.parent.document),i=t.find(".fl-builder-settings-tab"),l=null,n=0;n<i.length;n++)e=(l=i.eq(n)).find("label.error"),(tabLink=t.find(".fl-builder-settings-tabs a[href*="+l.attr("id")+"]")).find(".fl-error-icon").remove(),tabLink.removeClass("error"),0<e.length&&(tabLink.append('<span class="fl-error-icon"></span>'),tabLink.addClass("error"));FLBuilder._calculateSettingsTabsOverflow()},_getSettings:function(e){FLBuilder._updateEditorFields();for(var t,i,l=e.serializeArray(),n=0,o=0,s="",r=null,d={},n=0;n<l.length;n++)if(t=l[n].value.replace(/\r/gm,"").replace(/&#39;/g,"'"),"undefined"!==l[n].name&&!(-1<l[n].name.indexOf("flrich")||l[n].name.startsWith("fl_auto_style_")))if(-1<l[n].name.indexOf("["))for(s=l[n].name.replace(/\[(.*)\]/,""),i=l[n].name.replace(s,"").replace("[","").replaceAll("]","").split("["),void 0===d[s]&&(1===i.length&&""===i[0]?d[s]=[]:d[s]={}),r=d[s],o=0;o<i.length;o++){if(""===i[o]){if(1!==i.length)continue;r.push(t);break}if(i.length-2===o&&""===i[i.length-1]){-1<b.inArray(typeof r[i[o]],["undefined","string"])&&(r[i[o]]=[]),r[i[o]].push(t);break}i.length-1===o?r[i[o]]=t:(-1<b.inArray(typeof r[i[o]],["undefined","string"])&&(r[i[o]]={}),r=r[i[o]])}else d[l[n].name]=t;for(s in d)if(void 0!==d["as_values_"+s]){d[s]=b.grep(d["as_values_"+s].split(","),function(e){return""!==e}).join(",");try{delete d["as_values_"+s]}catch(e){}}return b.each(e.find("[name]"),function(e,t){t=b(t).attr("name").replace(/\[(.*)\]/,"");t in d||"undefined"===t||(d[t]="")}),d=b.extend({},FLBuilder._getOriginalSettings(e),d)},_getSettingsJSONForHTML:function(e){return JSON.stringify(e).replace(/\'/g,"&#39;").replace("<wbr />","<wbr>")},_getOriginalSettings:function(e,t){var i=e.find(".fl-builder-settings-json"),e=e.data("node"),l=FLBuilderSettingsConfig.nodes,n=null,o={};if(e&&l[e]?n=l[e]:i.length&&(n=FLBuilder._jsonParse(i.val().replace(/&#39;/g,"'"))),n)for(key in n)(key.match(/[a-z0-9-_]+$/)&&b("#fl-field-"+key).length||t)&&(o[key]=n[key]);return o},_getSettingsForChangedCheck:function(e,t){var i=FLBuilder._getSettings(t);if(e){t=b(".fl-node-"+e);if(t.hasClass("fl-module")){t=t.data("type"),t=FLBuilderSettingsConfig.editables[t];if(t&&FLBuilderSettingsConfig.nodes[e])for(var l in t)i[l]=FLBuilderSettingsConfig.nodes[e][l]}}return i},_saveSettings:function(i){var e=b(".fl-builder-settings-lightbox .fl-builder-settings",window.parent.document),t=e.data("new-module"),l=e.attr("data-node"),n=FLBuilder._getSettings(e),e=FLBuilder.preview;function o(){FLBuilder._showNodeLoading(l),FLBuilderSettingsConfig.nodes[l]=n;var e=FL.Builder.data.getLayoutActions(),t=FLBuilder._saveSettingsComplete.bind(this,i);e.updateNodeSettings(l,n,t),FLBuilder.triggerHook("didSaveNodeSettings",{nodeId:l,settings:n}),FLBuilder._lightbox.close()}!FLBuilder.isUndefined(i)&&FLBuilder.isBoolean(i)||(i=!0),e&&!e._settingsHaveChanged()&&FLBuilder.isUndefined(t)?(e.clear(),FLBuilder._lightbox.close()):FLBuilderConfig.userCaps.unfiltered_html?o():(FLBuilderSettingsForms.showLightboxLoader(),FLBuilder.ajax({action:"verify_settings",settings:n},function(e){console.log(e),!0===e?o():(console.log(e),msg='<p style="font-weight:bold;text-align:center;">'+FLBuilderStrings.noScriptWarn.heading+"</p>",FLBuilderConfig.userCaps.global_unfiltered_html?msg+="<p>"+FLBuilderStrings.noScriptWarn.global+"</p>":msg+="<p>"+FLBuilderStrings.noScriptWarn.message+"</p>",msg=(msg+='<p><div class="fl-diff"></div></p>')+"<p>"+FLBuilderStrings.noScriptWarn.footer+"</p>",FLBuilderSettingsForms.hideLightboxLoader(),FLBuilder.alert(msg),""!==(data=FLBuilder._jsonParse(e)).diff&&(b(".fl-diff",window.parent.document).html(data.diff),b(".fl-diff",window.parent.document).prepend("<p>"+FLBuilderStrings.codeErrorDetected+"</p>"),b(".fl-diff .diff-deletedline",window.parent.document).each(function(){(b(this).find("del").length<1?b(this).css("background-color","rgb(255, 192, 203, 0.7)").css("padding","10px"):b(this).find("del").css("background-color","rgb(255, 192, 203, 0.7)")).css("border","1px solid pink")}),console.log("============"),console.log("key: "+data.key),console.log("value: "+data.value),console.log("parsed: "+data.parsed),console.log("============")))}))},_saveSettingsComplete:function(e,t){function i(){s&&l.layout.partial&&l.layout.nodeId===s.nodeId&&!FLBuilder._publishAndRemain&&(s.clear(),FLBuilder.preview=null),FLBuilder._publishAndRemain=!1}var l=FLBuilder._jsonParse(t),t=l.layout.nodeType,n=l.layout.moduleType,o="didSave"+t.charAt(0).toUpperCase()+t.slice(1)+"SettingsComplete",s=FLBuilder.preview;!0===e?FLBuilder._renderLayout(l.layout,i):i(),FLBuilder.triggerHook("didSaveNodeSettingsComplete",{nodeId:l.node_id,nodeType:t,moduleType:n,settings:l.settings}),FLBuilder.triggerHook(o,{nodeId:l.node_id,nodeType:t,moduleType:n,settings:l.settings})},_triggerSettingsSave:function(e,t,i){var l=FLBuilder._lightbox._node.find("form.fl-builder-settings"),n=FLBuilder._lightbox._node.data("instance-id"),n=FLLightbox._instances[n],o=b(".fl-lightbox-wrap[data-parent]:visible",window.parent.document),s=!0;return e=!_.isUndefined(e)&&e,t=!_.isUndefined(t)&&t,(i=_.isUndefined(i)?!e:i)||(FLBuilder._publishAndRemain=!0),l.length&&((s=o.length&&(o.find(".fl-builder-settings-save").trigger("click"),o.find("label.error").length||b(".fl-builder-alert-lightbox:visible",window.parent.document).length)?!1:s)&&!l.validate({ignore:".fl-ignore-validation"}).form()&&(s=!1),o=FLBuilderSettingsForms.settingsHaveChanged(),s&&o&&(e&&n.disableClose(),l.find(".fl-builder-settings-save").trigger("click"),e&&n.enableClose(),l.find("label.error").length||b(".fl-builder-alert-lightbox:visible",window.parent.document).length)&&(s=!1),i?(FLBuilder._destroySettingsForms(),!o&&FLBuilder.preview&&(FLBuilder.preview.clear(),FLBuilder.preview=null)):FLBuilderSettingsForms.cacheCurrentSettings(),o||e||n.close()),s?FLBuilder.triggerHook("didTriggerSettingsSave"):(FLBuilder._publishAndRemain=!1,FLBuilder.triggerHook("didFailSettingsSave"),FLBuilder._toggleSettingsTabErrors(),t&&!b(".fl-builder-alert-lightbox:visible",window.parent.document).length&&FLBuilder.alert(FLBuilderStrings.settingsHaveErrors)),s},_refreshSettingsPreviewReference:function(){FLBuilder.preview&&FLBuilder.preview._initElementsAndClasses()},_openNestedSettings:function(e){e.className&&-1===e.className.indexOf("fl-builder-settings-lightbox")&&(e.className+=" fl-builder-settings-lightbox"),e=b.extend({className:"fl-builder-lightbox  fl-builder-settings-lightbox",destroyOnClose:!0,resizable:!0},e);var t=b(".fl-lightbox-wrap:visible",window.parent.document),i=t.find(".fl-lightbox"),e=new FLLightbox(e),l=e._node,n=l.find(".fl-lightbox");return t.hide(),l.attr("data-parent",t.attr("data-instance-id")),n.attr("style",i.attr("style")),e.on("resized",FLBuilder._calculateSettingsTabsOverflow),e.open('<div class="fl-builder-lightbox-loading"></div>'),e},_closeNestedSettings:function(){var e=b(".fl-builder-lightbox[data-parent]:visible",window.parent.document),t=e.find(".fl-lightbox"),i=e.attr("data-instance-id"),i=FLLightbox._instances[i],e=e.attr("data-parent"),l=b('[data-instance-id="'+e+'"]',window.parent.document),n=l.find(".fl-lightbox"),o=l.find("form"),s=FLLightbox._instances[e];i&&(i.on("close",function(){n.attr("style",t.attr("style")),l.show(),s._resize(),l.find("label.error").remove(),o.validate().hideErrors(),FLBuilder._toggleSettingsTabErrors(),FLBuilder._initMultipleFields(),FL?.Builder?.settingsForms.state.pop()}),i.close())},_showHelpTooltip:function(){const e=b(this);var t=setTimeout(()=>{e.siblings(".fl-help-tooltip-text").fadeIn(),e.removeData("hoverTimeout")},500);e.data("hoverTimeout",t)},_hideHelpTooltip:function(){var e=b(this),t=e.data("hoverTimeout");t&&(clearTimeout(t),e.removeData("hoverTimeout")),e.siblings(".fl-help-tooltip-text").fadeOut()},_initAutoSuggestFields:function(){var t,i=b(".fl-builder-settings:visible .fl-suggest-field",window.parent.document),e=null,l=null,n=[];i.each(function(){""!==(e=b(this)).attr("data-value")&&(FLBuilderSettingsForms.showFieldLoader(e),n.push({name:e.attr("name"),value:e.attr("data-value"),action:e.attr("data-action"),data:e.attr("data-action-data")}))}),n.length?FLBuilder.ajax({action:"get_autosuggest_values",fields:n},function(e){for(l in t=FLBuilder._jsonParse(e))b('.fl-suggest-field[name="'+l+'"]',window.parent.document).attr("data-value",t[l]);i.each(FLBuilder._initAutoSuggestField)}):i.each(FLBuilder._initAutoSuggestField)},_initAutoSuggestField:function(){var e=b(this);e.autoSuggest(FLBuilder._ajaxUrl({fl_action:"fl_builder_autosuggest",fl_as_action:e.data("action"),fl_as_action_data:e.data("action-data"),_wpnonce:FLBuilderConfig.ajaxNonce}),b.extend({},{asHtmlID:e.attr("name"),selectedItemProp:"name",searchObjProps:"name",minChars:2,keyDelay:1e3,fadeOut:!1,usePlaceholder:!0,emptyText:FLBuilderStrings.noResultsFound,showResultListWhenNoMatch:!0,preFill:e.data("value"),queryParam:"fl_as_query",afterSelectionAdd:FLBuilder._updateAutoSuggestField,afterSelectionRemove:FLBuilder._updateAutoSuggestField,selectionLimit:e.data("limit"),canGenerateNewSelections:!1},e.data("args"))),FLBuilderSettingsForms.hideFieldLoader(e)},_updateAutoSuggestField:function(e,t,i){var l=this;b(this).siblings(".as-values").val(i.join(",")).trigger("change"),b(this).parents(".as-selections").sortable({items:":not(.as-original)",update:function(e,t){var i=[];set=l.parents(".as-selections").find("li.as-selection-item"),b.each(set,function(e,t){i.push(b(t).attr("data-value"))}),b(l).siblings(".as-values").val(i.join(",")).trigger("change")}})},_CodeFieldSSLCheck:function(){b("body").append('<div class="sg-test" style="display:none"><svg xmlns="http://www.w3.org/2000/svg"></svg></div>'),"https://www.w3.org/2000/svg"===b(".sg-test").find("svg").attr("xmlns")&&(FLBuilder._codeDisabled=!0),b(".sg-test").remove()},_initCodeFields:function(){FLBuilder._codeDisabled||b(".fl-builder-settings:visible",window.parent.document).find(".fl-code-field").each(FLBuilder._initCodeField)},_initCodeField:function(){var o=b(this),s=o.closest(".fl-builder-settings"),t=o.find("textarea"),e=(t.attr("id"),t.data("editor")),i=t.data("wrap"),l=b("<div>",{position:"absolute",height:20*parseInt(t.attr("rows"),10)}),r=null,d=!(!s.hasClass("fl-builder-global-settings")&&!s.hasClass("fl-builder-layout-settings"));l.insertBefore(t),l.attr("contentEditable",!0),l.addClass("fl-ignore-validation"),t.css("display","none"),ace.require("ace/ext/language_tools"),(r=ace.edit(l[0])).$blockScrolling=1/0,r.getSession().setValue(t.val()),r.getSession().setMode("ace/mode/"+e),i&&r.getSession().setUseWrapMode(!0),r.setOptions(FLBuilderConfig.AceEditorSettings),r.getSession().on("change",function(e){t.val(r.getSession().getValue()).trigger("change"),saveBtn=s.find(".fl-builder-settings-save"),val=r.getSession().getValue(),0<s.find("#fl-builder-settings-section-bb_js_code").length&&"fl-field-bb_js_code"===o.closest(".fl-field").attr("ID")&&(null!==val.match(/<\/iframe>|<\/script>|<meta/gm)?(saveBtn.addClass("fl-builder-settings-error"),saveBtn.on("click",FLBuilder._showCodeFieldCriticalError)):(saveBtn.removeClass("fl-builder-settings-error"),saveBtn.off("click",FLBuilder._showCodeFieldCriticalError)))}),r.getSession().on("changeAnnotation",function(){for(var e=r.getSession().getAnnotations(),t=s.find(".fl-builder-settings-save"),i=s.find(".fl-builder-settings-error"),l=!1,n=0;n<e.length;n++)if(!(-1<e[n].text.indexOf("DOCTYPE")||-1<e[n].text.indexOf("Named entity expected")||-1<e[n].text.indexOf("@supports"))){if("error"===e[n].type){l=!0;break}-1<e[n].text.indexOf("Expected (<color>) but found")&&(e.splice(n,1),r.getSession().setAnnotations(e))}val=r.getSession().getValue(),d&&l&&null!==val.match(/<\/iframe>|<\/script>|<meta/gm)&&(t.addClass("fl-builder-settings-error"),t.on("click",FLBuilder._showCodeFieldCriticalError)),l&&0<s.find("#fl-builder-settings-section-bb_js_code").length&&"fl-field-bb_js_code"===o.closest(".fl-field").attr("ID")&&(t.addClass("fl-builder-settings-error"),t.on("click",FLBuilder._showCodeFieldCriticalError)),l&&!t.hasClass("fl-builder-settings-error")&&i.length&&FLBuilderConfig.CheckCodeErrors&&(t.addClass("fl-builder-settings-error"),t.on("click",FLBuilder._showCodeFieldError)),l||(i.removeClass("fl-builder-settings-error"),i.off("click",FLBuilder._showCodeFieldError),i.off("click",FLBuilder._showCodeFieldCriticalError))}),t.closest(".fl-field").data("editor",r)},_showCodeFieldError:function(e){e.stopImmediatePropagation(),FLBuilder.confirm({message:FLBuilderStrings.codeError,cancel:function(){var e=b(".fl-builder-settings:visible .fl-builder-settings-save",window.parent.document);e.removeClass("fl-builder-settings-error"),e.off("click",FLBuilder._showCodeFieldError),e.trigger("click")},strings:{ok:FLBuilderStrings.codeErrorFix,cancel:FLBuilderStrings.codeErrorIgnore}})},_showCodeFieldCriticalError:function(e){e.stopImmediatePropagation(),FLBuilder.alert(FLBuilderStrings.codeerrorhtml)},_initMultipleFields:function(){b(".fl-builder-settings:visible .fl-builder-field-multiples",window.parent.document).each(function(){var e=b(this),t=null,i=0,l=FLBuilderConfig.isRtl?{left:10}:{right:10},n=e.attr("data-limit")||0,o=e.find("tr").length||0;for(0<parseInt(n)&&o-1>=parseInt(n)?(e.find(".fl-builder-field-copy").hide(),e.find(".fl-builder-field-add").fadeOut()):e.find(".fl-builder-field-copy, .fl-builder-field-add").show();i<e.length;i++)1===(t=e.eq(i).find(".fl-builder-field-multiple")).length?t.eq(0).find(".fl-builder-field-actions").addClass("fl-builder-field-actions-single"):t.find(".fl-builder-field-actions").removeClass("fl-builder-field-actions-single");b(".fl-builder-field-multiples",window.parent.document).sortable({items:".fl-builder-field-multiple",cursor:"move",cursorAt:l,distance:5,opacity:.5,placeholder:"fl-builder-field-dd-zone",stop:FLBuilder._fieldDragStop,tolerance:"pointer",axis:"y"})})},_addFieldClicked:function(){var e=b(this),t=e.attr("data-field"),i=e.closest("tr").siblings("tr[data-field="+t+"]").last(),l=i.clone(),n=l.find(".fl-form-field"),o=null,s=parseInt(i.find("label span.fl-builder-field-index").html(),10)+1,s=(l.find("th label span.fl-builder-field-index").html(s),l.find(".fl-form-field-preview-text").html(""),l.find(".fl-form-field-before").remove(),l.find(".fl-form-field-after").remove(),l.find("input, textarea, select").val(""),l.find(".fl-color-picker-color").css("background-color","transparent"),l.find(".fl-color-picker-color").addClass("fl-color-picker-empty"),l.find(".fl-global-color-field-uid")&&l.find(".fl-global-color-field-uid").val(FLBuilder._uniqueColorID()),l.find(".picker-mount").empty(),i.after(l),l.closest(".fl-field"));FLBuilder._initMultipleFields(),FLBuilder._renumberFields(s),n.length?(o=n.find(".fl-form-field-edit").data("type"),n.find("input").val(JSON.stringify(FLBuilderSettingsConfig.defaults.forms[o])),n.find("input").trigger("change")):(o=(n=e.closest("form.fl-builder-settings")).data("type"))&&n.hasClass("fl-builder-module-settings")?(i=FLBuilderSettingsConfig.defaults.modules[o][t][0],l.find("input, textarea, select").val(i)):e.parents(".fl-field").find("input").trigger("change"),FLBuilder._updateRepeaterFormState(s)},_copyFieldClicked:function(){var e=b(this).closest("tr"),t=(e.data("field"),e.parent()),i=e.clone(),l=parseInt(e.find("label span.fl-builder-field-index").html(),10)+1;i.find("th label span.fl-builder-field-index").html(l),i.find(".fl-global-color-field-uid")&&(i.find(".fl-global-color-field-uid").val(FLBuilder._uniqueColorID()),clone_name=i.find(".fl-global-color-field-input.text").val()+" ("+FLBuilderStrings.copy+")",i.find(".fl-global-color-field-input.text").attr("value",clone_name),i.find(".fl-global-color-field-input.text").text(clone_name)),i.find(".picker-mount").empty(),e.after(i),FLBuilder._renumberFields(e.parent()),FLBuilder._initMultipleFields(),t.find("input").trigger("change"),FLBuilder._updateRepeaterFormState(e.parent()),FLBuilder.preview&&FLBuilder.preview.delayPreview()},_deleteFieldClicked:function(){var e=b(this).closest("tr"),t=e.parent(),i=t.closest(".fl-builder-settings").hasClass("fl-builder-global-styles");confirm(i?FLBuilderStrings.deleteGlobalColorsWarning:FLBuilderStrings.deleteFieldMessage)&&(e.remove(),FLBuilder._renumberFields(t),FLBuilder._initMultipleFields(),t.find("input").trigger("change"),FLBuilder._updateRepeaterFormState(t),FLBuilder.preview)&&FLBuilder.preview.delayPreview()},_getRepeaterSetting(t,e){e=new FormData(e);const i=[];return Array.from(e.entries()).filter(([e])=>e.startsWith(t+"[")).map(([e,l],t)=>{const[,...n]=e.split("][").map(e=>e.replaceAll("]","").replaceAll("[",""));0===n.length?i[t]=l:n.reduce((e={},t,i)=>(e[t]=void 0!==e[t]?e[t]:{},n.length-1===i&&(e[t]=l),e[t]),i)}),i},_updateRepeaterFormState(e){var{getSnapshot:t,setCurrentForm:i}=FL.Builder.settingsForms.state,l=e.attr("id").replace("fl-field-",""),t=t(),t=t[t.length-1],e=FLBuilder._getRepeaterSetting(l,e.closest("form").get(0));i({...t,settings:{...t.settings,[l]:e}})},_renumberFields:function(e){e.find(".fl-builder-field-multiple").each(function(e,t){b(t).find("th label span.fl-builder-field-index").html(e+1),FLBuilder._renumberFieldAttr(t,"name",e),FLBuilder._renumberFieldAttr(t,"id",e),FLBuilder._renumberFieldAttr(t,"for",e)})},_renumberFieldAttr:function(e,l,n){b(e).find("["+l+"]").each(function(e,t){var i=(i=b(t).attr(l)).replace(/\[(\d+)\]/,"["+n+"]");b(t).attr(l,i)})},_fieldDragHelper:function(){return b('<div class="fl-builder-field-dd-helper"></div>')},_fieldDragStop:function(e,t){FLBuilder._renumberFields(t.item.parent()),t.item.find("input").trigger("change"),FLBuilder._updateRepeaterFormState(t.item.parent()),FLBuilder.preview&&FLBuilder.preview.delayPreview()},_initSelectFields:function(){var e=b(".fl-builder-settings:visible",window.parent.document).find("select:not(.fl-preview-ignore)"),e=(e.on("change",FLBuilder._settingsSelectChanged),e.trigger("change"),e.on("change",FLBuilder._calculateSettingsTabsOverflow),b(".fl-builder-settings:visible",window.parent.document).find(".fl-button-group-field input[type=hidden]:not(.fl-preview-ignore)"));e.on("change",FLBuilder._settingsSelectChanged),e.trigger("change"),e.on("change",FLBuilder._calculateSettingsTabsOverflow),FLBuilder.removeHook("settings-form-init",FLBuilder._initSelectFieldSetFields),FLBuilder.addHook("settings-form-init",FLBuilder._initSelectFieldSetFields)},_settingsSelectChanged:function(e){var t=b(this),i=t.attr("data-root-name"),l=t.attr("data-toggle"),n=t.attr("data-hide"),o=t.attr("data-trigger"),s=(t.attr("data-set"),t.val()),r=0,d=FLBuilderResponsiveEditing._mode,a=t.closest(".fl-field-responsive-setting"),u="fl-field-responsive-setting-"+d;if(""===s&&i&&(s=FLBuilderSettingsForms.getField(i)?.getInheritedValue(d)||s),!a.length||t.parent().hasClass(u)||t.parent().parent().hasClass(u)){if(void 0!==l){for(r in l=FLBuilder._jsonParse(l))FLBuilder._settingsSelectToggle(l[r].fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(l[r].sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(l[r].tabs,"hide","a[href*=fl-builder-settings-tab-","]");void 0!==l[s]&&(FLBuilder._settingsSelectToggle(l[s].fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(l[s].sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(l[s].tabs,"show","a[href*=fl-builder-settings-tab-","]"))}if(void 0!==n){for(r in n=FLBuilder._jsonParse(n))FLBuilder._settingsSelectToggle(n[r].fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(n[r].sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(n[r].tabs,"show","a[href*=fl-builder-settings-tab-","]");void 0!==n[s]&&(FLBuilder._settingsSelectToggle(n[s].fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(n[s].sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(n[s].tabs,"hide","a[href*=fl-builder-settings-tab-","]"))}if(void 0!==o&&void 0!==(o=FLBuilder._jsonParse(o))[s]&&void 0!==o[s].fields)for(r=0;r<o[s].fields.length;r++)b("#fl-field-"+o[s].fields[r]).find("select").trigger("change")}},_settingsSelectToggle:function(e,t,i,l){var n=0;if(l=void 0===l?"":l,void 0!==e)for(;n<e.length;n++)b(".fl-builder-settings:visible",window.parent.document).find(i+e[n]+l)[t](),b(i+e[n]+l).parent().find('.fl-field[data-type="code"]').each(function(){!FLBuilder._codeDisabled&&b(this).data("editor")&&b(this).data("editor").resize()})},_initSelectFieldSetFields:function(){var e=b(".fl-builder-settings:visible",window.parent.document).find("select:not(.fl-preview-ignore)"),t=b(".fl-builder-settings:visible",window.parent.document).find(".fl-button-group-field input[type=hidden]:not(.fl-preview-ignore)");e.on("change",FLBuilder._settingsSelectSetFields),t.on("change",FLBuilder._settingsSelectSetFields)},_settingsSelectSetFields:function(){var e=b(this),t=(e.attr("data-root-name"),e.attr("data-set")),i=e.val(),l=FLBuilderResponsiveEditing._mode;if(void 0!==t&&void 0!==(t=FLBuilder._jsonParse(t))[i])for(var n in t[i]){var o=FLBuilderSettingsForms.getField(n),s=t[i][n];if("object"==typeof s)for(var r in s)o.setSubValue(r,s[r],l);else o.setValue(s,l)}},_toggleForm:function(){b(".fl-builder-settings:visible",window.parent.document).find("select:visible, .fl-button-group-field:visible input[type=hidden]:not(.fl-preview-ignore)").each(function(){if(this.hasAttribute("data-toggle")){var t=FLBuilder._jsonParse(this.getAttribute("data-toggle")),i=FLBuilder._jsonParse(this.getAttribute("data-hide")),l=this.getAttribute("data-root-name");let e=this.value;if(""===e&&l&&(l=FLBuilderSettingsForms.getField(l)?.getInheritedValue(FLBuilderResponsiveEditing._mode),e=l||e),t){for(var n in t)FLBuilder._settingsSelectToggle(t[n].fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(t[n].sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(t[n].tabs,"hide","a[href*=fl-builder-settings-tab-","]");void 0!==t[e]&&(FLBuilder._settingsSelectToggle(t[e].fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(t[e].sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(t[e].tabs,"show","a[href*=fl-builder-settings-tab-","]"))}if(i){for(var o in i)FLBuilder._settingsSelectToggle(i[o].fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(i[o].sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(i[o].tabs,"show","a[href*=fl-builder-settings-tab-","]");void 0!==i[e]&&(FLBuilder._settingsSelectToggle(i[e].fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(i[e].sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(i[e].tabs,"hide","a[href*=fl-builder-settings-tab-","]"))}}})},_initColorPickers:function(){FLBuilder.colorPicker?FLBuilder.colorPicker._init():(FLBuilder.colorPicker=new FLBuilderColorPicker({mode:"hsv",elements:".fl-color-picker .fl-color-picker-value",presets:FLBuilderConfig.colorPresets||[],globals:function(){var e=FLBuilderConfig.styles,t=FLBuilderConfig.themeJSON;return{bb:e?e.colors:[],wp:t&&t.color.palette.default?t.color.palette.default:[],theme:t&&t.color.palette.theme?t.color.palette.theme:[]}},labels:{colorPresets:FLBuilderStrings.colorPresets,colorPicker:FLBuilderStrings.colorPicker,placeholder:FLBuilderStrings.placeholder,removePresetConfirm:FLBuilderStrings.removePresetConfirm,noneColorSelected:FLBuilderStrings.noneColorSelected,alreadySaved:FLBuilderStrings.alreadySaved,noPresets:FLBuilderStrings.noPresets,presetAdded:FLBuilderStrings.presetAdded}}),b(FLBuilder.colorPicker).on("presetRemoved presetAdded presetSorted",function(e,t){FLBuilder.ajax({action:"save_color_presets",presets:t.presets})}))},_hideColorPicker:function(){b(".fl-color-picker-ui.fl-color-picker-active",window.parent.document).removeClass("fl-color-picker-active")},_initGradientPickers:function(){b(".fl-builder-settings:visible .fl-gradient-picker",window.parent.document).each(FLBuilder._initGradientPicker)},_initGradientPicker:function(){var e=b(this),t=e.find(".fl-gradient-picker-type-select"),i=e.find(".fl-gradient-picker-angle-wrap"),l=e.find(".fl-gradient-picker-position");t.on("change",function(){"linear"===b(this).val()?(i.show(),l.hide()):(i.hide(),l.show())})},_uniqueColorID:function(){var t="abcdefghijklmnopqrstuvwxyz0123456789";let i="";for(let e=0;e<9;e++){var l=Math.floor(Math.random()*t.length);i+=t.charAt(l)}return i},_initPhotoFields:function(){var e=b(".fl-builder-settings:visible",window.parent.document).find(".fl-photo-field select");e.on("change",FLBuilder._toggleSettingsOnIconChange),e.trigger("change")},_initSinglePhotoSelector:function(){null===FLBuilder._singlePhotoSelector&&(FLBuilder._singlePhotoSelector=wp.media({title:FLBuilderStrings.selectPhoto,button:{text:FLBuilderStrings.selectPhoto},library:{type:FLBuilderConfig.uploadTypes.image},multiple:!1}),FLBuilder._singlePhotoSelector.on("open",FLBuilder._wpmedia_reset_errors),window.parent._wpPluploadSettings.defaults.multipart_params.fl_upload_type="photo")},_selectSinglePhoto:function(){if(!FLBuilderConfig.userCaps.canUpload)return FLBuilder.alert(FLBuilderStrings.uploadBlocked),!1;FLBuilder._initSinglePhotoSelector(),FLBuilder._singlePhotoSelector.once("open",b.proxy(FLBuilder._singlePhotoOpened,this)),FLBuilder._singlePhotoSelector.once("select",b.proxy(FLBuilder._singlePhotoSelected,this)),FLBuilder._singlePhotoSelector.open()},_singlePhotoOpened:function(){var e=FLBuilder._singlePhotoSelector.state().get("selection"),t=b(this).closest(".fl-photo-field"),i=t.find("input[type=hidden]"),l=i.val(),n=null;b(this).hasClass("fl-photo-replace")?(e.reset(),t.addClass("fl-photo-empty"),i.val("")):""!==l?((n=wp.media.attachment(l)).fetch(),e.add(n?[n]:[])):e.reset()},_singlePhotoSelected:function(){var e=FLBuilder._singlePhotoSelector.state().get("selection").first().toJSON(),t=b(this).closest(".fl-photo-field"),i=t.find("input[type=hidden]"),l=t.find(".fl-photo-preview img"),n=t.find("select");e.url&&e.url.endsWith(".svg")&&(e.sizes={full:{url:e.url,filename:e.url.split("/").pop(),height:"",width:""}}),i.val(e.id),l.attr("src",FLBuilder._getPhotoSrc(e)),t.removeClass("fl-photo-empty").removeClass("fl-photo-no-attachment"),t.find("label.error").remove(),n.show(),n.html(FLBuilder._getPhotoSizeOptions(e,n.val())),n.trigger("change"),FLBuilderSettingsConfig.attachments[e.id]=e},_singlePhotoRemoved:function(){FLBuilder._initSinglePhotoSelector();var e=FLBuilder._singlePhotoSelector.state(),e=void 0!==e?e.get("selection"):null,t=b(this).closest(".fl-photo-field"),i=t.find("input[type=hidden]"),l=t.find("select");e&&e.reset(),t.addClass("fl-photo-empty"),i.val(""),l.html('<option value="" selected></option>'),l.trigger("change")},_getPhotoSrc:function(e){return(void 0===e.sizes?e:void 0!==e.sizes.thumbnail?e.sizes.thumbnail:e.sizes.full).url},_getPhotoSizeOptions:function(e,t){var i="",l=null,n=null,o=!1,s="",r="",d={full:FLBuilderStrings.fullSize,large:FLBuilderStrings.large,medium:FLBuilderStrings.medium,thumbnail:FLBuilderStrings.thumbnail};if(void 0===e.sizes||0===e.sizes.length)i+='<option value="'+e.url+'">'+FLBuilderStrings.fullSize+"</option>";else{for(sizecheck in t=t&&t.split(/[\\/]/).pop(),selectedverified=!1,e.sizes)if(e.sizes[sizecheck].url.split(/[\\/]/).pop()===t){selectedverified=!0;break}for(l in selectedverified||(t=!1),e.sizes)n="",s=void 0!==d[l]?d[l]:void 0!==FLBuilderConfig.customImageSizeTitles[l]?FLBuilderConfig.customImageSizeTitles[l]:"",t?t!==e.sizes[l].url.split(/[\\/]/).pop()||o||(n=' selected="selected"',o=!0):(void 0!==FLBuilderConfig.photomodulesize&&l===FLBuilderConfig.photomodulesize&&!o||l==FLBuilderConfig.defaultImageSize&&!o)&&(n=' selected="selected"',o=!0),e.sizes[l].width&&e.sizes[l].height&&(s=s&&s+" - ",r=e.sizes[l].width+" x "+e.sizes[l].height),i+='<option data-size="'+l+'" value="'+e.sizes[l].url+'"'+n+">"+s+r+"</option>"}return i},_selectMultiplePhotos:function(){var e=b(this).closest(".fl-multiple-photos-field").find("input[type=hidden]").val(),t=""===e?"":FLBuilder._jsonParse(e),e=wp.media.gallery.defaults.id,i='[gallery ids="-1"]',l=null,n=null,o=null,s=null,r=[];if(!FLBuilderConfig.userCaps.canUpload)return FLBuilder.alert(FLBuilderStrings.uploadBlocked),!1;if("object"==typeof t){for(s in t)r.push(t[s]);i='[gallery ids="'+r.join()+'"]'}l=wp.shortcode.next("gallery",i).shortcode,_.isUndefined(l.get("id"))&&!_.isUndefined(e)&&l.set("id",e),n=wp.media.gallery.attachments(l),(o=new wp.media.model.Selection(n.models,{props:n.props.toJSON(),multiple:!0})).gallery=n.gallery,o.more().done(function(){o.length||FLBuilder._multiplePhotoSelector.setState("gallery-library"),o.props.set({query:!1}),o.unmirror(),o.props.unset("orderby")}),FLBuilder._multiplePhotoSelector&&FLBuilder._multiplePhotoSelector.dispose(),window.parent._wpPluploadSettings.defaults.multipart_params.fl_upload_type="photo",FLBuilder._multiplePhotoSelector=wp.media({frame:"post",state:b(this).hasClass("fl-multiple-photos-edit")?"gallery-edit":"gallery-library",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0,selection:o}).open(),b(FLBuilder._multiplePhotoSelector.views.view.el).addClass("fl-multiple-photos-lightbox"),FLBuilder._multiplePhotoSelector.once("update",b.proxy(FLBuilder._multiplePhotosSelected,this))},_multiplePhotosSelected:function(e){for(var t=b(this).closest(".fl-multiple-photos-field"),i=t.find("input[type=hidden]"),l=t.find(".fl-multiple-photos-count"),n=[],o=0;o<e.models.length;o++)n.push(e.models[o].id);1==n.length?l.html("1 "+FLBuilderStrings.photoSelected):l.html(n.length+" "+FLBuilderStrings.photosSelected),t.removeClass("fl-multiple-photos-empty"),t.find("label.error").remove(),i.val(JSON.stringify(n)).trigger("change")},_initSingleVideoSelector:function(){var e;null===FLBuilder._singleVideoSelector&&(e=window.parent._wpPluploadSettings.defaults.filters.mime_types[0].extensions,window.parent._wpPluploadSettings.defaults.multipart_params.fl_upload_type="video",window.parent._wpPluploadSettings.defaults.filters.mime_types[0].extensions=FLBuilderConfig.uploadTypes.videoTypes,FLBuilder._singleVideoSelector=wp.media({title:FLBuilderStrings.selectVideo,button:{text:FLBuilderStrings.selectVideo},library:{type:["video/mp4","video/webm"]},multiple:!1}),FLBuilder._singleVideoSelector.on("open",FLBuilder._wpmedia_reset_errors),FLBuilder._singleVideoSelector.on("close",function(){window.parent._wpPluploadSettings.defaults.filters.mime_types[0].extensions=e}))},_selectSingleVideo:function(){if(!FLBuilderConfig.userCaps.canUpload)return FLBuilder.alert(FLBuilderStrings.uploadBlocked),!1;FLBuilder._initSingleVideoSelector(),FLBuilder._singleVideoSelector.once("select",b.proxy(FLBuilder._singleVideoSelected,this)),FLBuilder._singleVideoSelector.open()},_singleVideoSelected:function(){var e=FLBuilder._singleVideoSelector.state().get("selection").first().toJSON(),t=b(this).closest(".fl-video-field"),i=t.find(".fl-video-preview-img"),l=t.find(".fl-video-preview-filename"),n=t.find("input[type=hidden]");i.html('<span class="dashicons dashicons-media-video"></span>'),l.html(e.filename),t.removeClass("fl-video-empty"),t.find("label.error").remove(),n.val(e.id).trigger("change"),FLBuilderSettingsConfig.attachments[e.id]=e},_singleVideoRemoved:function(){FLBuilder._initSingleVideoSelector();var e=FLBuilder._singleVideoSelector.state(),e=void 0!==e?e.get("selection"):null,t=b(this).closest(".fl-video-field"),i=t.find(".fl-video-preview-img img"),l=t.find(".fl-video-preview-filename"),n=t.find("input[type=hidden]");e&&e.reset(),i.attr("src",""),l.html(""),t.addClass("fl-video-empty"),n.val("").trigger("change")},_selectMultipleAudios:function(){var e=b(this).closest(".fl-multiple-audios-field").find("input[type=hidden]").val(),e=""==e?'[playlist ids="-1"]':'[playlist ids="'+FLBuilder._jsonParse(e).join()+'"]',e=wp.shortcode.next("playlist",e).shortcode,t=wp.media.playlist.defaults.id,i=null,l=null;if(_.isUndefined(e.get("id"))&&!_.isUndefined(t)&&e.set("id",t),!FLBuilderConfig.userCaps.canUpload)return FLBuilder.alert(FLBuilderStrings.uploadBlocked),!1;window.parent._wpPluploadSettings.defaults.multipart_params.fl_upload_type="audio",i=wp.media.playlist.attachments(e),(l=new wp.media.model.Selection(i.models,{props:i.props.toJSON(),multiple:!0})).playlist=i.playlist,l.more().done(function(){l.props.set({query:!1}),l.unmirror(),l.props.unset("orderby")}),FLBuilder._multipleAudiosSelector&&FLBuilder._multipleAudiosSelector.dispose(),FLBuilder._multipleAudiosSelector=wp.media({frame:"post",state:b(this).hasClass("fl-multiple-audios-edit")?"playlist-edit":"playlist-library",title:wp.media.view.l10n.editPlaylistTitle,editing:!0,multiple:!0,selection:l}).open(),FLBuilder._multipleAudiosSelector.content.get("view").sidebar.unset("playlist"),FLBuilder._multipleAudiosSelector.on("content:render:browse",function(e){e&&e.sidebar.on("ready",function(){e.sidebar.unset("playlist")})}),FLBuilder._multipleAudiosSelector.once("update",b.proxy(FLBuilder._multipleAudiosSelected,this))},_multipleAudiosSelected:function(e){for(var t=b(this).closest(".fl-multiple-audios-field"),i=t.find(".fl-multiple-audios-count"),l=t.find("input[type=hidden]"),n=[],o=0;o<e.models.length;o++)n.push(e.models[o].id);1==n.length?i.html("1 "+FLBuilderStrings.audioSelected):i.html(n.length+" "+FLBuilderStrings.audiosSelected),l.val(JSON.stringify(n)).trigger("change"),t.removeClass("fl-multiple-audios-empty"),t.find("label.error").remove()},_initIconFields:function(){var e=b(".fl-builder-settings:visible",window.parent.document).find(".fl-icon-field input");e.on("change",FLBuilder._toggleSettingsOnIconChange),e.trigger("change")},_toggleSettingsOnIconChange:function(){var e=b(this),t=e.val(),e=e.attr("data-show");void 0!==e&&(e=FLBuilder._jsonParse(e),FLBuilder._settingsSelectToggle(e.fields,"hide","#fl-field-"),FLBuilder._settingsSelectToggle(e.sections,"hide","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(e.tabs,"hide","a[href*=fl-builder-settings-tab-","]"),t)&&(FLBuilder._settingsSelectToggle(e.fields,"show","#fl-field-"),FLBuilder._settingsSelectToggle(e.sections,"show","#fl-builder-settings-section-"),FLBuilder._settingsSelectToggle(e.tabs,"show","a[href*=fl-builder-settings-tab-","]"),FLBuilder._calculateSettingsTabsOverflow())},_selectIcon:function(){var t=this;FLIconSelector.open(function(e){FLBuilder._iconSelected.apply(t,[e])})},_iconSelected:function(e){var t=b(this).closest(".fl-icon-field"),i=t.find("input[type=hidden]"),l=t.find("i"),n=l.attr("data-icon");i.val(e).trigger("change"),l.removeClass(n),l.addClass(e),l.attr("data-icon",e),t.removeClass("fl-icon-empty"),t.find("label.error").remove()},_removeIcon:function(){var e=b(this).closest(".fl-icon-field"),t=e.find("input[type=hidden]"),i=e.find("i");t.val("").trigger("change"),i.removeClass(),i.attr("data-icon",""),e.addClass("fl-icon-empty")},_formFieldClicked:function(){var e=b(this),t=e.attr("data-type"),i=e.siblings("input"),l=i.attr("name").replace(/\[(.*)\]/,""),n=i.val(),e=e.closest(".fl-builder-field-multiple"),e=e.length?e.index(".fl-builder-field-multiple"):null,o=FLBuilderSettingsConfig.defaults.forms[t];FLBuilder.isBlockEditor()?(n=JSON.parse(n),n=JSON.stringify({...o,...n}),FLBuilder.triggerHook("renderFormFieldSettings",[t,n,i,l,e])):(""===n&&(n=JSON.stringify(o),i.val(n)),l=FLBuilder._openNestedSettings({className:"fl-builder-lightbox fl-form-field-settings"}),FLBuilder._renderFormFieldSettings(t,n,i,l,function(){FLBuilderResponsiveEditing._switchAllSettingsToCurrentMode()}))},_renderFormFieldSettings:function(t,e,i,l,n){var o=b(".fl-builder-settings:visible"),s=i.siblings("a"),r=FLBuilder._moduleHelpers[t];FLBuilderSettingsConfig.forms[t];FLBuilder.preview?.preview(),FLBuilderSettingsForms.render({id:t,nodeId:o.attr("data-node"),nodeSettings:FLBuilder._getSettings(o),settings:FLBuilder._jsonParse(e.replace(/&#39;/g,"'")),lightbox:l,rules:r?r.rules:null,helper:{init:function(){var e=b(".fl-builder-settings:visible");s.attr("id","fl-"+e.attr("data-instance-id")),e.attr("data-type",t),r&&r.init(),FLBuilder._initFormFieldSettingsPreview()}}},n)},_saveFormFieldClicked:function(){var e=b(this).closest(".fl-builder-settings");FLBuilder._saveFormFieldSettings(e)?FLBuilder._closeNestedSettings():FLBuilder._toggleSettingsTabErrors()},_initFormFieldSettingsPreview:function(){var e=b(".fl-builder-settings:visible"),t=e.find(".fl-field"),i=e.find("textarea.wp-editor-area"),e=(e.on("input","input:not([type=hidden]), textarea",FLBuilder._previewFormFieldSettings),e.on("change","input[type=hidden], select",FLBuilder._previewFormFieldSettings),t.find("input[name=shape_name]")),t=t.find("input[name=shape_original]");0<e.length&&(t.hide(),e.on("keyup",function(){FLBuilder._shapesEdited=!0}),0<e.val().length)&&t.val().length<1&&t.val(e.val()),void 0!==window.parent.tinyMCE&&i.each(function(e,t){(t=window.parent.tinyMCE.get(b(t).attr("id"))).on("change",FLBuilder._previewFormFieldSettings),t.on("keyup",FLBuilder._previewFormFieldSettings)})},_previewFormFieldSettings:function(){var e=this.formElement||this,t=b(e).closest(".fl-builder-settings"),e=t.data("timeout");e&&clearTimeout(e),e=setTimeout(function(){FLBuilder._saveFormFieldSettings(t)},1e3),t.data("timeout",e)},_saveFormFieldSettings:function(e){var t,i=e.attr("data-instance-id"),l=e.attr("data-type"),n=FLBuilder._getSettings(e),l=FLBuilder._moduleHelpers[l],i=b(".fl-builder-settings #fl-"+i,window.parent.document),o=i.parent().attr("data-preview-text"),s=i.parent().attr("data-preview-image"),r=[],d=null,a="",u=null,c=document.createElement("div"),f=!0;o&&(r=o.split(","));for(var h=0;h<r.length;h++)if(n[r[h]]){a=n[t=r[h]],d=e.find("#fl-field-"+t),u=b('select[name="'+t+'"]',window.parent.document);break}return s=s&&n[s],u&&0<u.length&&(a=u.find('option[value="'+a+'"]').text()),void 0!==l&&(e.find("label.error").remove(),e.validate().hideErrors(),f=(f=e.validate().form())&&l.submit()),!!f&&(void 0!==o&&void 0!==a&&("icon"===d?.data("type")?a='<i class="'+FLBuilderSettingsForms.escapeHTML(a)+'"></i>':35<a.length&&(c.innerHTML=a,a=(c.textContent||c.innerText||"").replace(/^(.{35}[^\s]*).*/,"$1")+"...",a=FLBuilderSettingsForms.escapeHTML(a)),"filter_meta_label"==o&&(a=a||FLBuilderSettingsForms.escapeHTML(n.filter_meta_key)),s&&(a='<img style="max-width: 60px" src="'+FLBuilderSettingsForms.escapeHTML(s)+'" />&nbsp;'+a),i.siblings(".fl-form-field-preview-text").html(a)),0<i.length&&!FLBuilder.isBlockEditor()&&(""!=(l=i.siblings("input").val().replace(/&#39;/g,"'"))&&(n=b.extend(FLBuilder._jsonParse(l),n)),i.siblings("input").val(JSON.stringify(n)).trigger("change")),!0)},_layoutFieldClicked:function(){var e=b(this);e.siblings().removeClass("fl-layout-field-option-selected"),e.addClass("fl-layout-field-option-selected"),e.siblings("input").val(e.attr("data-value"))},_initLinkFields:function(){b(".fl-builder-settings:visible .fl-link-field",window.parent.document).each(FLBuilder._initLinkField)},_initLinkField:function(){var e=b(this),t=e.find(".fl-link-field-search-input"),e=e.find(".fl-link-field-options-wrap input[type=checkbox]");t.autoSuggest(FLBuilder._ajaxUrl({fl_action:"fl_builder_autosuggest",fl_as_action:"fl_as_links",_wpnonce:FLBuilderConfig.ajaxNonce}),{asHtmlID:t.attr("name"),selectedItemProp:"name",searchObjProps:"name",minChars:3,keyDelay:1e3,fadeOut:!1,usePlaceholder:!0,emptyText:FLBuilderStrings.noResultsFound,showResultListWhenNoMatch:!0,queryParam:"fl_as_query",selectionLimit:1,afterSelectionAdd:FLBuilder._updateLinkField,formatList:function(e,t){return t.html(e.name+'<span class="type">['+e.type+"]</span>")}}),e.on("click",FLBuilder._linkFieldCheckboxClicked)},_updateLinkField:function(e,t,i){var e=e.closest(".fl-link-field"),l=e.find(".fl-link-field-search"),n=e.find(".fl-link-field-search-input");e.find(".fl-link-field-input").val(t.value).trigger("keyup"),n.autoSuggest("remove",t.value),l.hide()},_linkFieldSelectClicked:function(){var e=b(this).closest(".fl-link-field").find(".fl-link-field-search");e.show(),e.find("input").focus()},_linkFieldSelectCancelClicked:function(){var e=b(this);e.parent().hide(),e.closest(".fl-link-field").find("input.fl-link-field-input").focus()},_linkFieldCheckboxClicked:function(){var e=b(this),t=e.is(":checked"),i=e.siblings("input[type=hidden]"),l="",l=e.hasClass("fl-link-field-target-cb")?t?"_blank":"_self":t?"yes":"no";i.val(l)},_initFontFields:function(){b(".fl-builder-settings:visible .fl-font-field",window.parent.document).each(FLBuilder._initFontField)},_initFontField:function(){var t,e=b(this),i=e.closest(".fl-compound-field-section"),l=e.attr("data-value"),n=e.find(".fl-font-field-font"),e=e.find(".fl-font-field-weight");i.length&&!i.hasClass("fl-font-field-lazy-init")?(i.addClass("fl-font-field-lazy-init"),i.one("click",()=>FLBuilder._initFontField.apply(this)),-1<l.indexOf("family")&&(l=FLBuilder._jsonParse(l),n.append('<option value="'+l.family+'" selected>'+l.family+"</option>"),e.append('<option value="'+l.weight+'" selected>'+l.weight+"</option>"))):(FLBuilder._initFontFamilyOptions(n),FLBuilderConfig.select2Enabled&&n.select2({width:"100%"}).on("select2:open",function(e){b(".select2-search__field").attr("placeholder",FLBuilderStrings.placeholderSelect2)}),b("body",window.parent.document).on({mouseenter:function(){var e=jQuery(this).text(),t=jQuery(this).parent().parent().attr("aria-label"),i=jQuery("head",window.parent.document),l="https://fonts.googleapis.com/css?family="+e,n=e.toLowerCase().replaceAll(" ","-"),o=b(this).parent().parent().parent().attr("id");if(!o)return!1;if(o.indexOf("typographyfont_family")<0)return!1;if("Google"===t){if(linkElement="<link id='"+n+"' rel='stylesheet' href='"+l+"' type='text/css' media='screen'>",jQuery(this).css("font-family",'"'+e+'"'),0<jQuery("#"+n).length)return!1;i.append(linkElement)}}},".select2-results__option.select2-results__option--highlighted"),n.on("change",function(){FLBuilder._getFontWeights(n)}),-1<l.indexOf("family")&&(l=FLBuilder._jsonParse(l),t=!1,fonts=FLBuilderFontFamilies,Object.keys(fonts.system).forEach(function(e){e===l.family&&(t=!0)}),Object.keys(fonts.google).forEach(function(e){e===l.family&&(t=!0)}),t||"Default"===l.family||(l={family:"Default",weight:"400"}),n.val(l.family),n.trigger("change"),e.find("option[value="+l.weight+"]").length)&&e.val(l.weight))},_initFontFamilyOptions:function(e){if(!FLBuilder._fontFamilyCache){var t=FLBuilderFontFamilies,i=FLBuilderConfig.recentFonts||{};const n=(e,t)=>{var i=document.createElement("option");return i.value=e,i.textContent=t,i};var l=document.createDocumentFragment(),i=(l.appendChild(n("Default","Default")),Object.keys(i).filter(e=>"Default"!==e));if(i.length){const r=document.createElement("optgroup");r.label="Recently Used",r.className="recent-fonts",i.forEach(e=>r.appendChild(n(e,e))),l.appendChild(r)}const o=document.createElement("optgroup"),s=(o.label="System",Object.keys(t.system).forEach(e=>{o.appendChild(n(e,e))}),l.appendChild(o),document.createElement("optgroup"));s.label="Google",Object.keys(t.google).forEach(e=>{s.appendChild(n(e,e))}),l.appendChild(s),FLBuilder._fontFamilyCache=l}e.empty(),e.append(FLBuilder._fontFamilyCache.cloneNode(!0))},_getFontWeights:function(e){var i=e.closest(".fl-font-field").find(".fl-font-field-weight"),l=e.val(),n=i.val(),o=FLBuilderConfig.FontWeights,t={},s=e.closest(".fl-font-field").find(".recent-fonts option");i.html(""),0<s.length&&!1==0<b(s).filter(function(e,t){return t.value===l}).length&&"Default"!==l&&e.closest(".fl-font-field").find(".recent-fonts").append(b("<option>",{value:l,text:l})),t=void 0!==FLBuilderFontFamilies.system[l]?FLBuilderFontFamilies.system[l].weights:(void 0!==FLBuilderFontFamilies.google[l]?FLBuilderFontFamilies.google:FLBuilderFontFamilies.default)[l],b.each(t,function(e,t){i.append('<option value="'+t+'"'+(n===t?" selected":"")+">"+o[t]+"</option>")})},_initTinyMCE:function(){"object"==typeof tinymce&&void 0!==tinymce.ui.FloatPanel&&(tinymce.ui.FloatPanel.zIndex=100100),b(".fl-builder-hidden-editor",window.parent.document).each(function(){FLBuilder._initEditorField.call(this,window.parent)}),void 0!==FLBuilder.UIIFrame&&FLBuilder.UIIFrame.isEnabled()&&b(".fl-builder-hidden-editor").each(function(){FLBuilder._initEditorField.call(this,window)}),void 0!==window.parent.acf&&window.parent.acf.add_filter("wysiwyg_tinymce_settings",function(e,t){return b.extend({},tinyMCEPreInit.mceInit.flbuildereditor,e)})},_initEditorFields:function(){b(".fl-builder-settings:visible .fl-editor-field",window.parent.document).each(function(){FLBuilder._initEditorField.call(this,window.parent)})},_initEditorField:function(e){var t=b(this),i=t.find("textarea"),l=t.attr("data-name"),l="flrich"+(new Date).getTime()+"_"+l,n=FLBuilderConfig.wp_editor,o=e.tinyMCEPreInit,s=Number(t.attr("data-buttons")),t=t.attr("data-rows"),r=null,d=null,n=n.replace(/flbuildereditor/g,l),o=JSONfn.parse(JSONfn.stringify(o).replace(/flbuildereditor/g,l));i.after(n).remove(),b("textarea#"+l,e.document).val(i.val()),e.tinymce,void 0!==o.mceInit[l]&&((r=o.mceInit[l]).setup=function(e){e.on("SaveContent",function(e){e.content=e.content.replace(/<a href="(\.\.\/){1,2}/g,'<a href="'+FLBuilderConfig.homeUrl+"/"),e.content=e.content.replace(/src="(\.\.\/){1,2}/g,'src="'+FLBuilderConfig.homeUrl+"/")})},(d=b("#wp-"+l+"-wrap",e.document)).find("textarea").attr("rows",t),d.find("textarea").attr("contentEditable",!0),s||d.find(".wp-media-buttons").remove(),!d.hasClass("tmce-active")&&o.qtInit.hasOwnProperty(l)||r.wp_skip_init||e.tinymce.init(r)),e.quicktags,e.quicktags(o.qtInit[l]),e.wpActiveEditor=l},_reinitEditorFields:function(){b("form.fl-builder-settings:visible",window.parent.document).length&&setTimeout(function(){var e,t,i;if(void 0!==window.parent.tinymce){for(e=window.parent.tinymce.editors.length-1;-1<e;e--)window.parent.tinymce.editors[e].inline||(t=window.parent.tinymce.editors[e].id,window.parent.tinyMCE.execCommand("mceRemoveEditor",!0,t),window.parent.tinyMCE.execCommand("mceAddEditor",!0,t));FLBuilder.preview&&(i=b('.fl-field[data-type="editor"]',window.parent.document),FLBuilder.preview._initDefaultFieldPreviews(i))}},1)},_destroyEditorFields:function(){var e;if(void 0!==window.parent.tinymce){for(e=window.parent.tinymce.editors.length-1;-1<e;e--)window.parent.tinymce.editors[e].inline||window.parent.tinyMCE.execCommand("mceRemoveEditor",!0,window.parent.tinymce.editors[e].id);b(".wplink-autocomplete",window.parent.document).remove(),b(".ui-helper-hidden-accessible",window.parent.document).remove()}},_updateEditorFields:function(){b(".fl-builder-settings:visible textarea.wp-editor-area",window.parent.document).each(FLBuilder._updateEditorField)},_updateEditorField:function(){var e=b(this),t=e.closest(".fl-editor-field"),i=(e.closest(".fl-builder-settings"),e.closest(".wp-editor-wrap")),l=e.attr("id"),n=t.attr("data-name"),l=void 0!==window.parent.tinymce&&window.parent.tinymce.get(l),o=e.siblings('textarea[name="'+n+'"]'),t=t.data("wpautop");0===o.length&&(o=b('<textarea name="'+n+'"></textarea>',window.parent.document).hide(),e.after(o)),t?l&&i.hasClass("tmce-active")?o.val(l.getContent()):void 0!==window.parent.switchEditors?o.val(window.parent.switchEditors.wpautop(e.val())):o.val(e.val()):(l&&i.hasClass("tmce-active")&&l.save(),o.val(e.val()))},_initPostTypeFields:function(){b(".fl-builder-settings:visible #fl-field-post_type").each(FLBuilder._initPostTypeField)},_initPostTypeField:function(){var e=b(this).find("select");FLBuilderConfig.select2Enabled&&e.select2({width:"50%"})},_loopDataSourceChange:function(){var e=b(this).val();b(".fl-loop-data-source",window.parent.document).hide(),b('.fl-loop-data-source[data-source="'+e+'"]',window.parent.document).show()},_customQueryPostTypesChange:function(){var e=b(this).val();b(".fl-custom-query-filter").hide();for(val of e)b(".fl-custom-query-"+val+"-filter").show()},_customQueryPostTypeChange:function(){var e=b(this).val();b(".fl-custom-query-filter",window.parent.document).hide(),b(".fl-custom-query-"+e+"-filter",window.parent.document).show()},_initOrderingFields:function(){b(".fl-builder-settings:visible .fl-ordering-field-options",window.parent.document).each(FLBuilder._initOrderingField)},_initOrderingField:function(){b(this).sortable({items:".fl-ordering-field-option",containment:"parent",tolerance:"pointer",stop:FLBuilder._updateOrderingField})},_updateOrderingField:function(e){var e=b(e.target),t=e.siblings("input[type=hidden]"),i=[];e.find(".fl-ordering-field-option").each(function(){i.push(b(this).attr("data-key"))}),t.val(JSON.stringify(i)).trigger("change")},_textFieldAddValueSelectChange:function(){var e=b(this),t=b('input[name="'+e.data("target")+'"]',window.parent.document),i=t.val(),l=e.val();-1==i.indexOf(l)&&(i=(i.trim()+" "+l.trim()).trim(),t.val(i).trigger("change").trigger("keyup")),e.val("")},_onNumberFieldFocus:function(e){var t=b(e.currentTarget);t.addClass("mousetrap"),Mousetrap.bind("up",function(){t.attr("step",1)}),Mousetrap.bind("down",function(){t.attr("step",1)}),Mousetrap.bind("shift+up",function(){t.attr("step",10)}),Mousetrap.bind("shift+down",function(){t.attr("step",10)})},_onNumberFieldBlur:function(e){b(e.currentTarget).attr("step","any").removeClass("mousetrap")},_initTimezoneFields:function(){b(".fl-builder-settings:visible .fl-field[data-type=timezone]",window.parent.document).each(FLBuilder._initTimezoneField)},_initTimezoneField:function(){var e=b(this).find("select"),t=e.attr("data-value");e.find('option[value="'+t+'"]').prop("selected",!0)},_initDimensionFields:function(){var e=b(".fl-builder-settings:visible",window.parent.document);e.find(".fl-field[data-type=dimension]").each(FLBuilder._initDimensionField),e.find(".fl-dimension-field-link").on("click",FLBuilder._dimensionFieldLinkClicked),FLBuilder.addHook("responsive-editing-switched",this._initResponsiveDimensionFieldLinking),e.find(".fl-compound-field-setting").has(".fl-dimension-field-link").each(FLBuilder._initDimensionFieldLinking)},_initDimensionField:function(){var e=b(this),t=e.find(".fl-field-label label"),e=e.find(".fl-field-control-wrapper"),i='<i class="fl-dimension-field-link fl-tip dashicons dashicons-admin-links" title="Link Values"></i>';t.append(i),e.prepend(i),FLBuilder._initTipTips(),FLBuilder._initDimensionFieldLinking.apply(this)},_initDimensionFieldLinking:function(){var e=b(this),t=e.find(".fl-dimension-field-link"),e=FLBuilder._getDimensionFieldLinkingInputs(e);FLBuilder._dimensionFieldInputsAreEqual(e)?(t.removeClass("dashicons-admin-links"),t.addClass("dashicons-editor-unlink"),e.off("input",FLBuilder._dimensionFieldLinkedValueChange),e.on("input",FLBuilder._dimensionFieldLinkedValueChange)):(t.addClass("dashicons-admin-links"),t.removeClass("dashicons-editor-unlink"))},_initResponsiveDimensionFieldLinking:function(){b(".fl-builder-settings:visible",window.parent.document).find(".fl-field[data-type=dimension]").each(FLBuilder._initDimensionFieldLinking)},_dimensionFieldLinkClicked:function(){var e=b(this),t=e.closest(".fl-compound-field-setting"),t=t.length?t:e.closest(".fl-field"),e=t.find(".fl-dimension-field-link"),i=e.hasClass("dashicons-editor-unlink"),t=FLBuilder._getDimensionFieldLinkingInputs(t);e.toggleClass("dashicons-admin-links"),e.toggleClass("dashicons-editor-unlink"),i?t.off("input",FLBuilder._dimensionFieldLinkedValueChange):(t.val(t.eq(0).val()).trigger("input"),t.on("input",FLBuilder._dimensionFieldLinkedValueChange))},_dimensionFieldLinkedValueChange:function(){var e=b(this),t=e.attr("name"),t=e.closest(".fl-dimension-field-units").find('input:not([name="'+t+'"])');t.off("input",FLBuilder._dimensionFieldLinkedValueChange),t.val(e.val()).trigger("input"),t.on("input",FLBuilder._dimensionFieldLinkedValueChange)},_getDimensionFieldLinkingInputs:function(e){var t=!!e.find(".fl-field-responsive-setting").length,i=FLBuilderResponsiveEditing._mode;return t?e.find(".fl-field-responsive-setting-"+i+" input"):e.find(".fl-dimension-field-unit input")},_dimensionFieldInputsAreEqual:function(e){var t=e.eq(0).val();if(""===t)return!1;for(var i=1;i<4;i++)if(e.eq(i).val()!==t)return!1;return!0},_initFieldPopupSliders:function(){b(".fl-builder-settings:visible",window.parent.document).find(".fl-field-popup-slider").each(FLBuilder._initFieldPopupSlider)},_initFieldPopupSlider:function(){var o=b("body",window.parent.document),s=b(this),r=s.find(".fl-field-popup-slider-input"),d=s.find(".fl-field-popup-slider-arrow"),e=s.data("input"),a=b('input[name="'+e+'"]',window.parent.document);a.on("click",function(){r.hasClass("fl-field-popup-slider-init")||(r.slider({value:a.val(),slide:function(e,t){a.val(t.value).trigger("input")}}),a.on("input",function(){r.slider("value",b(this).val())}),r.addClass("fl-field-popup-slider-init"),r.find(".ui-slider-handle").removeAttr("tabindex")),FLBuilder._setFieldPopupSliderMinMax(r),FLBuilder._hideFieldPopupSliders(),o.on("mousedown",FLBuilder._hideFieldPopupSliders),a.addClass("fl-field-popup-slider-focus"),s.show();var e=b(".fl-builder-settings:visible .fl-builder-settings-tab.fl-active",window.parent.document),t=e.offset(),i=a.offset(),l=a.width(),n=s.offset();n.top+s.outerHeight()>t.top+e.outerHeight()&&s.addClass("fl-field-popup-slider-top"),d.css("left",2+i.left-n.left+l/2+"px")}),a.on("focus",function(){FLBuilder._hideFieldPopupSliders()})},_hideFieldPopupSliders:function(e){var e=e?b(e.target):null,t=b("body",window.parent.document),i=b(".fl-field-popup-slider:visible",window.parent.document),l=b(".fl-field-popup-slider-focus",window.parent.document);if(e){if(e.closest(".fl-field-popup-slider").length)return;if(e.closest(".fl-field-popup-slider-focus").length)return}t.off("mousedown",FLBuilder._hideFieldPopupSliders),l.removeClass("fl-field-popup-slider-focus"),i.hide()},_setFieldPopupSliderMinMax:function(e){var t=e.parent(),i=t.parent().parent().find("select.fl-field-unit-select"),l=i.val(),t=t.data("slider"),n=0,o=100,s=1;""!==l&&"em"!==l&&"rem"!==l||(o=10,s=.1),"object"==typeof t&&(n=t.min?parseFloat(t.min):n,o=t.max?parseFloat(t.max):o,s=t.step?parseFloat(t.step):s,i.length)&&t[l]&&(n=t[l].min?parseFloat(t[l].min):n,o=t[l].max?parseFloat(t[l].max):o,s=t[l].step?parseFloat(t[l].step):s),e.slider({min:n,max:o,step:s})},_initPresetFields:function(){b(".fl-builder-settings:visible",window.parent.document).find(".fl-preset-select-controls").each(FLBuilder._initPresetField)},_initPresetField:function(){var e=b(this),t=e.find("select"),i=e.data("presets"),e=e.data("prefix");t.on("change",FLBuilder._setFormPreset.bind(this,i,e))},_setFormPreset:function(e,t,i){var l=b(i.currentTarget).val();if(presetLists=FLBuilderConfig.presets,presets=presetLists[e],form=b(".fl-builder-settings:visible",window.parent.document),"undefined"!==presets&&"undefined"!==presets[l]){var n,o=presets[l].settings;for(n in o){var l=o[n],s=void 0!==t&&""!==t?form.find('[name="'+t+n+'"]'):form.find('[name="'+n+'"]');s.val(l).trigger("change").trigger("input")}}},ajax:function(e,i){if(!FLBuilder._ajaxRequest){for(var t in FLBuilder.triggerHook("didBeginAJAX",e),e)void 0===e[t]&&(e[t]=null);return(e._wpnonce=FLBuilderConfig.ajaxNonce,e.post_id=FLBuilderConfig.postId,e.fl_builder=1,e.safemode=FLBuilderConfig.safemode,e.fl_action=e.action,void 0!==e.settings&&(e.settings=FLBuilder._ajaxModSecFix(b.extend(!0,{},e.settings)),e.settings=FLBuilder._inputVarsCheck(e.settings)),void 0!==e.node_settings&&(e.node_settings=FLBuilder._ajaxModSecFix(b.extend(!0,{},e.node_settings)),e.node_settings=FLBuilder._inputVarsCheck(e.node_settings)),void 0!==e.node_preview&&(e.node_preview=FLBuilder._ajaxModSecFix(b.extend(!0,{},e.node_preview)),e.node_preview=FLBuilder._inputVarsCheck(e.node_preview)),"error"===e.settings||"error"===e.node_settings||"error"===e.node_preview)?0:(e={fl_builder_data:e},FLBuilder._ajaxRequest=b.post(FLBuilder._ajaxUrl(),e,function(t){try{debugdata=b.parseJSON(t)||!1}catch(e){debugdata=t}debugdata&&void 0!==debugdata.mem_usage&&console.log("AJAX: "+debugdata.mem_usage),void 0!==i&&i.call(this,t),FLBuilder.triggerHook("didCompleteAJAX",e)}).always(FLBuilder._ajaxComplete).fail(function(e,t,i){switch(msg=!1,e.status){case 403:case 409:case 418:msg="Something you entered has triggered a "+e.status+" error.<br /><br />This is nearly always due to mod_security settings from your hosting provider.",window.crash_vars.white_label||(msg+='<br /><br />See this <a target="_blank" style="color: #428bca;font-size:inherit" href="https://docs.wpbeaverbuilder.com/beaver-builder/troubleshooting/common-issues/403-forbidden-or-blocked-error">Knowledge Base</a> article for more info.</br />')}msg&&(console.log(e),console.log(i),FLBuilder.alert(msg))}),FLBuilder._ajaxRequest)}FLBuilder._ajaxQueue.push({data:e,callback:i})},_inputVarsCheck:function(e){var t=FLBuilderConfig.MaxInputVars||0,i=FLBuilderConfig.debug||!1,l=(JSON.stringify(e).match(/[^\\]":/g)||{}).length;return void 0!==l&&(i&&console.log("Debug: Input Vars "+l+"/"+t),t<l)?(FLBuilder.alert('<h1 style="font-size:2em;text-align:center">Critical Issue</h1><br />The number of settings being saved ('+l+") exceeds the PHP Max Input Vars setting ("+t+").<br />Please contact your host to have this value increased, the default is 1000."),console.log("Vars Count: "+l),console.log("Max Input: "+t),"error"):e},_ajaxComplete:function(){var e;FLBuilder._ajaxRequest=null,FLBuilder.hideAjaxLoader(),FLBuilder._ajaxQueue.length&&(e=FLBuilder._ajaxQueue.shift(),FLBuilder.ajax(e.data,e.callback))},_ajaxUrl:function(e){var t=FLBuilderConfig.shortlink,i=null;if(void 0!==e)for(i in e)t=(t+=-1<t.indexOf("?")?"&":"?")+i+"="+e[i];return t},showAjaxLoader:function(){0===b(".fl-builder-lightbox-loading",window.parent.document).length&&b(".fl-builder-loading",window.parent.document).show()},hideAjaxLoader:function(){b(".fl-builder-loading",window.parent.document).hide()},_showNodeLoading:function(e){e=b(".fl-node-"+e);e.addClass("fl-builder-node-loading"),FLBuilder.triggerHook("didStartNodeLoading",e)},_hideNodeLoading:function(e){b(".fl-node-"+e).removeClass("fl-builder-node-loading")},_showNodeLoadingPlaceholder:function(e,t){var i=b('<div class="fl-builder-node-loading-placeholder"></div>');b(".fl-builder-node-loading-placeholder").remove(),0===(siblings=e.hasClass("fl-builder-content")?e.find(" > .fl-row, > .fl-module"):!e.hasClass("fl-row-content")&&e.hasClass("fl-col-group")?(e.addClass("fl-col-group-has-child-loading"),e.find(" > .fl-col")):e.find(" > .fl-col-group, > .fl-module")).length||siblings.length==t?e.append(i):siblings.eq(t).before(i)},_removeNodeLoadingPlaceholder:function(e){var t=e.prev(".fl-builder-node-loading-placeholder"),e=e.next(".fl-builder-node-loading-placeholder");(t.length?t:e).remove()},_ajaxModSecFix:function(e){if(FLBuilderConfig.modSecFix&&"undefined"!=typeof btoa)if("string"==typeof e)e=FLBuilder._btoa(e);else for(var t in e)"string"==(type=typeof e[t])||"number"==type?e[t]=FLBuilder._btoa(e[t]):"object"==type&&(e[t]=FLBuilder._ajaxModSecFix(e[t]));return e},_btoa:function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))},_wpmedia_reset_errors:function(){b(".upload-error",window.parent.document).remove(),b(".media-uploader-status",window.parent.document).removeClass("errors").hide()},_initLightboxes:function(){FLBuilder._lightbox=new FLLightbox({className:"fl-builder-lightbox fl-builder-settings-lightbox",resizable:!0}),FLBuilder._lightbox.on("resized",FLBuilder._calculateSettingsTabsOverflow),FLBuilder._lightbox.on("close",FLBuilder._lightboxClosed),FLBuilder._lightbox.on("beforeCloseLightbox",FLBuilder._destroyEditorFields),FLBuilder._actionsLightbox=new FLLightbox({className:"fl-builder-actions-lightbox"})},_showLightbox:function(e){e=e||'<div class="fl-builder-lightbox-loading"></div>',FLBuilder._lightbox.open(e),FLBuilder._initLightboxScrollbars()},_setLightboxContent:function(e){FLBuilder._lightbox.setContent(e)},_initLightboxScrollbars:function(){FLBuilder._initScrollbars(),clearTimeout(FLBuilder._lightboxScrollbarTimeout),FLBuilder._lightboxScrollbarTimeout=setTimeout(FLBuilder._initLightboxScrollbars,500)},_lightboxClosed:function(){FL.Builder.data.getOutlinePanelActions().setActiveNode(!1),FLBuilder.triggerHook("settings-lightbox-closed"),FLBuilder._lightbox.empty(),clearTimeout(FLBuilder._lightboxScrollbarTimeout),FLBuilder._lightboxScrollbarTimeout=null},_showActionsLightbox:function(e){var t=wp.template("fl-actions-lightbox");FLBuilder.triggerHook("actions-lightbox-settings",e),FLBuilder._actionsLightbox.open(t(e))},_checkEnv:function(){"svg"===FLBuilderConfig.fontAwesome&&FLBuilder.alert(FLBuilderStrings.fontAwesome)},alert:function(e){var t=new FLLightbox({className:"fl-builder-alert-lightbox",destroyOnClose:!0}),i=wp.template("fl-alert-lightbox");t.open(i({message:e}))},crashMessage:function(e){FLLightbox.closeAll();var t=new FLLightbox({className:"fl-builder-alert-lightbox fl-builder-crash-lightbox",destroyOnClose:!0}),i=wp.template("fl-crash-lightbox"),l=window.crash_vars.product,n=window.crash_vars.white_label,o=window.crash_vars.labeled_txt,s="";message=l+" "+window.crash_vars.strings.intro,s=(s=(s=(s=(s=(s=(s+="<h3 style='font-size:26px;line-height:26px;'>"+window.crash_vars.strings.try+"</h3>")+"<p>"+window.crash_vars.strings.troubleshoot+"</p>")+"<h3 style='font-size:22px;line-height:22px;padding-top:20px;border-top:1px solid black;'>"+window.crash_vars.strings.hand+"</h3>")+"<h3 style='font-size:18px;line-height:18px;'>"+window.crash_vars.strings.step_one+"</h3>")+"<p>"+window.crash_vars.strings.if_contact+"</p><div><div style='width:49%;float:left;'><p>MacOS Users:<br />Chrome: View > Developer > JavaScript Console<br />Firefox: Tools > Web Developer > Browser Console<br />Safari: Develop > Show JavaScript console</p></div><div style='width:49%;float:right;'><p>Windows Users:<br />Chrome: Settings > More Tools > Developer > Console<br />Firefox: Menu/Settings > Web Developer > Web Console<br />Edge: Settings and More > More Tools > Console</p></div></div>")+"<h3 style='font-size:18px;line-height:18px;display:inline-block'>"+window.crash_vars.strings.step_two+"</h3>")+"<p style='display:inline-block;'>"+window.crash_vars.strings.contact+"</p>",FLBuilderConfig.MaxInputVars<=3e3&&(s+="<br /><br />The PHP config value max_input_vars is only set to "+FLBuilderConfig.MaxInputVars+'. If you are using 3rd party addons this could very likely be the cause of this error. [<a class="link" href="https://docs.wpbeaverbuilder.com/beaver-builder/troubleshooting/common-issues/exceeds-php-max-input-vars">doc link</a>].'),n&&(s=o),t.open(i({message:message,info:s,debug:!1}))},_alertClose:function(){FLLightbox.closeParent(this)},confirm:function(e){var t={cssClass:"",message:"",ok:function(){},cancel:function(){},strings:{ok:FLBuilderStrings.ok,cancel:FLBuilderStrings.cancel}},t=b.extend({},t,void 0===e?{}:e);lightbox=new FLLightbox({className:"fl-builder-confirm-lightbox fl-builder-alert-lightbox"+t.cssClass,destroyOnClose:!0}),template=wp.template("fl-confirm-lightbox"),lightbox.open(template(t)),lightbox._node.find(".fl-builder-confirm-ok").on("click",t.ok),lightbox._node.find(".fl-builder-confirm-cancel").on("click",t.cancel)},log:function(e){void 0!==window.console&&void 0!==window.console.log&&console.log(e)},logError:function(e,t){var i=null;void 0!==e&&(void 0!==e.stack?i=e.stack:void 0!==e.message&&(i=e.message),i)&&(FLBuilder.log("************************************************************************"),FLBuilder.log(FLBuilderStrings.errorMessage),FLBuilder.log(i),void 0!==t&&t&&(FLBuilder.log("Debug Info"),console.log(t)),b.each(window.crash_vars.vars,function(e,t){console.log(e+": "+t)}),FLBuilder.log("************************************************************************"),void 0!==t&&t&&(i=t+"\n"+i),FLBuilder.crashMessage(i))},logGlobalError:function(e,t,i,l,n){FLBuilder.log("************************************************************************"),FLBuilder.log(FLBuilderStrings.errorMessage),FLBuilder.log(FLBuilderStrings.globalErrorMessage.replace("{message}",e).replace("{line}",i).replace("{file}",t)),void 0!==n&&void 0!==n.stack&&FLBuilder.log(n.stack),FLBuilder.log("************************************************************************")},_jsonParse:function(t){"string"!=typeof t&&(t=JSON.stringify(t));try{t=JSON.parse(t)}catch(e){if(0<t.indexOf("</b> on line ")||0<t.indexOf(" in <b>"))return type="Unknown",regex=new RegExp("<b>(Notice|Warning|Fatal error)</b>:(.*) in <b>","m"),error=regex.exec(t),FLBuilder.isUndefined(error[1])||(type=error[1]),error=FLBuilder.isUndefined(error[2])?"Unknown PHP error":error[2],msg=!(0<t.indexOf("Fatal error"))||(regex=new RegExp("<b>Fatal error<\\/b>:\\s+Allowed\\smemory\\ssize of\\s([0-9]+)","gm"),m=regex.exec(t),FLBuilder.isUndefined(m[1]))?(msg='<p style="font-weight:bold;text-align:center;"><strong>PHP '+type+" detected in AJAX response</strong></p>",(msg+="<p>"+error+"</p>")+"<p>"+window.crash_vars.strings.fatal.footer+"</p>"):(ram=m[1]/1024/1024,msg='<p style="font-weight:bold;text-align:center;"><strong>PHP '+type+" detected in AJAX response</strong></p>",(msg+="<p>"+window.crash_vars.strings.fatal.content.replace("[MEM]",ram)+"</p>")+"<p>"+window.crash_vars.strings.fatal.footer+"</p>"),FLLightbox.closeAll(),FLBuilder.alert(msg),!1;FLBuilder.logError(e,FLBuilder._parseError(t))}return t},_parseError:function(e){var i;return e.indexOf("</head>")?"AJAX returned HTML page instead of data. (Possible 404 or max_input_vars)":!!((php=e.match(/^<.*/gm)||!1)&&0<php.length)&&(i="",b.each(php,function(e,t){i+=t}),b(i).text())},getSandbox:function(e){return e in this._sandbox&&this._sandbox[e]},setSandbox:function(e,t){this._sandbox[e]=t},deleteSandbox:function(e){delete this._sandbox[e]}},FLBuilder=new Proxy(FLBuilder,{deprecated:{isBlockEditor:FL.Builder.utils.isBlockEditor,isBoolean:FL.Builder.utils.isBoolean,isUndefined:FL.Builder.utils.isUndefined,addHook:FL.Builder.utils.hooks.add,removeHook:FL.Builder.utils.hooks.remove,triggerHook:FL.Builder.utils.hooks.trigger,_initColorScheme:FL.Builder.utils.colorScheme.init,_isSystemColorSchemeDark:FL.Builder.utils.colorScheme.isSystemDark,_getComputedColorScheme:FL.Builder.utils.colorScheme.getComputedColorScheme,_systemColorSchemeChanged:FL.Builder.utils.colorScheme.systemColorSchemeChanged,_setColorSchemeBodyClasses:FL.Builder.utils.colorScheme.setBodyClasses,_focusFirstSettingsControl:FL.Builder.settingsForms.focusFirstSettingsControl},get(e,t,i){return t in this.deprecated?this.deprecated[t]:Reflect.get(...arguments)}}),b(function(){FLBuilder._init()})}(jQuery),!function(o){(FLBuilderAJAXLayout=function(e,t){this._data=o.extend({},this._defaults,"string"==typeof e?FLBuilder._jsonParse(e):e),this._callback=t,this._post=FLBuilderConfig.postId,this._head=o("head").eq(0),this._body=o("body").eq(0),this._data.css&&("inline"===FLBuilderConfig.enqueueMethod?(this._oldCss=o("#fl-builder-layout-"+this._post+"-inline-css"),this._newCss=o('<style id="fl-builder-layout-'+this._post+'-inline-css" type="text/css">'+this._data.css+"</style>")):(this._loader=o('<img src="'+this._data.css+'" />'),this._oldCss=o('link[href*="/cache/'+this._post+'-layout"]'),this._newCss=o('<link rel="stylesheet" id="fl-builder-layout-'+this._post+'-css"  href="'+this._data.css+'" />'))),this._data.partial?(this._data.js&&(this._oldJs=o("#fl-builder-partial-refresh-js"),this._newJs=o('<script type="text/javascript" id="fl-builder-partial-refresh-js">'+this._data.js+"<\/script>")),this._data.nodeId&&(this._data.oldNodeId?(this._oldScriptsStyles=o('.fl-builder-node-scripts-styles[data-node="'+this._data.oldNodeId+'"]'),this._content=o(".fl-node-"+this._data.oldNodeId)):(this._oldScriptsStyles=o('.fl-builder-node-scripts-styles[data-node="'+this._data.nodeId+'"]'),this._content=o(".fl-node-"+this._data.nodeId)))):("inline"===FLBuilderConfig.enqueueMethod?(this._oldJs=o("#fl-builder-layout-"+this._post+"-inline-js"),this._newJs=o('<script id="fl-builder-layout-'+this._post+'-inline-js">'+this._data.js+"<\/script>")):(this._oldJs=o('script[src*="/cache/'+this._post+'"]'),this._newJs=o('<script src="'+this._data.js+'"><\/script>')),this._oldScriptsStyles=o(".fl-builder-layout-scripts-styles"),this._content=o(FLBuilder._contentClass)),this._init()}).prototype={_defaults:{partial:!1,nodeId:null,nodeType:null,nodeParent:null,nodePosition:null,oldNodeId:null,html:null,scriptsStyles:null,css:null,js:null},_data:null,_callback:function(){},_post:null,_head:null,_body:null,_loader:null,_oldCss:null,_newCss:null,_oldJs:null,_newJs:null,_oldScriptsStyles:null,_content:null,_init:function(){this._body.height(this._body.height()),this._data.css?"inline"===FLBuilderConfig.enqueueMethod?(this._addNewCSS(),this._finish()):"onload"in document.createElement("link")?(this._newCss.on("load",o.proxy(this._finish,this)),this._addNewCSS()):(this._loader.on("error",o.proxy(this._loadNewCSSFallbackComplete,this)),this._body.append(this._loader)):this._finish()},_loadNewCSSFallbackComplete:function(){this._loader.remove(),this._addNewCSS(),setTimeout(o.proxy(this._finish,this),250)},_addNewCSS:function(){0<this._oldCss.length?this._oldCss.after(this._newCss):this._head.append(this._newCss)},_finish:function(){this._removeOldContentAndAssets(),this._cleanNewHTML(),this._cleanNewAssets(),this._addNewHTML(),this._addNewScriptsStyles(),this._addNewJS(),o(FLBuilder._contentClass).trigger("fl-builder.layout-rendered"),FLBuilder.hideAjaxLoader()},_removeOldContentAndAssets:function(){this._content&&this._content.empty(),this._oldCss&&this._oldCss.remove(),this._oldJs&&this._oldJs.remove(),this._oldScriptsStyles&&this._oldScriptsStyles.remove()},_cleanNewHTML:function(){var e,t,i,l;this._data.scriptsStyles&&(e=o("<div>"+this._data.html+"</div>"),t=["fl-row","fl-module"],i=this._data.scriptsStyles,l="",this._data.partial&&(t="column-group"==this._data.nodeType?["fl-col-group"]:"column"==this._data.nodeType?["fl-col"]:[this._data.nodeType?"fl-"+this._data.nodeType:"fl-row"]),e.find("> *, script").each(function(){let e=!1;for(c of t)o(this).hasClass(c)&&(e=!0);e||"application/json"==o(this).attr("type")||(l=o(this).remove(),i+=l[0].outerHTML)}),""!==i&&(i=this._data.partial?'<div class="fl-builder-node-scripts-styles" data-node="'+this._data.nodeId+'">'+i+"<div>":'<div class="fl-builder-node-scripts-styles">'+i+"<div>"),this._data.html=e.html(),this._data.scriptsStyles=i)},_addNewHTML:function(){var e;this._data.partial?this._data.nodeParent?(0===(e=this._data.nodeParent.hasClass("fl-builder-content")?this._data.nodeParent.find(" > .fl-row, > .fl-module"):!this._data.nodeParent.hasClass("fl-row-content")&&this._data.nodeParent.hasClass("fl-col-group")?this._data.nodeParent.find(" > .fl-col"):this._data.nodeParent.find(" > .fl-col-group, > .fl-module")).length||this._data.nodePosition>=e.length?this._data.nodeParent.append(this._data.html):e.eq(this._data.nodePosition).before(this._data.html),this._data.nodeId&&FLBuilder._removeNodeLoadingPlaceholder(o(".fl-node-"+this._data.nodeId))):(this._content.after(this._data.html),this._content.remove()):this._content.append(this._data.html),FLBuilder.preview&&this._data.nodeId&&this._data.nodeId!=FLBuilder.preview.nodeId&&(e=o(FLBuilder.preview.classes.node)).closest(".fl-node-"+this._data.nodeId).length&&1===e.length&&e.html(FLBuilder.preview.elements.node.html()),this._data.onAddNewHTML&&this._data.onAddNewHTML()},_cleanNewAssets:function(){var e=this;this._data.html=this._removeDuplicateAssets(this._data.html),this._data.scriptsStyles&&""!==this._data.scriptsStyles&&(this._data.scriptsStyles=this._removeDuplicateAssets(this._data.scriptsStyles)),this._data.partial?o(".fl-builder-node-scripts-styles").each(function(){-1<e._data.html.indexOf("fl-node-"+o(this).data("node"))&&o(this).remove()}):(o("#fl-builder-partial-refresh-js").remove(),o(".fl-builder-node-scripts-styles").remove())},_removeDuplicateAssets:function(e){var e=o("<div>"+e+"</div>"),t="",i="",l=window.location,n=l.protocol+"//"+l.hostname+(l.port?":"+l.port:"");return e.find("script").each(function(){void 0!==(t=o(this).attr("src"))&&(t=t.replace(n,""),0<o('script[src*="'+t+'"]').length)&&o(this).remove()}),e.find("link").each(function(){void 0!==(i=o(this).attr("href"))&&(i=i.replace(n,""),0<o('link[href*="'+i+'"]').length)&&o(this).remove()}),e.html()},_addNewScriptsStyles:function(){this._data.scriptsStyles&&""!==this._data.scriptsStyles&&this._body.append(this._data.scriptsStyles)},_addNewJS:function(){setTimeout(o.proxy(function(){this._newJs&&this._head.append(this._newJs),FLBuilder.triggerHook("didRenderLayoutJSComplete")},this),50)},_complete:function(){FLBuilder._dragging?(FLBuilder._highlightRowsAndColsForDrag(),FLBuilder._refreshSortables()):(FLBuilder._setupEmptyLayout(),FLBuilder._initDropTargets(),FLBuilder._initSortables(),FLBuilder._highlightEmptyCols(),FLBuilder._resizeLayout()),FLBuilder._initMediaElements(),FLBuilderLayout.init(),FLBuilderResponsiveEditing.refreshPreview(this._callback),FLBuilder.triggerHook("didRenderLayoutComplete"),this._body.height("auto")}}}(jQuery),!function(p){(FLBuilderPreview=function(e){this.id=(new Date).getTime(),this.type=e.type,this.layoutDoc=FLBuilderPreview.getLayoutDoc(),this._saveState(),e.layout?FLBuilder._renderLayout(e.layout,function(){this._init(),e.callback&&e.callback()}.bind(this)):this._init()})._fontsList={},FLBuilderPreview.getFormattedSelector=function(e,t=""){for(var i="",l=t.split(/,(?![^()]*\))/),n=0;n<l.length;n++)-1<l[n].indexOf("{node}")?i+=l[n].replace("{node}",e):-1<l[n].indexOf("{node_id}")?i+=l[n].replace(/{node_id}/g,this.nodeId):i+=e+" "+l[n],n!=l.length-1&&(i+=", ");return i},FLBuilderPreview.getLayoutDoc=()=>{var e;return FLBuilder.isBlockEditor()&&(e=document.querySelector('[name="editor-canvas"]'))?e.contentDocument:document},FLBuilderPreview.prototype={id:"",type:"",nodeId:null,classes:{},elements:{},state:null,layoutDoc:null,_savedSettings:null,_styleSheet:null,_styleSheetLarge:null,_styleSheetMedium:null,_styleSheetResponsive:null,_timeout:null,_loaderTimeout:null,_lastClassName:null,_xhr:null,_init:function(){this.nodeId=p("form.fl-builder-settings:visible",window.parent.document).data("node"),this._saveSettings(),this._initElementsAndClasses(),this._createSheets(),this._bindEvents()},_bindEvents(){switch(this._initResponsivePreviews(),this._initDefaultFieldPreviews(),this.type){case"row":this._initRow();break;case"col":this._initColumn();break;case"module":case"form":this._initModule()}FLBuilder.triggerHook("preview-init",this)},_saveSettings:function(){var e=p(".fl-builder-settings-lightbox .fl-builder-settings",window.parent.document);this._savedSettings=FLBuilder._getSettingsForChangedCheck(this.nodeId,e)},_settingsHaveChanged:function(){var e=p(".fl-builder-settings-lightbox .fl-builder-settings",window.parent.document),e=FLBuilder._getSettings(e);return JSON.stringify(this._savedSettings)!=JSON.stringify(e)},_initElementsAndClasses:function(){var e="row"==this.type?".fl-row-content-wrap":".fl-"+this.type+"-content",t=".fl-builder-settings-lightbox:visible form.fl-builder-settings";p.extend(this.classes,{settings:t,settingsHeader:t+" .fl-lightbox-header",node:FLBuilder._contentClass+" .fl-node-"+this.nodeId,content:FLBuilder._contentClass+" .fl-node-"+this.nodeId+" > "+e}),p.extend(this.elements,{settings:p(this.classes.settings,window.parent.document),settingsHeader:p(this.classes.settingsHeader,window.parent.document),node:p(this.classes.node,this.layoutDoc),content:p(this.classes.content,this.layoutDoc)})},_createSheets:function(){FLBuilder.isBlockEditor()||(this._destroySheets(),this._styleSheet||(this._styleSheet=new FLStyleSheet({id:"fl-builder-preview",className:"fl-builder-preview-style"})),this._styleSheetLarge||(this._styleSheetLarge=new FLStyleSheet({id:"fl-builder-preview-large",className:"fl-builder-preview-style"}),this._styleSheetLarge.disable()),this._styleSheetMedium||(this._styleSheetMedium=new FLStyleSheet({id:"fl-builder-preview-medium",className:"fl-builder-preview-style"}),this._styleSheetMedium.disable()),this._styleSheetResponsive)||(this._styleSheetResponsive=new FLStyleSheet({id:"fl-builder-preview-responsive",className:"fl-builder-preview-style"}),this._styleSheetResponsive.disable())},_destroySheets:function(){this._styleSheet&&(this._styleSheet.destroy(),this._styleSheet=null),this._styleSheetLarge&&(this._styleSheetLarge.destroy(),this._styleSheetLarge=null),this._styleSheetMedium&&(this._styleSheetMedium.destroy(),this._styleSheetMedium=null),this._styleSheetResponsive&&(this._styleSheetResponsive.destroy(),this._styleSheetResponsive=null),p(".fl-builder-preview-style").remove()},_disableStyles:function(){var e=FLBuilderResponsiveEditing._mode,t=FLBuilderConfig.global,i=this.elements.node;"responsive"===e&&this._styleSheetResponsive?(window?.FLBuilderSimulateMediaQuery?.disableStyles(t.responsive_breakpoint),this._styleSheetResponsive.disable()):"large"===e&&this._styleSheetLarge?(window?.FLBuilderSimulateMediaQuery?.disableStyles(t.large_breakpoint),this._styleSheetLarge.disable()):"medium"===e&&this._styleSheetMedium?(window?.FLBuilderSimulateMediaQuery?.disableStyles(t.medium_breakpoint),this._styleSheetMedium.disable()):i.removeClass(function(e,t){return(t.match(/fl-node-[^\s]*/g)||[]).join(" ")})},_enableStyles:function(){var e=FLBuilderResponsiveEditing._mode,t=this.elements.node;"responsive"===e&&this._styleSheetResponsive?(window?.FLBuilderSimulateMediaQuery?.enableStyles(),this._styleSheetResponsive.enable()):"medium"===e&&this._styleSheetMedium?(window?.FLBuilderSimulateMediaQuery?.enableStyles(),this._styleSheetMedium.enable()):"large"===e&&this._styleSheetLarge?(window?.FLBuilderSimulateMediaQuery?.enableStyles(),this._styleSheetLarge.enable()):t.addClass("fl-node-"+t.data("node"))},_getDefaultValue:function(e,t){var i="",e=p(e,this.layoutDoc),l=e.closest("[data-node]");return"width"===t?i="auto":-1===p.inArray(t,["color","background-color","border-color","line-height","font-weight"])&&l.length&&(this._disableStyles(),i=e.css(t),this._enableStyles()),i},updateCSSRule:function(e,t,i,l){var n=FLBuilderResponsiveEditing._mode,o="";""!==i&&"null"!==i||(i=this._getDefaultValue(e,t)),FLBuilder.isBlockEditor()?FLBuilder.triggerHook("updateCSSRule",[e,t,i,l]):(l?(o="string"==typeof l?this.toUpperCaseWords(l):"default"===n?"":this.toUpperCaseWords(n),this["_styleSheet"+o]):this._styleSheet).updateRule(e,t,i)},delay:function(e,t){this._cancelDelay(),this._timeout=setTimeout(t,e)},_cancelDelay:function(){null!==this._timeout&&clearTimeout(this._timeout),null!==this._loaderTimeout&&clearTimeout(this._loaderTimeout)},hexToRgb:function(e){e=parseInt(e,16);return[e>>16&255,e>>8&255,255&e]},hexOrRgb:function(e){return e=e.indexOf("rgb")<0&&e.indexOf("#")<0?"#"+e:e},parseFloat:function(e){return isNaN(parseFloat(e))?0:parseFloat(e)},_initResponsivePreviews:function(){var e=".preview-"+this.id;FLBuilder.addHook("responsive-editing-switched"+e,p.proxy(this._responsiveEditingSwitched,this)),FLBuilder.addHook("responsive-editing-before-preview-fields"+e,p.proxy(this._responsiveEditingPreviewFields,this))},_destroyResponsivePreviews:function(){var e=".preview-"+this.id;FLBuilder.removeHook("responsive-editing-switched"+e),FLBuilder.removeHook("responsive-editing-before-preview-fields"+e)},_responsiveEditingSwitched:function(e,t){"default"==t?(this._styleSheetLarge.disable(),this._styleSheetMedium.disable(),this._styleSheetResponsive.disable()):"large"==t?(this._styleSheetLarge.enable(),this._styleSheetMedium.disable(),this._styleSheetResponsive.disable()):"medium"==t?(this._styleSheetLarge.enable(),this._styleSheetMedium.enable(),this._styleSheetResponsive.disable()):"responsive"==t&&(this._styleSheetLarge.enable(),this._styleSheetMedium.enable(),this._styleSheetResponsive.enable())},_responsiveEditingPreviewFields:function(e,t){"large"!==t&&"medium"!==t||"col"===this.type&&this.elements.node[0].style.width&&(size=parseFloat(this.elements.node[0].style.width),this.elements.size.val(size))},updateResponsiveCSSRule:function(e,t,i){this.updateCSSRule(e,t,i,!0)},_saveState:function(){var e=FLBuilderConfig.postId,t=p('link[href*="/cache/'+e+'"]').attr("href"),e=p('script[src*="/cache/'+e+'"]').attr("src"),i=p(FLBuilder._contentClass).html();this.state={css:t,js:e,html:i}},preview:function(){var e=p(".fl-builder-settings-lightbox .fl-builder-settings",window.parent.document),t=e.attr("data-node"),e=FLBuilder._getSettings(e);if(this._cancelPreview(),"error"===(e=FLBuilder._inputVarsCheck(e)))return 0;FLBuilder.isBlockEditor()?(FLBuilder.triggerHook("requestPreview",e),this._renderPreviewComplete()):(FLBuilder._showNodeLoading(t),this._xhr=FLBuilder.ajax({action:"render_layout",node_id:this._getNodeIdForPreview(t),node_preview_id:t,node_preview:e},p.proxy(this._renderPreview,this)))},_getNodeIdForPreview:function(e){var t=p(".fl-node-"+e);return 1<t.length?(t=t.parents("[data-node]").eq(0).attr("data-node"),this._getNodeIdForPreview(t)):e},delayPreview:function(e){var t=void 0===e?[]:p(e.target).closest("tr").find("th"),i=p(".fl-builder-widget-settings .fl-builder-settings-title",window.parent.document),l=p(".fl-builder-settings .fl-lightbox-header",window.parent.document),e=FLBuilderLayoutConfig.paths.pluginUrl+"img/ajax-loader-small.svg",n=p('<img class="fl-builder-preview-loader" src="'+e+'" />');this.delay(1e3,p.proxy(this.preview,this)),this._loaderTimeout=setTimeout(function(){p(".fl-builder-preview-loader",window.parent.document).remove(),0<t.length?t.append(n):0<i.length?i.append(n):0<l.length&&l.append(n)},1500)},_cancelPreview:function(){this._xhr&&(this._xhr.abort(),this._xhr=null)},_renderPreview:function(e){this._xhr=null,FLBuilder._renderLayout(e,p.proxy(this._renderPreviewComplete,this))},_renderPreviewComplete:function(){this._createSheets(),this._initElementsAndClasses(),this._initDefaultFieldPreviews(),null!==this._loaderTimeout&&clearTimeout(this._loaderTimeout),setTimeout(function(){p(".fl-builder-preview-loader",window.parent.document).remove()},500),p(FLBuilder._contentClass,this.layoutDoc).trigger("fl-builder.preview-rendered")},revert:function(){var e=this.nodeId;this._settingsHaveChanged()?("col"===this.type&&(e=this.elements.node.closest(".fl-col-group").data("node")),FLBuilder._updateNode(e,function(){this.clear()}.bind(this))):this.clear()},cancel:function(){this._cancelDelay(),this._cancelPreview()},clear:function(){this.cancel(),this._destroySheets(),this._destroyResponsivePreviews()},_initNodeTextColor:function(){p.extend(this.elements,{textColor:p(this.classes.settings+" input[name=text_color]",window.parent.document),linkColor:p(this.classes.settings+" input[name=link_color]",window.parent.document),hoverColor:p(this.classes.settings+" input[name=hover_color]",window.parent.document),headingColor:p(this.classes.settings+" input[name=heading_color]",window.parent.document)}),this.elements.textColor.on("change",p.proxy(this._textColorChange,this)),this.elements.linkColor.on("change",p.proxy(this._textColorChange,this)),this.elements.hoverColor.on("change",p.proxy(this._textColorChange,this)),this.elements.headingColor.on("change",p.proxy(this._textColorChange,this))},_textColorChange:function(e){var t=this.elements.textColor.val(),i=this.elements.linkColor.val(),l=this.elements.hoverColor.val(),n=this.elements.headingColor.val(),i=""===i?t:i,l=""===l?t:l,n=""===n?t:n;t&&t.indexOf("rgb")<0&&(t="#"+t),i&&i.indexOf("rgb")<0&&(i="#"+i),l&&l.indexOf("rgb")<0&&(l="#"+l),n&&n.indexOf("rgb")<0&&(n="#"+n),this.delay(50,p.proxy(function(){""===t?this.updateCSSRule(this.classes.node,"color",""):this.updateCSSRule(this.classes.node,"color",t),""===i?this.updateCSSRule(this.classes.node+" a","color",""):this.updateCSSRule(this.classes.node+" a","color",i),""===l?this.updateCSSRule(this.classes.node+" a:hover","color",""):this.updateCSSRule(this.classes.node+" a:hover","color",l),""===n?(this.updateCSSRule(this.classes.node+" h1","color",""),this.updateCSSRule(this.classes.node+" h2","color",""),this.updateCSSRule(this.classes.node+" h3","color",""),this.updateCSSRule(this.classes.node+" h4","color",""),this.updateCSSRule(this.classes.node+" h5","color",""),this.updateCSSRule(this.classes.node+" h6","color",""),this.updateCSSRule(this.classes.node+" h1 a","color",""),this.updateCSSRule(this.classes.node+" h2 a","color",""),this.updateCSSRule(this.classes.node+" h3 a","color",""),this.updateCSSRule(this.classes.node+" h4 a","color",""),this.updateCSSRule(this.classes.node+" h5 a","color",""),this.updateCSSRule(this.classes.node+" h6 a","color","")):(this.updateCSSRule(this.classes.node+" h1","color",n),this.updateCSSRule(this.classes.node+" h2","color",n),this.updateCSSRule(this.classes.node+" h3","color",n),this.updateCSSRule(this.classes.node+" h4","color",n),this.updateCSSRule(this.classes.node+" h5","color",n),this.updateCSSRule(this.classes.node+" h6","color",n),this.updateCSSRule(this.classes.node+" h1 a","color",n),this.updateCSSRule(this.classes.node+" h2 a","color",n),this.updateCSSRule(this.classes.node+" h3 a","color",n),this.updateCSSRule(this.classes.node+" h4 a","color",n),this.updateCSSRule(this.classes.node+" h5 a","color",n),this.updateCSSRule(this.classes.node+" h6 a","color",n))},this))},_initNodeBg:function(){p.extend(this.elements,{bgType:p(this.classes.settings+" select[name=bg_type]",window.parent.document),bgColor:p(this.classes.settings+" input[name=bg_color]",window.parent.document),bgColorPicker:p(this.classes.settings+" .fl-picker-bg_color",window.parent.document),bgGradientType:p(this.classes.settings+" select.fl-gradient-picker-type-select",window.parent.document),bgVideoSource:p(this.classes.settings+" select[name=bg_video_source]",window.parent.document),bgVideo:p(this.classes.settings+" input[name=bg_video]",window.parent.document),bgVideoServiceUrl:p(this.classes.settings+" input[name=bg_video_service_url]",window.parent.document),bgVideoFallbackSrc:p(this.classes.settings+" select[name=bg_video_fallback_src]",window.parent.document),bgSlideshowSource:p(this.classes.settings+" select[name=ss_source]",window.parent.document),bgSlideshowPhotos:p(this.classes.settings+" input[name=ss_photos]",window.parent.document),bgSlideshowFeedUrl:p(this.classes.settings+" input[name=ss_feed_url]",window.parent.document),bgSlideshowSpeed:p(this.classes.settings+" input[name=ss_speed]",window.parent.document),bgSlideshowTrans:p(this.classes.settings+" select[name=ss_transition]",window.parent.document),bgSlideshowTransSpeed:p(this.classes.settings+" input[name=ss_transitionDuration]",window.parent.document),bgParallaxImageSrc:p(this.classes.settings+" select[name=bg_parallax_image_src]",window.parent.document),bgOverlayType:p(this.classes.settings+" select[name=bg_overlay_type]",window.parent.document),bgOverlayColor:p(this.classes.settings+" input[name=bg_overlay_color]",window.parent.document),bgOverlayGradient:p(this.classes.settings+" #fl-field-bg_overlay_gradient select",window.parent.document)}),this.elements.bgType.on("change",p.proxy(this._bgTypeChange,this)),this.elements.bgColor.on("change",p.proxy(this._bgColorChange,this)),this.elements.bgVideoServiceUrl.on("change",p.proxy(this._bgVideoChange,this)),this.elements.bgSlideshowSource.on("change",p.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowPhotos.on("change",p.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowFeedUrl.on("keyup",p.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowSpeed.on("keyup",p.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowTrans.on("change",p.proxy(this._bgSlideshowChange,this)),this.elements.bgSlideshowTransSpeed.on("keyup",p.proxy(this._bgSlideshowChange,this)),this.elements.bgParallaxImageSrc.on("change",p.proxy(this._bgParallaxChange,this)),this.elements.bgOverlayType.on("change",p.proxy(this._bgOverlayChange,this)),this.elements.bgOverlayColor.on("change",p.proxy(this._bgOverlayChange,this))},_bgTypeChange:function(e){var t=this.elements.bgType.val(),i=FLBuilderResponsiveEditing._mode;this.elements.node.removeClass("fl-row-bg-video"),this.elements.node.removeClass("fl-row-bg-slideshow"),this.elements.node.removeClass("fl-row-bg-parallax"),this.elements.node.find(".fl-bg-video").remove(),this.elements.node.find(".fl-bg-slideshow").remove(),this.elements.content.css("background-image",""),this.updateCSSRule(this.classes.content,"background-color","transparent"),this.updateCSSRule(this.classes.content,"background-image","none"),this.updateCSSRule(this.classes.content,"background-image","none","medium"),this.updateCSSRule(this.classes.content,"background-image","none","responsive"),"none"==t?this._bgOverlayClear():"color"==t?(this.elements.bgColor.trigger("change"),this._bgOverlayClear()):"gradient"==t?(this.elements.bgGradientType.trigger("change"),this._bgOverlayClear()):"photo"==t?(this.elements.bgColor.trigger("change"),this.elements.settings.find('[data-device="'+i+'"] select[name*="bg_"]').trigger("change")):"video"==t?(this.elements.bgColor.trigger("change"),this._bgVideoChange()):"slideshow"==t?(this.elements.bgColor.trigger("change"),this._bgSlideshowChange()):"parallax"==t&&(this.elements.bgColor.trigger("change"),this.elements.bgParallaxImageSrc.trigger("change"))},_bgColorChange:function(e){var t;""===this.elements.bgColor.val()?this.updateCSSRule(this.classes.content,"background-color","transparent"):(t=this.hexOrRgb(this.elements.bgColor.val()),this.delay(100,p.proxy(function(){this.updateCSSRule(this.classes.content,"background-color",t)},this)))},_bgVideoChange:function(e){var t=this.elements,i=t.bgVideoSource.val(),l=t.bgVideo.val(),t=t.bgVideoServiceUrl.val(),n=p("<script>");"video_service"==i&&""!=t?(/^(?:(?:(?:https?:)?\/\/)?(?:www.)?(?:youtu(?:be.com|.be))\/(?:watch\?v\=|v\/|embed\/)?([\w\-]+))/i.test(t)&&p('script[src*="youtube.com"',this.layoutDoc).length<1?n.attr("src","https://www.youtube.com/iframe_api"):/^(http\:\/\/|https\:\/\/)?(www\.)?(vimeo\.com\/)([0-9]+)$/.test(t)&&p('script[src*="vimeo.com"',this.layoutDoc).length<1&&n.attr("src","https://player.vimeo.com/api/player.js"),n.attr("type","text/javascript").appendTo("head"),this.delay(500,p.proxy(this.preview,this))):""!=l&&this.preview()},_bgSlideshowChange:function(e){var t=this.elements,i=t.bgSlideshowSource.val(),l=t.bgSlideshowPhotos.val(),n=t.bgSlideshowFeedUrl.val(),o=t.bgSlideshowSpeed.val(),t=t.bgSlideshowTransSpeed.val();"wordpress"==i&&""===l||"smugmug"==i&&""===n||isNaN(parseInt(o))||isNaN(parseInt(t))||this.delay(500,p.proxy(this.preview,this))},_bgParallaxChange:function(e){this.elements.bgParallaxImageSrc.val()&&this.updateCSSRule(this.classes.content,{"background-image":"url("+this.elements.bgParallaxImageSrc.val()+")","background-repeat":"no-repeat","background-position":"center center","background-attachment":"fixed","background-size":"cover"})},_bgOverlayChange:function(e){var t,i=this.elements.bgOverlayType.val(),l=this.elements.bgOverlayColor.val();"color"===i?(""===l?(this.elements.node.removeClass("fl-row-bg-overlay"),this.elements.node.removeClass("fl-col-bg-overlay"),this.updateCSSRule(this.classes.content+"::after","background-color","transparent")):(t=this.hexOrRgb(this.elements.bgOverlayColor.val()),this.delay(100,p.proxy(function(){this._bgOverlayAddClasses(),this.updateCSSRule(this.classes.content+"::after","background-color",t)},this))),this.updateCSSRule(this.classes.content+"::after","background-image","none")):"gradient"===i?(this._bgOverlayAddClasses(),this.updateCSSRule(this.classes.content+"::after","background-color","transparent"),this.elements.bgOverlayGradient.trigger("change")):(this.elements.node.removeClass("fl-row-bg-overlay"),this.elements.node.removeClass("fl-col-bg-overlay"),this.updateCSSRule(this.classes.content+"::after","background-color","transparent"),this.updateCSSRule(this.classes.content+"::after","background-image","none"))},_bgOverlayAddClasses:function(){this.elements.node.hasClass("fl-col")?this.elements.node.addClass("fl-col-bg-overlay"):this.elements.node.addClass("fl-row-bg-overlay")},_bgOverlayClear:function(e){this.elements.bgOverlayColor.prev(".fl-color-picker-clear").trigger("click"),this.elements.bgOverlayType.val("color").trigger("change")},_initNodeClassName:function(){p.extend(this.elements,{className:p(this.classes.settings+" input[name=class]",window.parent.document)}),this.elements.className.on("keyup",p.proxy(this._classNameChange,this)),this._lastClassName=this.elements.className.val()},_classNameChange:function(e){var t=this.elements.className.val();null!==this._lastClassName&&this.elements.node.removeClass(this._lastClassName),this.elements.node.addClass(t),this._lastClassName=t},_initNodeDimensions:function(e){for(var t,i={},l=["Top","Bottom","Left","Right"],n=["","Large","Medium","Responsive"],o=this.classes.settings,s="",r=null,d=null,r=0;r<l.length;r++)for(d=0;d<n.length;d++)t=e+l[r]+n[d],s=e+"_"+l[r].toLowerCase(),""!=n[d]&&(s+="_"+n[d].toLowerCase()),i[t]=p(o+" input[name="+s+"]",window.parent.document);p.extend(this.elements,i)},_initRow:function(){p.extend(this.elements,{width:p(this.classes.settings+" select[name=width]",window.parent.document),contentWidth:p(this.classes.settings+" select[name=content_width]",window.parent.document),maxContentWidth:p(this.classes.settings+" input[name=max_content_width]",window.parent.document),maxContentWidthLarge:p(this.classes.settings+" input[name=max_content_width_large]",window.parent.document),maxContentWidthMedium:p(this.classes.settings+" input[name=max_content_width_medium]",window.parent.document),maxContentWidthResponsive:p(this.classes.settings+" input[name=max_content_width_responsive]",window.parent.document),maxContentWidthUnit:p(this.classes.settings+" select[name=max_content_width_unit]",window.parent.document),maxContentWidthLargeUnit:p(this.classes.settings+" select[name=max_content_width_large_unit]",window.parent.document),maxContentWidthMediumUnit:p(this.classes.settings+" select[name=max_content_width_medium_unit]",window.parent.document),maxContentWidthResponsiveUnit:p(this.classes.settings+" select[name=max_content_width_responsive_unit]",window.parent.document),height:p(this.classes.settings+" select[name=full_height]",window.parent.document),minHeight:p(this.classes.settings+" input[name=min_height]",window.parent.document),align:p(this.classes.settings+" select[name=content_alignment]",window.parent.document),aspectRatio:p(this.classes.settings+" input[name=aspect_ratio]",window.parent.document)}),this.elements.width.on("change",p.proxy(this._rowWidthChange,this)),this.elements.contentWidth.on("change",p.proxy(this._rowContentWidthChange,this)),this.elements.maxContentWidth.on("input",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthLarge.on("input",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthMedium.on("input",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthResponsive.on("input",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthUnit.on("change",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthLargeUnit.on("change",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthMediumUnit.on("change",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.maxContentWidthResponsiveUnit.on("change",p.proxy(this._rowMaxContentWidthChange,this)),this.elements.height.on("change",p.proxy(this._rowHeightChange,this)),this.elements.align.on("change",p.proxy(this._rowHeightChange,this)),this.elements.aspectRatio.on("input",p.proxy(this._rowInitContentAlignment,this)),this._initNodeTextColor(),this._initNodeBg(),this._initNodeClassName(),this._initNodeDimensions("border"),this._initNodeDimensions("margin"),this._initNodeDimensions("padding"),this._rowInitContentAlignment()},_rowWidthChange:function(e){FLBuilderConfig.global;var t=this.elements.node,i=this.elements.content.find(".fl-row-content");this.elements.maxContentWidth.val(),this.elements.maxContentWidthUnit.val();t.css("max-width","none"),i.css("max-width","none"),"full"==this.elements.width.val()?(t.removeClass("fl-row-fixed-width"),t.addClass("fl-row-full-width")):(t.removeClass("fl-row-full-width"),t.addClass("fl-row-fixed-width")),this._rowMaxContentWidthChange()},_rowContentWidthChange:function(e){FLBuilderConfig.global;var t=this.elements.node,i=this.elements.content.find(".fl-row-content");this.elements.maxContentWidth.val(),this.elements.maxContentWidthUnit.val();t.css("max-width","none"),i.css("max-width","none"),"full"==this.elements.contentWidth.val()?(i.removeClass("fl-row-fixed-width"),i.addClass("fl-row-full-width")):(i.removeClass("fl-row-full-width"),i.addClass("fl-row-fixed-width"),this._rowMaxContentWidthChange())},_rowMaxContentWidthChange:function(e){var t=FLBuilderResponsiveEditing._mode,i=FLBuilderConfig.global,l="",n="",l="fixed"==this.elements.width.val()?".fl-node-"+this.nodeId+".fl-row-fixed-width, .fl-node-"+this.nodeId+" .fl-row-fixed-width":".fl-node-"+this.nodeId+" .fl-row-content";"default"===t?(""!==this.elements.maxContentWidth.val()?n=this.elements.maxContentWidth.val()+this.elements.maxContentWidthUnit.val():""!==i.row_width&&(n=i.row_width+i.row_width_unit),this.updateCSSRule(l,"max-width",n,!1)):"large"===t?(""!==this.elements.maxContentWidthLarge.val()?n=this.elements.maxContentWidthLarge.val()+this.elements.maxContentWidthLargeUnit.val():""!==i.row_width_medium&&(n=i.row_width_medium+i.row_width_medium_unit),this.updateCSSRule(l,"max-width",n,!0)):"medium"===t?(""!==this.elements.maxContentWidthMedium.val()?n=this.elements.maxContentWidthMedium.val()+this.elements.maxContentWidthMediumUnit.val():""!==i.row_width_medium&&(n=i.row_width_medium+i.row_width_medium_unit),this.updateCSSRule(l,"max-width",n,!0)):"responsive"===t&&(""!==this.elements.maxContentWidthResponsive.val()?n=this.elements.maxContentWidthResponsive.val()+this.elements.maxContentWidthResponsiveUnit.val():""!==i.row_width_responsive&&(n=i.row_width_responsive+i.row_width_responsive_unit),this.updateCSSRule(l,"max-width",n,!0))},_rowHeightChange:function(e){var t=this.elements.node;t.removeClass("fl-row-align-top"),t.removeClass("fl-row-align-center"),t.removeClass("fl-row-align-bottom"),t.removeClass("fl-row-default-height"),t.removeClass("fl-row-full-height"),t.removeClass("fl-row-custom-height"),("full"==this.elements.height.val()?(t.addClass("fl-row-full-height"),t.addClass("fl-row-align-"+this.elements.align.val()),this.elements.minHeight.val("")):"custom"==this.elements.height.val()?(t.addClass("fl-row-custom-height"),t.addClass("fl-row-align-"+this.elements.align.val()),this.elements.minHeight):(t.addClass("fl-row-default-height"),t.addClass("fl-row-align-"+this.elements.align.val()),this.elements.minHeight.val(""))).trigger("input"),this._rowInitContentAlignment()},_rowInitContentAlignment:function(e){var t=this.elements.height.val().trim(),i=p(".fl-builder-settings:visible"),l=i.find("#fl-field-content_alignment"),i=i.find("#fl-field-aspect_ratio input").val();"default"!==t||i?l.show():l.hide()},_initColumn:function(){p.extend(this.elements,{size:p(this.classes.settings+" input[name=size]",window.parent.document),sizeLarge:p(this.classes.settings+" input[name=size_large]",window.parent.document),sizeMedium:p(this.classes.settings+" input[name=size_medium]",window.parent.document),sizeResponsive:p(this.classes.settings+" input[name=size_responsive]",window.parent.document),columnHeight:p(this.classes.settings+" select[name=equal_height]",window.parent.document),columnAlign:p(this.classes.settings+" select[name=content_alignment]",window.parent.document),responsiveOrder:p(this.classes.settings+" select[name=responsive_order]",window.parent.document)}),this.elements.size.on("input",p.proxy(this._colSizeChange,this)),this.elements.sizeLarge.on("input",p.proxy(this._colSizeChange,this)),this.elements.sizeMedium.on("input",p.proxy(this._colSizeChange,this)),this.elements.sizeResponsive.on("input",p.proxy(this._colSizeChange,this)),this.elements.columnHeight.on("change",p.proxy(this._colHeightChange,this)),this.elements.columnAlign.on("change",p.proxy(this._colHeightChange,this)),this.elements.responsiveOrder.on("change",p.proxy(this._colResponsiveOrder,this)),this._initNodeTextColor(),this._initNodeBg(),this._initNodeClassName(),this._initNodeDimensions("border"),this._initNodeDimensions("margin"),this._initNodeDimensions("padding")},_colSizeChange:function(e){var e=p(e.target),t=92,i=parseFloat(e.val()),l=this.elements.node.closest(".fl-col-group"),n=this.elements.node.prev(".fl-col"),o=this.elements.node.next(".fl-col"),s=0===o.length?n:o,n=this.elements.node.siblings(".fl-col"),r=0,o=FLBuilderResponsiveEditing._mode;0!==n.length&&(isNaN(i)&&("large"===o?i=this.elements.size.val():"medium"===o?i=(this.elements.sizeLarge.val()?this.elements.sizeLarge:this.elements.size).val():"responsive"===o&&(i=this.elements.sizeMedium.val()?this.elements.sizeMedium.val():this.elements.sizeLarge.val()?this.elements.sizeLarge.val():"auto"),"auto"!==i)&&isNaN(i)&&(i=8),"default"===o?(n.each(function(){p(this).data("node")!=s.data("node")&&(t-=parseFloat(p(this)[0].style.width),r+=parseFloat(p(this)[0].style.width))}),t<(i=i<8?8:i)&&(i=t),this.elements.node.css("width",i+"%"),s.css("width",100-r-i+"%")):(100<i&&e.val(i=100),this.updateCSSRule(this.classes.node,{"max-width":("auto"===i?100:i)+"% !important",width:("auto"===i?i:i+"%")+" !important"},void 0,!0),"responsive"===o&&(e.val()?(this.updateCSSRule(this.classes.node,"float",FLBuilderConfig.isRtl?"right":"left",!0),this.updateCSSRule(this.classes.node,"clear","none",!0)):(this.updateCSSRule(this.classes.node,"float","none",!0),this.updateCSSRule(this.classes.node,"clear","both",!0)),e.val()||this._colsHaveCustomResponsiveWidth(n)?l.addClass("fl-col-group-custom-width"):l.removeClass("fl-col-group-custom-width"))))},_colsHaveCustomResponsiveWidth:function(e){var t=FLBuilderSettingsConfig.nodes,i=!1;return e.each(function(){var e=p(this).data("node");t[e]&&t[e].size_responsive&&(i=!0)}),i},_colHeightChange:function(){var e=this.elements.node.parent(".fl-col-group");e.removeClass("fl-col-group-align-top"),e.removeClass("fl-col-group-align-center"),e.removeClass("fl-col-group-align-bottom"),"yes"==this.elements.columnHeight.val()?(e.addClass("fl-col-group-equal-height"),e.addClass("fl-col-group-align-"+this.elements.columnAlign.val())):e.removeClass("fl-col-group-equal-height")},_colResponsiveOrder:function(){var e=this.elements.node.parent(".fl-col-group"),t=this.elements.responsiveOrder.val().split(",");t.includes("medium")?e.addClass("fl-col-group-medium-reversed"):e.removeClass("fl-col-group-medium-reversed"),t.includes("mobile")?e.addClass("fl-col-group-responsive-reversed"):e.removeClass("fl-col-group-responsive-reversed")},_initModule:function(){this._initNodeClassName(),this._initNodeDimensions("margin")},_initDefaultFieldPreviews:function(e){var t,i,e=FLBuilder.isUndefined(e)?this.elements.settings.find(".fl-field"):e,l=null,n=0;if(FLBuilderConfig.safemode)return!1;for(;n<e.length;n++)t=(l=e.eq(n)).data("type"),"refresh"==(i=l.data("preview")).type&&this._initFieldRefreshPreview(l),"text"==i.type&&this._initFieldTextPreview(l),"css"==i.type&&this._initFieldCSSPreview(l),"widget"==i.type&&this._initFieldWidgetPreview(l),"font"==i.type&&this._initFieldFontPreview(l),"attribute"==i.type&&this._initFieldAttributePreview(l),"animation"==i.type&&this._initFieldAnimationPreview(i,l),"callback"==i.type&&this._initFieldCallbackPreview(i,l,t,e),this._initFieldUnitSelect(l)},_reinitDeferredFieldPrevies:function(){var t=this.elements.settings.find(".fl-field");for(let e=0;e<t.length;e++){var i=p(t[e]),l=i.data("type");FL.Builder.settingsForms.canDeferField({type:l})&&this._initDefaultFieldPreviews(i)}},_initFieldCallbackPreview:function(e,t,i,l){var n,o=e.callback,s=p(".fl-builder-settings:visible",window.parent.document),r=s.data("node"),d=p(FLBuilder._contentClass+" .fl-node-"+r,this.layoutDoc);if(void 0!==FLBuilderPreviewCallbacks[o]?n=FLBuilderPreviewCallbacks[o]:void 0!==window[o]?n=window[o]:void 0!==window.parent[o]&&(n=window.parent[o]),"function"==typeof n){var a={field:t,fields:l,type:i,preview:e,form:s,nodeID:r,node:d};switch(i){case"align":case"button-group":case"text":case"multiple-photos":case"video":case"icon":case"ordering":a.input=t.find("input:not(.fl-preview-ignore)"),a.getValue=function(){return a.input.val()};break;case"color":a.input=t.find("input.fl-color-picker-value"),a.getValues=function(){var e=a.input.val();FLBuilderPreview.formatColor(e)};break;case"textarea":case"code":a.textarea=t.find("textarea"),a.getValue=function(){return a.textarea.val()};break;case"select":case"photo-sizes":case"post-type":a.select=t.find("select"),a.getValue=function(){return a.select.val()};break;case"photo":a.input=t.find("input[type=hidden]:not(.fl-preview-ignore)"),a.sizeSelect=t.find("select"),a.getValues=function(){return{value:a.input.val(),size:a.sizeSelect.val()}};break;case"unit":a.input=t.find("input[type=number]"),a.unitSelect=t.find(".fl-field-unit-select"),a.getValues=function(){var e=a.input.val(),t=a.unitSelect.val();return{value:e,unit:t,formattedValue:e+t}};break;case"dimension":a.inputs=t.find("input[type=number]"),a.unitSelect=t.find(".fl-field-unit-select"),a.getValues=function(){var l={inputs:[],props:{},unit:a.unitSelect.val()};return a.inputs.each(function(e,t){var i=(t=p(t)).val(),t=t.data("unit");l.inputs.push(i),l.props[t]=i}),l};break;case"animation":a.input=t.find("input:not(.fl-preview-ignore)"),a.select=t.find("select"),a.getValues=function(){return{delay:a.input.val(),style:a.select.val()}};break;case"link":a.input=t.find(".fl-link-field-input-wrap input:not(.fl-preview-ignore)"),a.targetInput=t.find("input[name$=_target]"),a.noFollowInput=t.find("input[name$=_nofollow]"),a.getValues=function(){return{url:a.input.val(),target:a.targetInput.val(),noFollow:a.noFollowInput.val()}};break;case"shadow":a.colorInput=t.find("input.fl-color-picker-value"),a.inputs=t.find("input[type=number]"),a.getValues=function(){a.colorInput.val(),a.inputs[0].val(),a.inputs[1].val(),a.inputs[2].val(),a.inputs[3].val()};break;case"gradient":a.inputs=t.find("input:not(.fl-preview-ignore)"),a.select=t.find("select"),a.gradientInputs={},a.gradientInputs.type=t.find('select[name$="[type]"]'),a.gradientInputs.angle=t.find('input[name$="[angle]"]'),a.gradientInputs.position=t.find('select[name$="[position]"]'),a.gradientInputs.stops=[],t.find(".fl-gradient-picker-colors .fl-gradient-picker-color-row").each(function(e,t){t=p(t),a.gradientInputs.stops.push({color:t.find(".fl-gradient-picker-color input"),stop:t.find(".fl-gradient-picker-stop input")})}),a.getValues=function(){var e,t={type:a.gradientInputs.type.val(),angle:a.gradientInputs.angle.val(),position:a.gradientInputs.position.val(),stops:[]};for(e in a.gradientInputs.stops){var i=a.gradientInputs.stops[e];t.stops[e]={color:i.color.val(),stop:i.stop.val()}}return t};break;case"shape-transform":a.inputs=t.find("input:not(.fl-preview-ignore)"),a.getValues=function(){return{scaleXSign:a.inputs.eq(0).val(),scaleYSign:a.inputs.eq(1).val(),skewX:a.inputs.eq(2).val(),skewY:a.inputs.eq(3).val(),scaleX:a.inputs.eq(4).val(),rotate:a.inputs.eq(5).val(),scaleY:a.inputs.eq(6).val()}};break;default:a.input=t.find("input:not(.fl-preview-ignore)"),a.getValue=function(){return a.input.val()}}var u,o=t.find(".fl-field-responsive-toggle"),c=(a.responsiveToggle=!!o.length&&o,n=n.bind(this,a),{input:"change keyup input",inputs:"change keyup input",targetInput:"change keyup input",noFollowInput:"change keyup input",colorInput:"change input",textarea:"change keyup input",select:"change",sizeSelect:"change",unitSelect:"change"});for(u in c)void 0!==a[u]&&a[u].on(c[u],n)}},_initFieldRefreshPreview:function(e){var t=e.data("type"),i=e.data("preview"),l=p.proxy(this.delayPreview,this);switch(t){case"align":e.find("input:not(.fl-preview-ignore)").on("change",l);break;case"text":e.find("input[type=text]:not(.fl-preview-ignore)").on("keyup",l);break;case"textarea":e.find("textarea:not(.fl-preview-ignore)").on("keyup",l);break;case"select":e.find("select:not(.fl-preview-ignore)").on("change",l);break;case"color":e.find(".fl-color-picker-value").on("change",l);break;case"photo":e.find("select:not(.fl-preview-ignore)").on("change",l);break;case"multiple-photos":e.find("input:not(.fl-preview-ignore)").on("change",l);break;case"photo-sizes":e.find("select:not(.fl-preview-ignore)").on("change",l);break;case"video":case"multiple-audios":case"icon":e.find("input:not(.fl-preview-ignore)").on("change",l);break;case"form":e.on("change","input:not(.fl-preview-ignore)",l);break;case"editor":this._addTextEditorCallback(e,i);break;case"code":e.find("textarea:not(.fl-preview-ignore)").on("change",l);break;case"post-type":e.find("select:not(.fl-preview-ignore)").on("change",l);break;case"suggest":e.find(".as-values").on("change",l),e.find("select:not(.fl-preview-ignore)").on("change",l);break;case"unit":case"dimension":e.find("input[type=number]:not(.fl-preview-ignore)").on("input",l);break;case"ordering":e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",l);break;default:e.on("change",l)}},_initFieldTextPreview:function(e){var t=e.data("type"),i=e.data("preview"),l=p.proxy(this._previewText,this,i);switch(t){case"text":e.find("input[type=text]:not(.fl-preview-ignore)").on("input",l);break;case"unit":e.find("input[type=number]:not(.fl-preview-ignore)").on("input",l);break;case"textarea":e.find("textarea:not(.fl-preview-ignore)").on("input",l);break;case"code":e.find("textarea:not(.fl-preview-ignore)").on("change",l);break;case"editor":this._addTextEditorCallback(e,i)}},_previewText:function(e,t){var e=this._getPreviewSelector(this.classes.node,e.selector),e=p(e,this.layoutDoc),i=(p(t.target).attr("name"),p("<div>"+p(t.target).val()+"</div>"));i.find("script").remove(),0<e.length?e.html(i.html()):this.delayPreview(t)},_previewTextEditor:function(e,t,i){var e=this._getPreviewSelector(this.classes.node,e.selector),e=p(e,this.layoutDoc),l=void 0!==window.parent.tinyMCE?window.parent.tinyMCE.get(t):null,t=p("#"+t,window.parent.document),n=(t.closest(".fl-editor-field").attr("data-name"),"");if(l&&"none"==t.css("display"))n=p("<div>"+l.getContent()+"</div>");else{if(!t.length)return;n="undefined"==typeof switchEditors||void 0===switchEditors.wpautop?p("<div>"+t.val()+"</div>"):p("<div>"+switchEditors.wpautop(t.val())+"</div>")}n.find("script").remove(),0<e.length?e.html(n.html()):this.delayPreview(i)},_addTextEditorCallback:function(e,t){var e=e.find("textarea.wp-editor-area").attr("id"),i=null;if("refresh"==t.type)i=p.proxy(this.delayPreview,this);else{if("text"!=t.type)return;i=p.proxy(this._previewTextEditor,this,t,e)}p("#"+e,window.parent.document).on("keyup",i),void 0!==window.parent.tinyMCE&&((editor=window.parent.tinyMCE.get(e)).on("change",i),editor.on("keyup",i))},_initFieldFontPreview:function(e){var t=e.data("type"),i=e.data("preview"),i=(i.id=e.attr("id"),p.proxy(this._previewFont,this,i));"font"==t&&e.find(".fl-font-field").on("change","select",i)},_previewFont:function(e,t){var t=p(t.delegateTarget),i=t.find(".fl-font-field-font"),l=p(i).find(":selected").parent().attr("label"),t=t.find(".fl-font-field-weight"),n=e.id+"-"+this.nodeId,o=this._getPreviewSelector(this.classes.node,e.selector),e=e.important?" !important":"",s="";"Google"!=l&&"Recently Used"!=l||this._buildFontStylesheet(n,i.val(),t.val()),s=i.val(),new RegExp("[0-9]").test(i.val())&&(s='"'+i.val()+'"'),this.updateCSSRule(o,"font-family","Default"===i.val()?"":s+e),this.updateCSSRule(o,"font-weight","default"===t.val()?"":t.val()+e)},_buildFontStylesheet:function(e,t,i){var l=FLBuilderConfig.googleFontsUrl,n="",o={},s={};o[t]=[i],FLBuilderPreview._fontsList[e]=o,Object.keys(FLBuilderPreview._fontsList).forEach(function(e){var i=FLBuilderPreview._fontsList[e];Object.keys(i).forEach(function(t){var e=i[t];s[t]=s[t]||[],e=e.filter(function(e){return s[t].indexOf(e)<0}),s[t]=s[t].concat(e)})}),p.each(s,function(e,t){n+="Molle"===e?e+":i|":e+":"+t.join()+"|"}),n=l+n.slice(0,-1).replace(" ","+"),p("#fl-builder-google-fonts-preview",this.layoutDoc).length<1?p("head",this.layoutDoc).append(p("<link>").attr("id","fl-builder-google-fonts-preview").attr("type","text/css").attr("rel","stylesheet").attr("href",n)):p("#fl-builder-google-fonts-preview",this.layoutDoc).attr("href",n)},_initFieldCSSPreview:function(e){var t=e.data("preview"),i=null;if(void 0!==t.rules)for(i in t.rules)this._initFieldCSSPreviewCallback(e,t.rules[i]);else this._initFieldCSSPreviewCallback(e,t)},_initFieldCSSPreviewCallback:function(e,t){switch(e.data("type")){case"align":case"justify":case"grid-auto-flow":e.find("input:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e));break;case"object-fit":e.find("input:not(.fl-preview-ignore)").on("input",p.proxy(this._previewCSS,this,t,e));var i=e.find('input[type="hidden"]:not(.fl-preview-ignore)');i.on("change",p.proxy(this._previewCSS,this,t,e)),i.on("change",p.proxy(this._previewFieldObjectFit,this,t,e));break;case"border":e.find("select:not(.fl-preview-ignore)").on("change",p.proxy(this._previewBorderCSS,this,t,e)),e.find("input[type=number]:not(.fl-preview-ignore)").on("input",p.proxy(this._previewBorderCSS,this,t,e)),e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",p.proxy(this._previewBorderCSS,this,t,e));break;case"color":e.find(".fl-color-picker-value").on("change",p.proxy(this._previewColorCSS,this,t,e));break;case"dimension":e.find("input[type=number]:not(.fl-preview-ignore)").on("input",p.proxy(this._previewDimensionCSS,this,t,e));break;case"gradient":e.find("select:not(.fl-preview-ignore)").on("change",p.proxy(this._previewGradientCSS,this,t,e)),e.find(".fl-gradient-picker-angle").on("input",p.proxy(this._previewGradientCSS,this,t,e)),e.find(".fl-color-picker-value").on("change",p.proxy(this._previewGradientCSS,this,t,e)),e.find(".fl-gradient-picker-stop").on("input",p.proxy(this._previewGradientCSS,this,t,e));break;case"photo":e.find("select:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e));break;case"select":case"aspect-ratio":case"placement":e.find("select:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e));break;case"shadow":e.find("input:not(.fl-preview-ignore)").on("input",p.proxy(this._previewShadowCSS,this,t,e)),e.find(".fl-color-picker-value").on("change",p.proxy(this._previewShadowCSS,this,t,e));break;case"text":e.find("input[type=text]:not(.fl-preview-ignore)").on("keyup input change",p.proxy(this._previewCSS,this,t,e));break;case"hidden":e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e));break;case"typography":e.find("select:not(.fl-preview-ignore)").on("change",p.proxy(this._previewTypographyCSS,this,t,e)),e.find("input[type=number]:not(.fl-preview-ignore)").on("input",p.proxy(this._previewTypographyCSS,this,t,e)),e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",p.proxy(this._previewTypographyCSS,this,t,e));break;case"unit":e.find("input[type=number]:not(.fl-preview-ignore)").on("input",p.proxy(this._previewCSS,this,t,e));break;case"button-group":case"grid-tracklist":case"grid-area":e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e));break;case"flex":case"size":e.find("input[type=number]:not(.fl-preview-ignore)").on("input",p.proxy(this._previewCSS,this,t,e)),e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e));break;case"background":e.find("input[type=hidden]:not(.fl-preview-ignore)").on("change",p.proxy(this._previewCSS,this,t,e))}},_previewCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),n=e.property,t=this._getPreviewCSSUnit(e,t,i),i=p(i.target),o=e.substitute_values,s=i.val(),r=o&&Object.keys(o).includes(s)?o[s]:s,d=!!i.closest(".fl-field-responsive-setting").length,a=e.important&&""!==r?" !important":"";if(-1<n.indexOf("image")&&r?r="url("+r+")":"%"===t&&"opacity"===n?r=parseInt(r)/100:""===r||isNaN(r)||(r+=t),e.format_value&&(r=wp.i18n.sprintf(e.format_value,r)),void 0!==e.sub_value){o=i.attr("name");if("string"==typeof e.sub_value&&!o.endsWith(`[${e.sub_value}]`))return;if("object"==typeof e.sub_value&&!o.includes(`[${e.sub_value.setting_name}]`))return}if("boolean"==typeof e.enabled)return e.enabled;if(e.enabled&&"object"==typeof e.enabled){s=p(".fl-builder-settings:visible",window.parent.document);const h=FLBuilder._getSettings(s);for(let t in e.enabled){var u=e.enabled[t];if("object"==typeof u){if("nearest_value"in u){var c=FLBuilderResponsiveEditing._mode,c=this.getInheritedSettingValue(t,c,h);if("string"==typeof u.nearest_value&&u.nearest_value!==c)return;if(Array.isArray(u.nearest_value)&&!u.nearest_value.includes(c))return}}else if(Array.isArray(e.enabled[t])){if(!e.enabled[t].some(e=>e===h[t]))return}else if(e.enabled[t]!==h[t])return}}if(Array.isArray(n))for(var f in n)this.updateCSSRule(l,n[f],r+a,d);else this.updateCSSRule(l,n,r+a,d)},getInheritedSettingValue:function(e,t,i){let l=""===t||"default"===t?e:e+"_"+t;if(void 0!==i[l]&&""!==i[l])return i[l];let n=["responsive","medium","large",""];t=n.indexOf("default"===t?"":t);if(-1!==t)for(var o in n=n.slice(t)){o=n[o];if(void 0!==i[l=""===o?e:e+"_"+o]&&""!==i[l])return i[l]}return null},_previewBorderCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),n=p(i.target),t=n.closest(".fl-field"),o=n.closest(".fl-compound-field-setting"),s=o.data("property"),r=n.val(),n=(o.find(".fl-field-unit-select"),!!n.closest(".fl-field-responsive-setting").length),d=e.important&&""!==r?" !important":"";"border-color"===(e.property=s)?this._previewColorCSS(e,t,i):"border-width"===s||"border-radius"===s?this._previewDimensionCSS(e,t,i):"box-shadow"===s?this._previewShadowCSS(e,o,i):("border-style"===s&&t.find(".fl-border-field-width input:visible").trigger("input"),this.updateCSSRule(l,s,r+d,n))},_previewColorCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),i=p(i.target),n=i.val(),i=!!i.closest(".fl-field-responsive-setting").length,o=e.important&&""!==n?" !important":"";!CSS.supports("color",n)&&CSS.supports("color","#"+n)&&(n="#"+n),this.updateCSSRule(l,e.property,n+o,i)},_previewDimensionCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),n=e.property,o=t.attr("id").replace("fl-field-",""),s=p(i.target).data("unit"),i=this._getDimensionValue(e,t,s,i),t=!!t.find(".fl-field-responsive-setting").length,e=e.important&&""!==i?" !important":"",n="border-radius"===n?"border-"+s.replace("_","-")+"-radius":"border-width"===n?"border-"+s+"-width":"gap"===n?s+"-"+n:n+"-"+s;this.updateCSSRule(l,n,i+e,t),"margin"!==o&&"padding"!==o&&"border"!==o||this.elements.node.find(".fl-bg-slideshow").length&&FLBuilder._resizeLayout()},_getDimensionValue:function(e,t,i,l){var n=p(l.target),o=n.val(),s="";return null===(o=o.toLowerCase().replace(/[^a-z0-9%.\-]/g,""))||""===o||isNaN(o)?n.attr("placeholder")&&(s=this._getPreviewCSSUnit(e,t,l),o=parseFloat(n.attr("placeholder"))+(s||"px")):(s=this._getPreviewCSSUnit(e,t,l),o=parseFloat(o)+(s||"px")),o},_getPreviewCSSUnit:function(e,t,i){var i=p(i.target),l=(FLBuilderResponsiveEditing._mode,!!i.closest(".fl-compound-field-setting").length),n=!!i.closest(".fl-field-responsive-setting").length,o=null;return(o=(l?i.closest(".fl-compound-field-setting"):n?i.closest(".fl-field-responsive-setting"):t).find(".fl-field-unit-select"))&&o.length?"SELECT"===o.prop("tagName")?o.val():o.text():e.unit||""},_initFieldUnitSelect:function(e){e.find(".fl-field-unit-select").on("change",function(){var e=p(this),t=e.closest(".fl-field-responsive-setting"),e=e.closest(".fl-field");(t.length?t:e).find("input").trigger("input")})},_previewGradientCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),n=t.find(".fl-gradient-picker-type-select").val(),o=t.find(".fl-gradient-picker-angle").val(),s=t.find(".fl-gradient-picker-position").val(),r=t.find(".fl-color-picker-value"),d=t.find(".fl-gradient-picker-stop input"),a=[],t="";r.each(function(e){var t=p(this).val(),e=d.eq(e).val();(t=""===t?"rgba(255,255,255,0)":t).indexOf("rgb")<0&&(t="#"+t),isNaN(e)&&(e=0),a.push(t+" "+e+"%")}),a=a.join(", "),t="linear"===n?"linear-gradient("+(o=isNaN(o)?0:o)+"deg, "+a+")":"radial-gradient(at "+s+", "+a+")",r=e.important&&""!==t?" !important":"",this.updateCSSRule(l,e.property,t+r)},_previewShadowCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),n=t.find(".fl-shadow-field-color input").val(),o=t.find(".fl-shadow-field-horizontal input").val(),s=t.find(".fl-shadow-field-vertical input").val(),r=t.find(".fl-shadow-field-blur input").val(),d=t.find(".fl-shadow-field-spread input").val(),t=!!t.find(".fl-shadow-field-spread input").length,i=!!p(i.target).closest(".fl-field-responsive-setting").length,a="";""!==n&&(""===d&&(d=0),a=(a=(o=""===o?0:o)+"px ")+(s=""===s?0:s)+"px "+(r=""===r?0:r)+"px ",t&&(a+=d+"px "),a=a+FLBuilderPreview.formatColor(n)+""),e.important,this.updateCSSRule(l,e.property,a,i)},_previewTypographyCSS:function(e,t,i){var l=this._getPreviewSelector(this.classes.node,e.selector),n=p(i.target),t=n.closest(".fl-field"),o=n.closest(".fl-compound-field-setting"),s=o.data("property"),r=n.val(),d=o.find(".fl-field-unit-select"),n=!!n.closest(".fl-field-responsive-setting").length,a=e.important&&""!==r?" !important":"";"font-family"===s?(e.id=t.attr("id"),this._previewFont(e,{delegateTarget:o})):"text-shadow"===s?(e.property="text-shadow",this._previewShadowCSS(e,o,i)):(d.length&&""!==r&&("vw"===d.val()?r="calc("+FLBuilderConfig.global.responsive_base_fontsize+"px + "+r+"vw)":r+="SELECT"===d.prop("tagName")?d.val():"px"),this.updateCSSRule(l,s,r+a,n))},_initFieldAttributePreview:function(e){var t=e.data("preview"),i=t.attribute,l=e.find("input"),e=(e.val(),window[t.format_callback]),t=this._getPreviewSelector(this.classes.node,t.selector),t=p(t,this.layoutDoc),t=this._previewAttribute.bind(this,l,t,i,e);l.on("change",t),l.on("keyup",t),l.on("input",t)},_previewAttribute:function(e,t,l,n){var o=e.val();for("function"==typeof n&&(o=n(o)),i=0;i<t.length;i++)t[i].setAttribute(l,o)},_initFieldWidgetPreview:function(e){var t=p.proxy(this.delayPreview,this);e.find("input").on("keyup",t),e.find("input[type=checkbox]").on("click",t),e.find("textarea").on("keyup",t),e.find("select").on("change",t)},_initFieldAnimationPreview:function(e,t){t.find(".fl-animation-field-style select").on("change",p.proxy(this._previewAnimationField,this,e,t)),t.find(".fl-animation-field-duration input").on("input",p.proxy(this._previewAnimationField,this,e,t))},_previewAnimationField:function(e,t,i){var e=this._getPreviewSelector(this.classes.node,e.selector),l=p(e,this.layoutDoc),e=t.find(".fl-animation-field-style select"),t=t.find(".fl-animation-field-duration input"),n=e[0].options;l.removeClass("fl-animated"),l.removeClass("fl-animation"),l.css("animation-duration","");for(var o=0;o<n.length;o++)l.removeClass("fl-"+n[o].value);""!==e.val()&&(l.addClass("fl-animation"),l.addClass("fl-"+e.val()),l.data("animation-delay",0),l.data("animation-duration",t.val())),FLBuilderLayoutModules._doModuleAnimation.apply(l)},_previewFieldObjectFit:function(e,t,i){var e=this._getPreviewSelector(this.classes.node,e.selector),e=p(e,this.layoutDoc).closest(".fl-module").get(0),l="fl-fill-container",t=t.find(".fl-button-group-field input").val();""===t&&e.classList.contains(l)&&e.classList.remove(l),""===t||e.classList.contains(l)||e.classList.add(l)},_getPreviewSelector:function(e,t){return FLBuilderPreview.getFormattedSelector.call(this,e,t)},toUpperCaseWords:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},FLBuilderPreview.formatColor=function(e){return e=!CSS.supports("color",e)&&CSS.supports("color","#"+e)?"#"+e:e},FLBuilderPreviewCallbacks={previewShape:function(e,t){var i=e.preview.position,l=e.preview.prefix,e=e.form;yOrientation=e.find('input[name="'+(l+"transform[][scaleYSign]")+'"]'),"bottom"===i?yOrientation.val("invert"):yOrientation.val(""),yOrientation.trigger("change"),this.delayPreview()},previewShapeLayerSize:function(e,t){var i,l=e.getValues(),n=l.unit,o=l.props.width,s=l.props.height,l=l.props.top,r=e.preview.prefix,d=e.preview.position,a=this._getPreviewSelector(this.classes.node,".fl-builder-"+d+"-edge-layer"),u=a+" > *",c=e.form.find('[name="'+r+'align"]').val().split(" "),f=c[0],c=c[1],e=e.form.find('[name="'+r+'shape"]').val(),r=FLBuilderConfig.presets.shape[e];if(shapeProps={width:"100%",left:"auto",right:"auto",height:"auto",top:"auto",bottom:"auto"},o){shapeProps.width=o+n;var h=o/2+n;switch(c){case"left":shapeProps.left="0",shapeProps.right="auto";break;case"right":shapeProps.left="auto",shapeProps.right="0";break;case"center":shapeProps.left="calc( 50% - "+h+")",shapeProps.right="auto"}}switch(this.updateCSSRule(u,"width",shapeProps.width),this.updateCSSRule(u,"left",shapeProps.left),this.updateCSSRule(u,"right",shapeProps.right),i=s?s/2+n:o?o/r.data.viewBox.width*100/2+n:"",s&&(shapeProps.height=s+n),f){case"top":shapeProps.top="0",shapeProps.bottom="auto";break;case"bottom":shapeProps.top="auto",shapeProps.bottom="0";break;case"center":shapeProps.top="calc( 50% - "+i+")",shapeProps.bottom="auto"}this.updateCSSRule(u,"height",shapeProps.height+" !important"),this.updateCSSRule(u,"top",shapeProps.top),this.updateCSSRule(u,"bottom",shapeProps.bottom),""===l?this.updateCSSRule(a,d,"0"):this.updateCSSRule(a,d,l+n)},previewShapeAlign:function(e,t){var i=e.preview.prefix;e.form.find('[name="'+i+'size_width"]').trigger("input")},previewShapeFillStyle:function(e,t){var i=e.input.val(),l=e.preview,n=e.preview.prefix,o="fl-row-"+e.nodeID+"-"+n+"-linear-gradient",s="fl-row-"+e.nodeID+"-"+n+"-radial-gradient",r="fl-row-"+e.nodeID+"-"+n+"-pattern",d=e.form;if(void 0!==i){var a=this._getPreviewSelector(this.classes.node,l.selector);switch(i){case"color":var u=d.find("[name="+n+"fill_color]").val();this.updateCSSRule(a,"fill",FLBuilderPreview.formatColor(u));break;case"gradient":u=d.find("#fl-field-"+n+"fill_gradient").find('select[name$="[type]"]').val();this.updateCSSRule(a,"fill","url(#"+("radial"===u?s:o)+")");break;case"pattern":this.updateCSSRule(a,"fill","url(#"+r+")")}}},previewShapeGradientFill:function(e,t){var i,l=e.getValues(),n=e.node,e=".fl-builder-"+e.preview.position+"-edge-layer",n=n.find(e+" "+l.type+"Gradient"),o="url(#"+n.attr("id")+")",e=this._getPreviewSelector(this.classes.node,e+" .fl-shape"),s=(this.updateCSSRule(e,"fill",o),n.find("stop"));for(i in l.stops){var r,d=l.stops[i],a=s.eq(i),u=d.color,d=d.stop,c=1;0===u.indexOf("rgba")&&(c=(r=u.substring(u.indexOf("(")+1,u.lastIndexOf(")")).split(/,\s*/)).pop(),u="rgb("+r.join(",")+")"),a.attr("stop-color",FLBuilderPreview.formatColor(u)),a.attr("stop-opacity",c),a.attr("offset",d+"%")}if("linear"===l.type&&void 0!==n[0]&&n[0].setAttribute("gradientTransform","rotate("+l.angle+" .5 .5 )"),"radial"===l.type){var f,h,e=(parts=l.position.split(" "))[0],o=parts[1];switch(e){case"top":case"left":f=0;break;case"center":f=.5;break;case"bottom":case"right":f=1}switch(o){case"top":case"left":h=0;break;case"center":h=.5;break;case"bottom":case"right":h=1}(e=.5)===f&&.5===h||(e=1),n.attr("cx",f),n.attr("cy",h),n.attr("r",e)}},previewShapeTransform:function(e,t){e.form;var i=e.preview,i=(i.prefix,this._getPreviewSelector(this.classes.node,i.selector)+" > *"),l=e.getValues(),n=[];Object.keys(l).map(function(e){var t=l[e],i="";switch(e){case"scaleXSign":case"scaleYSign":return;case"scaleX":case"scaleY":t&&""!==t&&0!==t||(t="1"),t="invert"===("scaleX"===e?l.scaleXSign:l.scaleYSign)?-Math.abs(t):Math.abs(t),n.push(e+"("+t+")");break;case"translateX":case"translateY":t&&n.push(e+"("+t+(i="px")+")");break;case"skewX":case"skewY":t&&n.push(e+"("+t+(i="deg")+")");break;case"rotate":i="deg",""!==t&&"0"!==t&&n.push("rotate("+t+i+")")}}),this.updateCSSRule(i,"transform",n.join(" "))}}}(jQuery),!function(u){var i={ignored:[],reparsed:[],width:null,callback:null,sheets:{},styles:[],queue:[],emPxValue:null,regex:{media:/@media[^{]*{([\s\S]+?})\s*}/gi,empty:/@media[^{]*{([^{}]*?)}/gi,keyframes:/@(?:\-(?:o|moz|webkit)\-)?keyframes[^\{]+\{(?:[^\{\}]*\{[^\}\{]*\})+[^\}]*\}/gi,comments:/\/\*[^*]*\*+([^/][^*]*\*+)*\//gi,urls:/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g,findStyles:/@media *([^\{]+)\{([\S\s]+?)\}$/,only:/(only\s+)?([a-zA-Z]+)\s?/,minw:/\(\s*min\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,maxw:/\(\s*max\-width\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/,minmaxwh:/\(\s*m(in|ax)\-(height|width)\s*:\s*(\s*[0-9\.]+)(px|em)\s*\)/gi,other:/\([^\)]*\)/g},ignore:function(e){Array.prototype.push.apply(this.ignored,e)},reparse:function(e){Array.prototype.push.apply(this.reparsed,e)},update:function(e,t){this.width=void 0===e?null:e,this.callback=void 0===t?null:t,l.update(),this.queueSheets()?this.runQueue():this.applyStyles()},queueSheets:function(){for(var e,t,i,l=null,n=null,o=null,s=!1,r=0,d=0;r<document.styleSheets.length;r++)if(l=(element=document.styleSheets[r].ownerNode).href,e=element.id,t=element.tagName.toLowerCase(),n=element.rel,i=element.media,o=l?l.split("?").shift():e||"style-"+r,s=!1,"style"===t||l&&n&&"stylesheet"===n.toLowerCase()){for(d=0;d<this.ignored.length;d++)if(-1<o.indexOf(this.ignored[d])){s=!0;break}if(!s){for(d=0;d<this.reparsed.length;d++)if(-1<o.indexOf(this.reparsed[d])){this.sheets[o]=null;break}void 0!==this.sheets[o]&&this.sheets[o]||this.queue.push({docSheet:document.styleSheets[r],element:u(element),key:o,tagName:t,href:l,id:e,media:i})}}return this.queue.length},runQueue:function(){var t;this.queue.length?"style"===(t=this.queue.shift()).tagName?(this.parse(t.element.html(),t),this.runQueue()):u.get(t.href,u.proxy(function(e){this.parse(e,t),this.runQueue()},this)).fail(this.runQueue.bind(this)):this.applyStyles()},parse:function(e,t){var i,l=this.regex,n=this.cleanStyles(e),o=n.match(l.media),s=o&&o.length||0,r=!s&&t.media,d=null,e="",a=0,u=0;for(o?e=n.replace(l.media,""):r&&"all"!=t.media?s=1:e=n,this.sheets[t.key]={docSheet:t.docSheet,element:t.element,key:t.key,tagName:t.tagName,href:t.href,id:t.id,all:e,queries:[]},a=0;a<s;a++)for(n=r?(d=t.media,this.convertURLs(n,t.href)):(d=o[a].match(l.findStyles)&&RegExp.$1,RegExp.$2&&this.convertURLs(RegExp.$2,t.href)),i=d.split(","),u=0;u<i.length;u++)"print"==((d=i[u]).split("(")[0].match(l.only)&&RegExp.$2)||d.replace(l.minmaxwh,"").match(l.other)||this.sheets[t.key].queries.push({minw:d.match(l.minw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),maxw:d.match(l.maxw)&&parseFloat(RegExp.$1)+(RegExp.$2||""),styles:n})},applyStyles:function(){var e=u("head"),t={all:"",queries:[]},i=null,l=null,n=null,o=null,s=null,r=null,d=null,a=!1;for(n in this.clearStyles(),this.sheets)if((l=this.sheets[n]).queries.length&&this.width){for(t.all+=l.all,s=0;s<l.queries.length;s++)r=(o=l.queries[s]).minw,d=o.maxw,a=!1,r=r&&parseFloat(r)*(-1<r.indexOf("em")?this.getEmPxValue():1),d=d&&parseFloat(d)*(-1<d.indexOf("em")?this.getEmPxValue():1),r&&this.width>=r&&(!d||this.width<=d)&&(t.queries.push({media:"min",width:r,styles:o.styles}),a=!0),d&&!a&&this.width<=d&&(!r||this.width>=r)&&t.queries.push({media:"max",width:d,styles:o.styles});l.docSheet.disabled=!0}for(""!==t.all&&(i=u('<style class="fl-builder-media-query" data-query="all"></style>'),this.styles.push(i),e.append(i),i.html(t.all)),s=0;s<t.queries.length;s++)o=t.queries[s],i=u('<style class="fl-builder-media-query" data-query="'+o.media+'" data-value="'+o.width+'"></style>'),this.styles.push(i),e.append(i),i.html(o.styles);this.callback&&(this.callback(),this.callback=null)},clearStyles:function(){var e=null,t=this.styles.slice(0);for(e in this.styles=[],this.sheets)this.sheets[e].docSheet.disabled=!1;for(var i=0;i<t.length;i++)t[i].empty(),t[i].remove()},disableStyles:function(e){for(var t,i,l=0;l<this.styles.length;l++)t=(i=this.styles[l]).attr("data-query"),i=parseInt(i.attr("data-value")),"max"===t&&!isNaN(i)&&i<=e&&(this.styles[l][0].sheet.disabled=!0)},enableStyles:function(){for(var e=0;e<this.styles.length;e++)this.styles[e][0].sheet.disabled=!1,this.styles[e][0].sheet.disabled=!0,this.styles[e][0].sheet.disabled=!1},cleanStyles:function(e){var t=this.regex;return e.replace(t.comments,"").replace(t.keyframes,"").replace(t.empty,"")},convertURLs:function(e,t){return t?((t=t.substring(0,t.lastIndexOf("/"))).length&&(t+="/"),e.replace(this.regex.urls,"$1"+t+"$2$3")):e},getEmPxValue:function(){var e,t,i,l,n,o,s,r;return this.emPxValue||(e=null,i=(t=window.document).documentElement,l=t.body,n=t.createElement("div"),o=i.style.fontSize,s=l&&l.style.fontSize,r=!1,n.style.cssText="position:absolute;font-size:1em;width:1em",l||((l=r=t.createElement("body")).style.background="none"),i.style.fontSize="100%",l.style.fontSize="100%",l.appendChild(n),r&&i.insertBefore(l,i.firstChild),e=parseFloat(n.offsetWidth),r?i.removeChild(l):l.removeChild(n),i.style.fontSize=o,l.style.fontSize=s||"",this.emPxValue=e)}},l={_functions:null,update:function(){if(!this._functions)for(var e in this._functions={},t)this._functions[e]=jQuery.fn[e];if(i.width)for(e in t)jQuery.fn[e]=t[e];else for(e in this._functions)jQuery.fn[e]=this._functions[e]}},t={width:function(e){return null!=e?l._functions.width.call(this,e):u.isWindow(this[0])?i.width:l._functions.width.call(this)}};FLBuilderSimulateMediaQuery={ignore:function(e){i.ignore(e)},reparse:function(e){i.reparse(e)},update:function(e,t){i.update(e,t)},disableStyles:function(e){i.disableStyles(e)},enableStyles:function(){i.enableStyles()}}}(jQuery),!function(a){FLBuilderResponsiveEditing={_mode:"default",refreshPreview:function(e){var t;a(".fl-responsive-preview").length&&"default"!==this._mode?("responsive"==this._mode?(t=320<=FLBuilderConfig.global.responsive_breakpoint?320:FLBuilderConfig.global.responsive_breakpoint,FLBuilderSimulateMediaQuery.update(t,e)):"medium"==this._mode?(t=769<=FLBuilderConfig.global.medium_breakpoint?769:FLBuilderConfig.global.medium_breakpoint,FLBuilderSimulateMediaQuery.update(t,e)):"large"==this._mode&&(t=1200<=FLBuilderConfig.global.large_breakpoint?1200:FLBuilderConfig.global.large_breakpoint,FLBuilderSimulateMediaQuery.update(t,e)),FLBuilder._resizeLayout()):e&&e()},_init:function(){FLBuilder.isBlockEditor()||(this._bind(),FLBuilder.UIIFrame.isEnabled())||this._initMediaQueries()},_bind:function(){FLBuilder.addHook("endEditingSession",this._clearPreview),FLBuilder.addHook("didEnterRevisionPreview",this._clearPreview),FLBuilder.addHook("responsiveEditing",this._menuToggleClicked),FLBuilder.addHook("revResponsiveEditing",this._menuToggleClicked),FLBuilder.addHook("preview-init",this._switchAllSettingsToCurrentMode),FLBuilder.addHook("responsive-editing-switched",this._updateSizeText),a("body",window.parent.document).on("click",".fl-field-responsive-toggle",this._settingToggleClicked),a("body",window.parent.document).on("click",".fl-responsive-preview-message button",this._previewToggleClicked)},_initMediaQueries:function(){FLBuilderSimulateMediaQuery.ignore([FLBuilderConfig.pluginUrl,FLBuilderConfig.relativePluginUrl]);var e=a.map(FLBuilderConfig.responsiveIgnore,function(e,t){return[e]});FLBuilderSimulateMediaQuery.ignore(e),FLBuilderSimulateMediaQuery.reparse([FLBuilderConfig.postId+"-layout-draft.css",FLBuilderConfig.postId+"-layout-draft-partial.css",FLBuilderConfig.postId+"-layout-preview.css",FLBuilderConfig.postId+"-layout-preview-partial.css",FLBuilderConfig.postId+"-inline-css","fl-builder-global-css","fl-builder-layout-css"])},_updateSizeText:function(){var e=a(".fl-responsive-preview-message .size"),t="1"===FLBuilderConfig.global.responsive_preview?FLBuilderConfig.global.large_breakpoint:1200,i="1"===FLBuilderConfig.global.responsive_preview?FLBuilderConfig.global.medium_breakpoint:769,l="1"===FLBuilderConfig.global.responsive_preview?FLBuilderConfig.global.responsive_breakpoint:360,n="";a(".fl-responsive-preview").hasClass("fl-preview-responsive")?n=FLBuilderStrings.mobile+" "+l+"px":a(".fl-responsive-preview").hasClass("fl-preview-medium")?n=FLBuilderStrings.medium+" "+i+"px":a(".fl-responsive-preview").hasClass("fl-preview-large")&&(n=FLBuilderStrings.large+" "+t+"px"),e.html("").html(n)},_switchTo:function(e,t){var i=a("html").add("html",window.parent.document),l=a("body"),n=a(FLBuilder._contentClass),o=a(".fl-responsive-preview"),s=a(".fl-responsive-preview-mask"),r=a(".fl-content-placeholder"),d=null;if(FLBuilderResponsiveEditing._mode=e,FLBuilder.UIIFrame.isEnabled())t&&t();else{if("default"==e){if(0===r.length)return;i.removeClass("fl-responsive-preview-enabled"),r.after(n),r.remove(),o.remove(),s.remove()}else 0===o.length?(i.addClass("fl-responsive-preview-enabled"),n.after('<div class="fl-content-placeholder"></div>'),l.prepend(wp.template("fl-responsive-preview")()),a(".fl-responsive-preview").addClass("fl-preview-"+e),a(".fl-responsive-preview-content").append(n)):(o.removeClass("fl-preview-responsive fl-preview-medium"),o.addClass("fl-preview-"+e));"responsive"==e?(d="1"!==FLBuilderConfig.global.responsive_preview&&360<=FLBuilderConfig.global.responsive_breakpoint?360:FLBuilderConfig.global.responsive_breakpoint,n.width(d),FLBuilderSimulateMediaQuery.update(d,t),FLBuilderResponsiveEditing._setMarginPaddingPlaceholders()):"medium"==e?(d="1"!==FLBuilderConfig.global.responsive_preview&&769<=FLBuilderConfig.global.medium_breakpoint?769:FLBuilderConfig.global.medium_breakpoint,n.width(d),FLBuilderSimulateMediaQuery.update(d,t),FLBuilderResponsiveEditing._setMarginPaddingPlaceholders()):"large"==e?(d="1"!==FLBuilderConfig.global.responsive_preview&&1200<=FLBuilderConfig.global.large_breakpoint?1200:FLBuilderConfig.global.large_breakpoint,n.width(d),FLBuilderSimulateMediaQuery.update(d,t),FLBuilderResponsiveEditing._setMarginPaddingPlaceholders()):(n.width(""),FLBuilderSimulateMediaQuery.update(null,t)),this._setContentBackgroundColor()}FLBuilder._resizeLayout(),this._setMarginPaddingPlaceholders(),this._previewFields(),FLBuilder.triggerHook("responsive-editing-switched",e)},_setContentBackgroundColor:function(){var e=a(FLBuilder._contentClass),t=a(".fl-responsive-preview"),i=a(".fl-content-placeholder").parents(),l="#fff",n=0;if(0===t.length)e.css("background-color","");else{for(;n<i.length&&"rgba(0, 0, 0, 0)"==(l=i.eq(n).css("background-color"));n++);e.css("background-color",l)}},_switchToAndScroll:function(i){var e=a(".fl-builder-settings",window.parent.document).data("node"),t=void 0===e?void 0:a(".fl-node-"+e);FLBuilderResponsiveEditing._switchTo(i,function(){var e;void 0!==t&&t&&(a(window),(e=a(".fl-responsive-preview-content")).length?(e.scrollTop(0),e.scrollTop(t.offset().top-150)):a("html, body").scrollTop(t.offset().top-100)),a(".fl-row-bg-parallax").each(function(){var e=a(this),t=e.find("> .fl-row-content-wrap"),e={default:e.data("parallax-image"),medium:e.data("parallax-image-medium"),responsive:e.data("parallax-image-responsive")};void 0!==e[i]&&t.css("background-image","url("+e[i]+")")})})},_switchAllSettingsTo:function(e){var t="dashicons-desktop dashicons-laptop dashicons-tablet dashicons-smartphone";a(".fl-field-responsive-toggle").removeClass(t),a(".fl-field-responsive-setting").hide(),t="default"==e?"dashicons-desktop":"large"==e?"dashicons-laptop":"medium"==e?"dashicons-tablet":"dashicons-smartphone",a(".fl-field-responsive-toggle").addClass(t).data("mode",e),a(".fl-field-responsive-setting-"+e).css("display","inline-block"),FLBuilder._toggleForm()},_switchAllSettingsToCurrentMode:function(){var e=FLBuilderResponsiveEditing;e._switchAllSettingsTo(e._mode),"default"!=e._mode&&e._setMarginPaddingPlaceholders(),FLBuilder.triggerHook("responsive-editing-switched",e._mode)},_setMarginPaddingPlaceholders:function(){var t=FLBuilderResponsiveEditing,e=["top","left","bottom","right"],l={padding:{},margin:{}};["default","large","medium","responsive"].forEach(function(i){l.padding[i]={},l.margin[i]={},e.forEach(function(e){var t="default"===i?e:e+"_"+i;l.padding[i][e]=a("#fl-field-padding .fl-field-responsive-setting-"+i+' input[name="padding_'+t+'"]'),l.margin[i][e]=a("#fl-field-margin .fl-field-responsive-setting-"+i+' input[name="margin_'+t+'"]')})}),e.forEach(function(e){t._setSpacingInputPlaceholder(l,"padding","large","default",e),t._setSpacingInputPlaceholder(l,"padding","medium","large",e),t._setSpacingInputPlaceholder(l,"padding","responsive","medium",e),t._setSpacingInputPlaceholder(l,"margin","large","default",e),t._setSpacingInputPlaceholder(l,"margin","medium","large",e),t._setSpacingInputPlaceholder(l,"margin","responsive","medium",e)}),t._setAutoSpacingPlaceholders(l)},_setSpacingInputPlaceholder:function(e,t,i,l,n){i=e[t][i][n],e=e[t][l][n];i.attr("placeholder")&&!i.data("has-custom-placeholder")||(i.data("has-custom-placeholder",!0),""!==e.val()?i.attr("placeholder",e.val()):e.attr("placeholder")&&i.attr("placeholder",e.attr("placeholder")))},_setAutoSpacingPlaceholders:function(e){var t=FLBuilderConfig.global,i="1"===t.auto_spacing,l=!!a(".fl-builder-row-settings").length,n=(a(".fl-builder-col-settings").length,!!a(".fl-builder-module-settings").length);i&&!n&&(""===t[(i=l?"row":"column")+"_padding_right_responsive"]&&e.padding.responsive.right.attr("placeholder","0"),""===t[i+"_padding_left_responsive"]&&e.padding.responsive.left.attr("placeholder","0"),""===t[i+"_margins_top_responsive"]&&e.margin.responsive.top.attr("placeholder","0"),""===t[i+"_margins_right_responsive"]&&e.margin.responsive.right.attr("placeholder","0"),""===t[i+"_margins_bottom_responsive"]&&e.margin.responsive.bottom.attr("placeholder","0"),""===t[i+"_margins_left_responsive"])&&e.margin.responsive.left.attr("placeholder","0")},_settingToggleClicked:function(){var e=a(this),t="default"==(t=e.data("mode"))?"large":"large"==t?"medium":"medium"==t?"responsive":"default";FLBuilderResponsiveEditing._switchAllSettingsTo(t),FLBuilderResponsiveEditing._switchToAndScroll(t),e.siblings(".fl-field-responsive-setting:visible").find("input").focus()},_menuToggleClicked:function(e){var t=FLBuilderResponsiveEditing._mode,e="responsiveEditing"===e?.namespace,t="default"==t?e?"large":"responsive":"large"==t?e?"medium":"default":"medium"==t?e?"responsive":"large":e?"default":"medium";FLBuilder.MainMenu.hide(),FLBuilderResponsiveEditing._switchAllSettingsTo(t),FLBuilderResponsiveEditing._switchToAndScroll(t)},_previewToggleClicked:function(){var e=a(this).data("mode");FLBuilderResponsiveEditing._switchAllSettingsTo(e),FLBuilderResponsiveEditing._switchToAndScroll(e)},_clearPreview:function(){FLBuilderResponsiveEditing._switchToAndScroll("default")},_previewFields:function(){var n=FLBuilderResponsiveEditing._mode,e=a(".fl-builder-settings:visible");0!==e.length&&void 0!==e.attr("data-node")&&(FLBuilder.triggerHook("responsive-editing-before-preview-fields",n),e.find(".fl-builder-settings-tab").each(function(){var e=a(this);e.css("display","block"),e.find(".fl-field-responsive-setting-"+n+":visible").each(function(){var e=a(this),t=e.closest(".fl-field"),i=t.data("type"),l=t.data("preview"),t=t.find(".fl-field-connection-visible").length;"refresh"!=l.type&&(t?"photo"===i&&"default"!==n&&e.find(".fl-photo-remove").trigger("click"):(e.find("input").trigger("keyup"),e.find("select").trigger("change")))}),e.css("display","")}),FLBuilder.triggerHook("responsive-editing-after-preview-fields",n))}},a(function(){FLBuilderResponsiveEditing._init()})}(jQuery),!function(s){FLBuilderResponsivePreview={enter:function(){FL.Builder.getActions().displayPanel(null),FLBuilder.UIIFrame.exitResponsiveEditing(),this.render()},exit:function(){this.destroy()},switchTo:function(e){var t=FLBuilderConfig.global,i=s("#fl-builder-preview-frame"),l="100%";"responsive"==e?(l="1"!==t.responsive_preview&&360<=t.responsive_breakpoint?360:t.responsive_breakpoint,i.width(l)):"medium"==e?(l="1"!==t.responsive_preview&&769<=t.medium_breakpoint?769:t.medium_breakpoint,i.width(l)):"large"==e&&(l="1"!==t.responsive_preview&&1200<=t.large_breakpoint?1200:t.large_breakpoint,i.width(l)),i.width(l)},render:function(){var e=s("body"),t=FLBuilderConfig.previewUrl,i=s("#fl-builder-preview-mask, #fl-builder-preview-frame"),l=s('<div id="fl-builder-preview-mask"></div>'),n=s('<iframe id="fl-builder-preview-frame" frameborder="0" src="'+t+'"></iframe>');i.remove(),e.append(l),e.append(n),e.css("overflow","hidden"),n.on("load",function(){n.contents().find("a").on("click",FLBuilder._preventDefault)})},_showSize:function(e){var t=s(".fl-builder--preview-actions .size"),i="1"===FLBuilderConfig.global.responsive_preview?FLBuilderConfig.global.large_breakpoint:1200,l="1"===FLBuilderConfig.global.responsive_preview?FLBuilderConfig.global.medium_breakpoint:769,n="1"===FLBuilderConfig.global.responsive_preview?FLBuilderConfig.global.responsive_breakpoint:360,o="";"responsive"===e?o=FLBuilderStrings.mobile+" "+n+"px":"medium"===e?o=FLBuilderStrings.medium+" "+l+"px":"large"===e&&(o=FLBuilderStrings.large+" "+i+"px"),o?t.show():t.hide(),t.html("").html(o)},destroy:function(){s("#fl-builder-preview-mask, #fl-builder-preview-frame").remove(),s("body").css("overflow","visible"),s(".fl-builder--preview-actions .size").html("")}}}(jQuery),!function(a){var u={init:function(){var e=a("body",window.parent.document);e.on("change",".fl-builder-service-select",this._serviceChange),e.on("click",".fl-builder-service-connect-button",this._connectClicked),e.on("change",".fl-builder-service-account-select",this._accountChange),e.on("click",".fl-builder-service-account-delete",this._accountDeleteClicked),e.on("change",".fl-builder-campaign-monitor-client-select",this._campaignMonitorClientChange),e.on("change",".fl-builder-mailchimp-list-select",this._mailChimpListChange),e.on("change",".fl-builder-activecampaign-list_type-select",this._activeCampaignChange)},_startSettingsLoading:function(e){var t=a(".fl-builder-settings",window.parent.document),e=e.closest(".fl-builder-service-settings",window.parent.document),i=a(".fl-builder-service-error",window.parent.document);t.append('<div class="fl-builder-loading"></div>'),e.addClass("fl-builder-service-settings-loading"),i.remove()},_finishSettingsLoading:function(){var e=a(".fl-builder-settings",window.parent.document),t=a(".fl-builder-service-settings-loading",window.parent.document);e.find(".fl-builder-loading").remove(),t.removeClass("fl-builder-service-settings-loading")},_serviceChange:function(){var e=a(".fl-builder-settings",window.parent.document).data("node"),t=a(this),i=t.closest("tr"),l=t.val();i.siblings("tr.fl-builder-service-account-row").remove(),i.siblings("tr.fl-builder-service-connect-row").remove(),i.siblings("tr.fl-builder-service-field-row").remove(),a(".fl-builder-service-error",window.parent.document).remove(),""!==l&&(u._startSettingsLoading(t),FLBuilder.ajax({action:"render_service_settings",node_id:e,service:l},u._serviceChangeComplete))},_serviceChangeComplete:function(e){var e=FLBuilder._jsonParse(e),t=a(".fl-builder-service-settings-loading",window.parent.document);t.find(".fl-builder-service-select-row").after(e.html),u._addAccountDelete(t),u._finishSettingsLoading()},_connectClicked:function(){for(var e,t=a(".fl-builder-settings",window.parent.document).data("node"),i=a(this).closest(".fl-builder-service-settings"),l=i.find(".fl-builder-service-select"),n=i.find(".fl-builder-service-connect-row"),o=i.find(".fl-builder-service-connect-input"),s=null,r=0,d={action:"connect_service",node_id:t,service:l.val(),fields:{}};r<o.length;r++)e=(s=o.eq(r)).attr("name"),d.fields[e]=s.val();n.hide(),u._startSettingsLoading(l),FLBuilder.ajax(d,u._connectComplete)},_connectComplete:function(e){var e=FLBuilder._jsonParse(e),t=a(".fl-builder-service-settings-loading",window.parent.document),i=t.find(".fl-builder-service-select-row"),l=t.find(".fl-builder-service-select"),n=t.find(".fl-builder-service-account-row"),o=t.find(".fl-builder-service-account-select"),s=t.find(".fl-builder-service-connect-row");e.error?(s.show(),(0===o.length?l:o).after('<div class="fl-builder-service-error">'+e.error+"</div>")):(s.remove(),n.remove(),i.after(e.html)),u._addAccountDelete(t),u._finishSettingsLoading()},_accountChange:function(){var e=a(".fl-builder-settings",window.parent.document).data("node"),t=a(this).closest(".fl-builder-service-settings"),i=t.find(".fl-builder-service-select"),l=t.find(".fl-builder-service-account-select"),n=t.find(".fl-builder-service-connect-row"),o=t.find("tr.fl-builder-service-field-row"),s=a(".fl-builder-service-error",window.parent.document),l=l.val(),r=null;n.remove(),o.remove(),s.remove(),"add_new_account"==l?r={action:"render_service_settings",node_id:e,service:i.val(),add_new:!0}:""!==l&&(r={action:"render_service_fields",node_id:e,service:i.val(),account:l}),r&&(u._startSettingsLoading(i),FLBuilder.ajax(r,u._accountChangeComplete)),u._addAccountDelete(t)},_accountChangeComplete:function(e){e=FLBuilder._jsonParse(e);a(".fl-builder-service-settings-loading",window.parent.document).find(".fl-builder-service-account-row").after(e.html),u._finishSettingsLoading()},_addAccountDelete:function(e){var t=e.find(".fl-builder-service-account-select");0<t.length&&(e.find(".fl-builder-service-account-delete").remove(),""!==t.val())&&"add_new_account"!=t.val()&&t.after('<a href="javascript:void(0);" class="fl-builder-service-account-delete">'+FLBuilderStrings.deleteAccount+"</a>")},_accountDeleteClicked:function(){var e=a(this).closest(".fl-builder-service-settings"),t=e.find(".fl-builder-service-select"),e=e.find(".fl-builder-service-account-select");confirm(FLBuilderStrings.deleteAccountWarning)&&(FLBuilder.ajax({action:"delete_service_account",service:t.val(),account:e.val()},u._accountDeleteComplete),u._startSettingsLoading(e))},_accountDeleteComplete:function(){var e=a(".fl-builder-service-settings-loading",window.parent.document).find(".fl-builder-service-select");u._finishSettingsLoading(),e.trigger("change")},_campaignMonitorClientChange:function(){var e=a(".fl-builder-settings",window.parent.document).data("node"),t=a(this).closest(".fl-builder-service-settings"),i=t.find(".fl-builder-service-select"),l=t.find(".fl-builder-service-account-select"),n=a(this),t=t.find(".fl-builder-service-list-select"),n=n.val();0!==t.length&&t.closest("tr").remove(),""!==n&&(u._startSettingsLoading(i),FLBuilder.ajax({action:"render_service_fields",node_id:e,service:i.val(),account:l.val(),client:n},u._campaignMonitorClientChangeComplete))},_campaignMonitorClientChangeComplete:function(e){e=FLBuilder._jsonParse(e);a(".fl-builder-service-settings-loading",window.parent.document).find(".fl-builder-campaign-monitor-client-select").closest("tr").after(e.html),u._finishSettingsLoading()},_mailChimpListChange:function(){var e=a(".fl-builder-settings",window.parent.document).data("node"),t=a(this).closest(".fl-builder-service-settings"),i=t.find(".fl-builder-service-select"),l=t.find(".fl-builder-service-account-select"),t=t.find(".fl-builder-service-list-select");a(".fl-builder-mailchimp-group-select",window.parent.document).closest("tr").remove(),""!==t.val()&&(u._startSettingsLoading(i),FLBuilder.ajax({action:"render_service_fields",node_id:e,service:i.val(),account:l.val(),list_id:t.val()},u._mailChimpListChangeComplete))},_mailChimpListChangeComplete:function(e){e=FLBuilder._jsonParse(e);a(".fl-builder-service-settings-loading",window.parent.document).find(".fl-builder-service-list-select").closest("tr").after(e.html),u._finishSettingsLoading()},_activeCampaignChange:function(){var e=a(".fl-builder-settings",window.parent.document).data("node"),t=a(this).closest(".fl-builder-service-settings"),i=t.find(".fl-builder-service-select"),l=t.find(".fl-builder-service-account-select"),n=t.find(".fl-builder-service-list-select");list_type=t.find('select[name="list_type"]'),0!==n.length&&n.closest("tr").remove(),""!==list_type.val()&&(u._startSettingsLoading(i),FLBuilder.ajax({action:"render_service_fields",node_id:e,service:i.val(),account:l.val(),list_type:list_type.val()},u._activeCampaignTypeChangeComplete))},_activeCampaignTypeChangeComplete:function(e){e=FLBuilder._jsonParse(e);a(".fl-builder-service-settings-loading",window.parent.document).find(".fl-builder-service-field-row").after(e.html),u._finishSettingsLoading()}};a(function(){u.init()})}(jQuery),!function(f){FLBuilder.UIIFrame={resizing:!1,minWidth:280,minHeight:280,maxWidthBuffer:75,maxHeightBuffer:165,previewBreakpoints:{responsive:360,medium:800,large:1200,default:1500},currentBreakpoint:"default",init:function(){this.isEnabled()&&(this.setupJQuery(),this.setupMousetrap(),this.setupReferences(),this.bindEvents(),this.initBreakpointResizing())},isEnabled:function(){return this.isUIWindow()||this.isIFrameWindow()},isUIWindow:function(){return!!f("#fl-builder-ui-iframe").length},isIFrameWindow:function(){return window!==parent.window},getIFrameWindow:function(){return this.isUIWindow()?f("#fl-builder-ui-iframe")[0].contentWindow:window},setupJQuery:function(){jQuery.fn.oldInit=jQuery.fn.init,jQuery.fn.init=function(e,t){var i=new jQuery.fn.oldInit(e,t);return i=i.length||t||"string"!=typeof e?i:new jQuery.fn.oldInit(e,window.parent.document)},window.parent.jQuery.fn.oldTrigger=window.parent.jQuery.fn.trigger,jQuery.fn.oldTrigger=jQuery.fn.trigger,window.parent.jQuery.fn.trigger=function(e,t){return jQuery.fn.oldTrigger.call(this,e,t),window.parent.jQuery.fn.oldTrigger.call(this,e,t)},jQuery.fn.trigger=function(e,t){return window.parent.jQuery.fn.oldTrigger.call(this,e,t),jQuery.fn.oldTrigger.call(this,e,t)}},setupMousetrap:function(){var i=Mousetrap.bind,l=Mousetrap.bindGlobal,e=Mousetrap.pause,t=Mousetrap.unpause;Mousetrap.bind=function(e,t){i.call(Mousetrap,e,t),window.parent.Mousetrap.bind.call(window.parent.Mousetrap,e,t)},Mousetrap.bindGlobal=function(e,t){l.call(Mousetrap,e,t),window.parent.Mousetrap.bindGlobal.call(window.parent.Mousetrap,e,t)},Mousetrap.pause=function(){e.call(Mousetrap),window.parent.Mousetrap.pause.call(window.parent.Mousetrap)},Mousetrap.unpause=function(){t.call(Mousetrap),window.parent.Mousetrap.unpause.call(window.parent.Mousetrap)}},setupReferences:function(){for(var e in window.parent.FL=window.parent.FL||{},window.parent.FL.Builder=window.FL.Builder,window.parent.FLBuilder=window.FLBuilder,window.parent.FLLightbox=window.FLLightbox,window.parent.FLBuilderSettingsForms=window.FLBuilderSettingsForms,FLBuilderGlobalNodeId=window.parent.FLBuilderGlobalNodeId,FLBuilderTour=window.parent.FLBuilderTour,window.parent.FLThemeBuilderFieldConnections=window.FLThemeBuilderFieldConnections,Tether=window.parent.Tether,wp.media=window.parent.wp.media,ace=window.parent.ace,ClipboardJS=window.parent.ClipboardJS,jQuery.fn.select2=window.parent.jQuery.fn.select2,jQuery.fn.validate=window.parent.jQuery.fn.validate,window.parent.location.href.includes("fl_builder_ui")&&(FLBuilderConfig.shouldRefreshOnPublish=!0),window)void 0===parent.window[e]&&(parent.window[e]=window[e])},bindEvents:function(){f(window.parent);var e=f("body",window.parent.document);e.on("mouseleave","#fl-builder-ui-iframe",this.mouseLeave),FLBuilder.addHook("didInitDrag",this.dragInit),FLBuilder.addHook("didStopDrag",this.dragStop),FLBuilder.addHook("didCancelDrag",this.dragStop),FLBuilder.addHook("responsive-editing-switched",this.responsiveEditingSwtiched),e.on("click",".fl-builder-ui-iframe-exit",this.exitResponsiveEditing),e.on("change",".fl-builder-ui-iframe-breakpoint",this.breakpointSelectChanged),e.on("input",".fl-builder-ui-iframe-width",this.breakpointWidthChanged),e.on("input",".fl-builder-ui-iframe-height",this.breakpointHeightChanged),e.on("change",".fl-builder-ui-iframe-scale",this.scaleSelectChanged)},mouseLeave:function(){FLBuilder._removeAllOverlays()},dragInit:function(){f("body",window.parent.document).on("mousemove.fl-builder-iframe",FLBuilder.UIIFrame.dragScroll),f("body").on("mousemove.fl-builder-iframe mouseup.fl-builder-iframe",FLBuilder.UIIFrame.dragMove)},dragStop:function(){f("body",window.parent.document).off("mousemove.fl-builder-iframe"),f("body").off("mousemove.fl-builder-iframe mouseup.fl-builder-iframe")},dragMove:function(e){var t=f("#fl-builder-ui-iframe",window.parent.document),i=t.contents(),l=f("body",window.parent.document);e.pageY=e.pageY-i.scrollTop()+t.offset().top,e.pageX=e.pageX+t.offset().left,l.trigger(e)},dragScroll:function(e){var t=f("#fl-builder-ui-iframe",window.parent.document),i=t.contents(),l=i.height(),t=t.height(),n=i.scrollTop(),e=e.clientY,o=t-50,s=0;e<=50?i.scrollTop((s=n-20)<0?0:s):o<=e&&i.scrollTop((o=l-t)<(s=n+20)?o:s)},responsiveEditingSwtiched:function(){var e=f("html").add("html",window.parent.document),t=f(window.parent),i=f("body",window.parent.document),l=t.width()-FLBuilder.UIIFrame.maxWidthBuffer,t=t.height()-FLBuilder.UIIFrame.maxHeightBuffer,n=f(".fl-builder-ui-iframe-canvas",window.parent.document),o=f(".fl-builder-ui-iframe-breakpoint",window.parent.document),s=f(".fl-builder-ui-iframe-width",window.parent.document),r=f(".fl-builder-ui-iframe-height",window.parent.document),d=FLBuilder.UIIFrame.previewBreakpoints,a=d.responsive,u=d.medium,c=d.large,l=FLBuilderConfig.global.medium_breakpoint<l&&l<d.default?l:d.default;FLBuilderResponsiveEditing._mode===FLBuilder.UIIFrame.currentBreakpoint||(FLBuilder.UIIFrame.currentBreakpoint=FLBuilderResponsiveEditing._mode,FLBuilder.UIIFrame.resizing)||("1"===FLBuilderConfig.global.responsive_preview?(a=FLBuilderConfig.global.responsive_breakpoint,u=FLBuilderConfig.global.medium_breakpoint,c=FLBuilderConfig.global.large_breakpoint):(a>parseInt(FLBuilderConfig.global.responsive_breakpoint)&&(a=FLBuilderConfig.global.responsive_breakpoint),u>parseInt(FLBuilderConfig.global.medium_breakpoint)&&(u=FLBuilderConfig.global.medium_breakpoint),c>parseInt(FLBuilderConfig.global.large_breakpoint)&&(c=FLBuilderConfig.global.large_breakpoint)),"responsive"===FLBuilderResponsiveEditing._mode?(n.width(a),s.val(a),o.val("responsive")):"medium"===FLBuilderResponsiveEditing._mode?(n.width(u),s.val(u),o.val("medium")):"large"===FLBuilderResponsiveEditing._mode?(n.width(c),s.val(c),o.val("large")):(n.width(l),s.val(l),o.val("default")),n.height(t),r.val(t),e.addClass("fl-responsive-preview-enabled"),i.addClass("fl-builder-ui-iframe-responsive-editing"),i.attr("data-fl-builder-breakpoint",FLBuilderResponsiveEditing._mode))},exitResponsiveEditing:function(){var e=f("html").add("html",window.parent.document),t=f("body",window.parent.document),i=f(".fl-builder-ui-iframe-canvas",window.parent.document);FLBuilderResponsiveEditing._switchAllSettingsTo("default"),FLBuilderResponsiveEditing._switchToAndScroll("default"),e.removeClass("fl-responsive-preview-enabled"),t.removeClass("fl-builder-ui-iframe-responsive-editing"),i.width("100%"),i.height("100%"),i.css("transform","")},initBreakpointResizing:function(){f(".fl-builder-ui-iframe-canvas",window.parent.document).resizable({minHeight:FLBuilder.UIIFrame.minHeight,minWidth:FLBuilder.UIIFrame.minWidth,start:FLBuilder.UIIFrame.breakpointResizeStart,resize:FLBuilder.UIIFrame.breakpointResize,stop:FLBuilder.UIIFrame.breakpointResizeStop,handles:{s:f(".fl-builder-ui-iframe-resize-s",window.parent.document),e:f(".fl-builder-ui-iframe-resize-e",window.parent.document),w:f(".fl-builder-ui-iframe-resize-w",window.parent.document)}})},breakpointResizeStart:function(){f("body",window.parent.document).addClass("fl-builder-ui-iframe-resizing"),FLBuilder.UIIFrame.resizing=!0},breakpointResize:function(e,t){var i=f(window.parent),l=parseInt(f(".fl-builder-ui-iframe-scale",window.parent.document).val())/100,n=Math.round((i.width()-FLBuilder.UIIFrame.maxWidthBuffer)/l),i=Math.round((i.height()-FLBuilder.UIIFrame.maxHeightBuffer)/l),l=f(".fl-builder-ui-iframe-width",window.parent.document),o=f(".fl-builder-ui-iframe-height",window.parent.document);t.size.width=2*(t.size.width-t.originalSize.width)+t.originalSize.width,t.size.width<FLBuilder.UIIFrame.minWidth?t.size.width=FLBuilder.UIIFrame.minWidth:t.size.width>n&&(t.size.width=n,t.originalSize.width=n),t.size.height>i&&(t.size.height=i),l.val(t.size.width).trigger("input"),o.val(t.size.height).trigger("input"),FLBuilder.UIIFrame.resizing=!0},breakpointResizeStop:function(){f("body",window.parent.document).removeClass("fl-builder-ui-iframe-resizing"),FLBuilder.UIIFrame.resizing=!1},breakpointSelectChanged:function(){var e=f(this).val();FLBuilderResponsiveEditing._switchAllSettingsTo(e),FLBuilderResponsiveEditing._switchToAndScroll(e)},breakpointWidthChanged:function(){var e=f("body",window.parent.document),t=f(this).val(),i=f(".fl-builder-ui-iframe-canvas",window.parent.document),l=f(".fl-builder-ui-iframe-breakpoint",window.parent.document);FLBuilder.UIIFrame.resizing=!0,t&&t<=parseInt(FLBuilderConfig.global.responsive_breakpoint)?"responsive"!==FLBuilderResponsiveEditing._mode&&(FLBuilderResponsiveEditing._switchAllSettingsTo("responsive"),FLBuilderResponsiveEditing._switchTo("responsive"),l.val("responsive"),e.attr("data-fl-builder-breakpoint","responsive")):t&&t<=parseInt(FLBuilderConfig.global.medium_breakpoint)?"medium"!==FLBuilderResponsiveEditing._mode&&(FLBuilderResponsiveEditing._switchAllSettingsTo("medium"),FLBuilderResponsiveEditing._switchTo("medium"),l.val("medium"),e.attr("data-fl-builder-breakpoint","medium")):t&&t<=parseInt(FLBuilderConfig.global.large_breakpoint)?"large"!==FLBuilderResponsiveEditing._mode&&(FLBuilderResponsiveEditing._switchAllSettingsTo("large"),FLBuilderResponsiveEditing._switchTo("large"),l.val("large"),e.attr("data-fl-builder-breakpoint","large")):"default"!==FLBuilderResponsiveEditing._mode&&(FLBuilderResponsiveEditing._switchAllSettingsTo("default"),FLBuilderResponsiveEditing._switchTo("default"),l.val("default"),e.attr("data-fl-builder-breakpoint","default")),i.width(t),FLBuilder.UIIFrame.resizing=!1},breakpointHeightChanged:function(){var e=f(this).val();f(".fl-builder-ui-iframe-canvas",window.parent.document).height(e)},scaleSelectChanged:function(){var e=f(window.parent),t=e.width()-FLBuilder.UIIFrame.maxWidthBuffer,e=e.height()-FLBuilder.UIIFrame.maxHeightBuffer,i=f(".fl-builder-ui-iframe-canvas",window.parent.document),l=f(this),n=l.val();l.find('option[data-custom="1"]').remove(),"fit"===n&&(n=Math.round(Math.min(100,t/i.width()*100,e/i.height()*100)),l.find('option[value="'+n+'"]').length||l.prepend('<option value="'+n+'" data-custom="1" >'+n+"%</option>")),l.val(n),i.css("transform","scale("+n+"%)")}}}(jQuery),!function(r,n){String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(t=t||0,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var i=this.toString(),i=(("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>i.length)&&(t=i.length),t-=e.length,i.indexOf(e,t));return-1!==i&&i===t}),FLExtendableObject={create:function(e){var t=Object.create(this),t=r.extend(t,e);return r(this).trigger("onCreate"),t}},r.fn.switchClass=function(n,e){return this.each(function(){return r(this).removeClass(function(e,t){var i=[],l=t.split(" ");for(e in l)l[e].startsWith(n)&&i.push(l[e]);return i.join(" ")}),r(this).addClass(n+e)})};var e={init:function(){n.addHook("cancelTask",this.onCancelTask.bind(this)),n.addHook("showSavedMessage",this.onSaveShortcut.bind(this)),n.addHook("goToNextTab",this.onNextPrevTabShortcut.bind(this,"next")),n.addHook("goToPrevTab",this.onNextPrevTabShortcut.bind(this,"prev")),n.addHook("endEditingSession",this.onEndEditingSession.bind(this)),n.addHook("restartEditingSession",this.onRestartEditingSession.bind(this)),this.setDefaultKeyboardShortcuts()},addShortcut:function(e,t,i){e=r.proxy(this,"onTriggerKey",e);i?Mousetrap.bindGlobal(t,e):Mousetrap.bind(t,e)},reset:function(){n.UIIFrame.isEnabled()||Mousetrap.reset()},setDefaultKeyboardShortcuts:function(){for(var e in this.reset(),FLBuilderConfig.keyboardShortcuts){var t=FLBuilderConfig.keyboardShortcuts[e].keyCode,i=FLBuilderConfig.keyboardShortcuts[e].isGlobal;this.addShortcut(e,t,i)}},onTriggerKey:function(e,t){n.triggerHook(e),t.preventDefault?t.preventDefault():t.returnValue=!1},onCancelTask:function(){i.isPreviewing?i.endPreview():t.isShowing?t.hide():n.ContentPanel.isShowing?n.ContentPanel.hide():n.UIIFrame.isEnabled()&&n.UIIFrame.exitResponsiveEditing()},pause:function(){Mousetrap.pause()},unpause:function(){Mousetrap.unpause()},onEndEditingSession:function(){FL.Builder.data.getSystemActions().setIsEditing(!1),document.documentElement.classList.remove("fl-builder-assistant-visible"),this.reset(),this.addShortcut("restartEditingSession","mod+e")},onRestartEditingSession:function(){FL.Builder.data.getSystemActions().setIsEditing(!0);var e=FL.Builder.data.getSystemState().currentPanel;"assistant"===e&&document.documentElement.classList.add("fl-builder-assistant-visible"),this.reset(),this.setDefaultKeyboardShortcuts()},onSaveShortcut:function(){var e;e=n.SaveManager.layoutNeedsPublish()?FLBuilderStrings.savedStatus.hasAlreadySaved:FLBuilderStrings.savedStatus.nothingToSave,n.SaveManager.showStatusMessage(e),setTimeout(function(){n.SaveManager.resetStatusMessage()},2e3)},onNextPrevTabShortcut:function(e,t){var i=r(".fl-lightbox:visible",window.parent.document),l=i.find(".fl-builder-settings-tabs a");0<i.length&&(i=l.filter("a.fl-active"),("next"==e?i.is(l.last())?l.first():i.next("a"):i.is(l.first())?l.last():i.prev("a")).trigger("click")),n._calculateSettingsTabsOverflow(),t.preventDefault()}},t=FLExtendableObject.create({isShowing:!1,init:function(){this.$el=r(".fl-builder-publish-actions",window.parent.document),this.$defaultBarButtons=r(".fl-builder-bar-actions",window.parent.document),this.$clickAwayMask=r(".fl-builder-publish-actions-click-away-mask",window.parent.document),this.$doneBtn=this.$defaultBarButtons.find(".fl-builder-done-button"),this.$doneBtn.on("click",this.onDoneTriggered.bind(this)),this.$actions=this.$el.find(".fl-builder-button"),this.$actions.on("click touchend",this.onActionClicked.bind(this)),n.addHook("triggerDone",this.onDoneTriggered.bind(this));var e=this.hide.bind(this);n.addHook("cancelPublishActions",e),n.addHook("endEditingSession",e),this.$clickAwayMask.on("click",e)},onDoneTriggered:function(){n.SaveManager.layoutNeedsPublish()?this.show():FLBuilderConfig.shouldRefreshOnPublish?n._exit():n._exitWithoutRefresh()},show:function(){this.isShowing||n._triggerSettingsSave(!1,!0)&&(this.$el.removeClass("is-hidden"),this.$defaultBarButtons.css("opacity","0"),this.$clickAwayMask.show(),this.isShowing=!0,n.triggerHook("didShowPublishActions"))},hide:function(){this.isShowing&&(this.$el.addClass("is-hidden"),this.$defaultBarButtons.css("opacity","1"),this.$clickAwayMask.hide(),this.isShowing=!1)},onActionClicked:function(e){e=r(e.currentTarget).data("action");switch(e){case"dismiss":this.hide();break;case"discard":this.hide(),i.muteToolbar(),n._discardButtonClicked();break;case"publish":this.hide(),i.muteToolbar(),n._publishButtonClicked(),n._destroyOverlayEvents();break;default:this.hide(),i.muteToolbar(),n._draftButtonClicked()}n.triggerHook(e+"ButtonClicked")}}),i={isPreviewing:!1,init:function(){this.$el=r("body",window.parent.document),this.$mainToolbar=r(".fl-builder-bar",window.parent.document),this.$mainToolbarContent=this.$mainToolbar.find(".fl-builder-bar-content",window.parent.document),this.$wpAdminBar=r("#wpadminbar"),this.$endPreviewBtn=r(".fl-builder--preview-actions .end-preview-btn",window.parent.document),n.addHook("endEditingSession",this.endEditingSession.bind(this)),n.addHook("previewLayout",this.togglePreview.bind(this)),this.$endPreviewBtn.on("click",this.endPreview.bind(this)),this.$deviceIcons=r(".fl-builder--preview-actions i",window.parent.document),this.$deviceIcons.on("click",this.onDeviceIconClick.bind(this));this.$wpAdminBar.find("#wp-admin-bar-fl-builder-frontend-edit-link > a, #wp-admin-bar-fl-theme-builder-frontend-edit-link > a").on("click",this.onClickPageBuilderToolbarLink.bind(this)),r("#wpadminbar a").attr("tabindex","-1");var e=this.restartEditingSession.bind(this);n.addHook("restartEditingSession",e),n.addHook("didHideAllLightboxes",this.unmuteToolbar.bind(this)),n.addHook("didCancelDiscard",this.unmuteToolbar.bind(this)),n.addHook("didEnterRevisionPreview",this.hide.bind(this)),n.addHook("didExitRevisionPreview",this.show.bind(this)),n.addHook("didPublishLayout",this.onPublish.bind(this))},endEditingSession:function(){n._destroyOverlayEvents(),n._removeAllOverlays(),n._removeEmptyRowAndColHighlights(),n._unbindEvents(),r("html").add("html",window.parent.document).removeClass("fl-builder-edit").addClass("fl-builder-show-admin-bar"),r("body").add("body",window.parent.document).removeClass("fl-builder-edit"),r("#wpadminbar a").attr("tabindex",null),r(n._contentClass).removeClass("fl-builder-content-editing"),this.hideMainToolbar(),n.ContentPanel.hide(),FLBuilderLayout.init()},restartEditingSession:function(e){n._initTemplateSelector(),n._bindOverlayEvents(),n._highlightEmptyCols(),n._rebindEvents(),r("html").add("html",window.parent.document).addClass("fl-builder-edit").removeClass("fl-builder-show-admin-bar"),r("body").add("html",window.parent.document).addClass("fl-builder-edit"),r("#wpadminbar a").attr("tabindex","-1"),r(n._contentClass).addClass("fl-builder-content-editing"),this.showMainToolbar(),e.preventDefault()},onClickPageBuilderToolbarLink:function(e){n.triggerHook("restartEditingSession"),e.preventDefault()},onPublish:function(){this.$wpAdminBar.find("#wp-admin-bar-fl-builder-frontend-edit-link > a span").css("color","#6bc373")},onPublishCacheClear:function(){n.ajax({action:"clear_cache_for_layout"},function(e){console.log(e)})},hide:function(){r("html").hasClass("fl-builder-edit")&&(n._unbindEvents(),n._destroyOverlayEvents(),n._removeAllOverlays(),r("html").add("html",window.parent.document).removeClass("fl-builder-edit"),r("body").removeClass("admin-bar"),this.hideMainToolbar(),n.ContentPanel.hide(),FLBuilderLayout.init(),n.triggerHook("didHideEditingUI"))},show:function(){r("html").hasClass("fl-builder-edit")||(n._rebindEvents(),n._bindOverlayEvents(),this.showMainToolbar(),FLBuilderResponsiveEditing._switchTo("default"),r("html").add("html",window.parent.document).addClass("fl-builder-edit"),r("body").addClass("admin-bar"),n.triggerHook("didShowEditingUI"))},beginPreview:function(){n._triggerSettingsSave(!1,!0)&&(this.isPreviewing=!0,this.hide(),r("html").add("html",window.parent.document).addClass("fl-builder-preview"),r("html, body").add("html, body",window.parent.document).removeClass("fl-builder-edit"),n._removeEmptyRowAndColHighlights(),n.triggerHook("didBeginPreview"),FLBuilderResponsivePreview.enter())},endPreview:function(){this.isPreviewing=!1,this.show(),n._highlightEmptyCols(),FLBuilderResponsivePreview.exit(),r("html").add("html",window.parent.document).removeClass("fl-builder-preview"),r("html, body").add("html, body",window.parent.document).addClass("fl-builder-edit")},togglePreview:function(){this.isPreviewing?this.endPreview():this.beginPreview()},hideMainToolbar:function(){this.$mainToolbar.addClass("is-hidden"),r("html",window.parent.document).removeClass("fl-builder-is-showing-toolbar")},showMainToolbar:function(){this.unmuteToolbar(),this.$mainToolbar.removeClass("is-hidden"),r("html",window.parent.document).addClass("fl-builder-is-showing-toolbar")},onDeviceIconClick:function(e){e=r(e.target).data("mode");FLBuilderResponsivePreview.switchTo(e),FLBuilderResponsivePreview._showSize(e)},muteToolbar:function(){this.$mainToolbarContent.addClass("is-muted"),n._hideTipTips()},unmuteToolbar:function(){this.$mainToolbarContent.removeClass("is-muted")}},l={isEditing:!0,init:function(){history.pushState&&(n.addHook("endEditingSession",this.onLeaveBuilder.bind(this)),n.addHook("restartEditingSession",this.onEnterBuilder.bind(this)))},onEnterBuilder:function(){history.replaceState({},document.title,FLBuilderConfig.editUrl),FL.Builder.data.getSystemActions().setIsEditing(!0),this.isEditing=!0},onLeaveBuilder:function(){history.replaceState({},document.title,FLBuilderConfig.url),FL.Builder.data.getSystemActions().setIsEditing(!1),this.isEditing=!1}},o={$row:null,$rowContent:null,row:null,drag:{},init:function(){var e;this.userCanResize()&&((e=r(n._contentClass)).on("mouseenter touchstart",".fl-row, .fl-block-overlay",this.onDragHandleHover.bind(this)),e.on("mousedown touchstart",".fl-block-row-resize",this.onDragHandleDown.bind(this)))},userCanResize:function(){return FLBuilderConfig.rowResize.userCanResizeRows},onDragHandleHover:function(e){var t,i,l,n,o,s;this.drag.isDragging||(t=this,i=r(e.target).closest(".fl-row"),l=i.data("node"),n=r(".fl-builder-row-settings[data-node="+l+"]",window.parent.document),o=n.find("[name=max_content_width_unit]"),s="px",t.onSettingsReady(l,function(e){o.length?s=o.val():void 0!==e&&(s=e.max_content_width_unit),t.$row=i,t.$rowContent=t.$row.find(".fl-row-content"),t.row={node:l,form:n,unit:s,isFixedWidth:t.$row.hasClass("fl-row-fixed-width"),parentWidth:("vw"===s?r(window):t.$row.parent()).width()},t.drag={edge:null,isDragging:!1,originalPosition:null,originalWidth:null,calculatedWidth:null,operation:null},t.row.isFixedWidth?t.drag.originalWidth=t.$row.width():t.drag.originalWidth=t.$rowContent.width(),t.dragInit()}))},onSettingsReady:function(e,t){var i=void 0!==FLBuilderSettingsConfig.nodes?FLBuilderSettingsConfig.nodes:null;null!==i&&void 0!==i[e]?(t(i[e]),null!=o._mouseEnterTimeout&&(clearTimeout(o._mouseEnterTimeout),o._mouseEnterTimeout=null)):(clearTimeout(o._mouseEnterTimeout),o._mouseEnterTimeout=setTimeout(this.onSettingsReady.bind(this),350,e,t))},onDragHandleDown:function(){r("body").add("body",window.parent.document).addClass("fl-builder-row-resizing"),null!=o._mouseEnterTimeout&&(clearTimeout(o._mouseEnterTimeout),o._mouseEnterTimeout=null)},dragInit:function(e){this.$row.find(".fl-block-row-resize").draggable({axis:"x",start:this.dragStart.bind(this),drag:this.dragging.bind(this),stop:this.dragStop.bind(this)})},dragStart:function(e,t){var i=r("body").add("body",window.parent.document),t=r(t.helper);this.drag.isDragging=!0,this.row.isFixedWidth?this.drag.originalWidth=this.$row.width():this.drag.originalWidth=this.$rowContent.width(),t.hasClass("fl-block-col-resize-e")&&(this.drag.edge="e",this.$feedback=t.find(".fl-block-col-resize-feedback-left")),t.hasClass("fl-block-col-resize-w")&&(this.drag.edge="w",this.$feedback=t.find(".fl-block-col-resize-feedback-right")),i.addClass("fl-builder-row-resizing"),n._colResizing=!0,n._destroyOverlayEvents(),n._closePanel()},dragging:function(e,t){var i=t.position.left,t=t.originalPosition.left,l=this.drag.originalWidth,n=this.drag.edge,o=FLBuilderConfig.rowResize.minAllowedWidth,s=FLBuilderConfig.rowResize.maxAllowedWidth;FLBuilderConfig.isRtl&&(n="w"==n?"e":"w"),this.drag.operation=i<t?"w"===n?"+":"-":"e"===n?"+":"-",n=Math.abs(t-i),"+"===this.drag.operation?this.drag.calculatedWidth=l+2*n:this.drag.calculatedWidth=l-2*n,!1!==o&&this.drag.calculatedWidth<o&&(this.drag.calculatedWidth=o),!1!==s&&this.drag.calculatedWidth>s&&(this.drag.calculatedWidth=s),this.row.isFixedWidth&&this.$row.css("max-width",this.drag.calculatedWidth+"px"),this.$rowContent.css("max-width",this.drag.calculatedWidth+"px"),"px"!==this.row.unit&&(this.drag.calculatedWidth=Math.round(this.drag.calculatedWidth/this.row.parentWidth*100)),_.isUndefined(this.$feedback)||this.$feedback.html(this.drag.calculatedWidth+this.row.unit).show(),this.row.form.length&&this.row.form.find("[name=max_content_width]").val(this.drag.calculatedWidth),requestAnimationFrame(()=>{FL.Builder.data.getLayoutActions().resizeRowContent(this.row.node,this.drag.calculatedWidth,!1)})},dragStop:function(e,t){this.drag.isDragging=!1,_.isUndefined(this.$feedback)||this.$feedback.hide(),FL.Builder.data.getLayoutActions().resizeRowContent(this.row.node,this.drag.calculatedWidth),n._bindOverlayEvents(),r("body").add("body",window.parent.document).removeClass("fl-builder-row-resizing"),requestAnimationFrame(()=>{r(".fl-block-overlay").each(function(){n._buildOverlayOverflowMenu(r(this))})}),setTimeout(function(){n._colResizing=!1},50),n.triggerHook("didResizeRow",{rowId:this.row.node,rowWidth:this.drag.calculatedWidth})}},s={templateName:"fl-toolbar",init:function(){this.template=wp.template(this.templateName),this.render(),this.initTipTips(),this.$el.find(".fl-builder-content-panel-button").on("click",n._togglePanel),this.$el.find(".fl-builder-buy-button").on("click",n._upgradeClicked),this.$el.find(".fl-builder-upgrade-button").on("click",n._upgradeClicked),this.$el.find("#fl-builder-toggle-notifications").on("click",this.onNotificationsButtonClicked.bind(this)),n.addHook("notificationsLoaded",this.onNotificationsLoaded.bind(this))},render:function(e){e=r(this.template(e));this.$el=e,this.el=e.get(0),i.$mainToolbar=this.$el,r("html",window.parent.document).addClass("fl-builder-is-showing-toolbar"),r("body",window.parent.document).prepend(e)},initTipTips:function(){r(".fl-builder-publish-actions .fl-builder-button-group .fl-builder-button",window.parent.document).tipTip({defaultPosition:"bottom",edgeOffset:6})},onNotificationsButtonClicked:function(){n.triggerHook("toggleNotifications")},onNotificationsLoaded:function(){r("body").add("body",window.parent.document).removeClass("fl-builder-has-new-notifications");n.ajax({action:"fl_builder_notifications",read:!0})}};r(function(){n.ContentPanel.init(),FLBuilderConfig.simpleUi||n.MainMenu.init(),FLBuilderConfig.showToolbar?(s.init(),n.ContentPanel.alignPanelArrow()):r("html").add("html",window.parent.document).addClass("fl-builder-no-toolbar"),e.init(),i.init(),l.init(),o.init(),t.init(),n.triggerHook("didInitUI")})}(jQuery,FLBuilder),!function(n,l){var o=FLExtendableObject.create({templateName:"fl-main-menu-panel-view",name:"Untitled View",isShowing:!1,isRootView:!1,items:{},init:function(){this.template=wp.template(this.templateName)},render:function(){return this.template(this)},bindEvents:function(){this.$items=this.$el.find(".fl-builder--menu-item")},show:function(){this.$el.addClass("is-showing"),this.isShowing=!0},hide:function(){this.$el.removeClass("is-showing"),this.isShowing=!1},transitionIn:function(e){requestAnimationFrame(this.show.bind(this))},transitionOut:function(e){this.hide()}}),t=FLExtendableObject.create({templateName:"fl-main-menu-panel",template:null,menu:null,views:{},viewNavigationStack:[],isShowing:!1,shouldShowTabs:!1,init:function(){for(var e in this.template=wp.template(this.templateName),n("body",window.parent.document).prepend(this.template(this)),this.$el=n(".fl-builder--main-menu-panel",window.parent.document),this.$el.find(".fl-builder--main-menu-panel-views").html(""),FLBuilderConfig.mainMenu)this.renderPanel(e);n("body",window.parent.document).on("click",".fl-builder--main-menu-panel .pop-view",this.goToPreviousView.bind(this)),n("body",window.parent.document).on("click","#fl-ui-root .fl-notifications-panel .back-menu",this.goToBackView.bind(this)),this.$tabs=this.$el.find(".fl-builder--tabs > span"),this.$tabs.on("click",this.onItemClick.bind(this)),this.$barTitle=n(".fl-builder-bar-title",window.parent.document),n("body",window.parent.document).on("click",".fl-builder-bar-title",this.toggle.bind(this));var t=this.hide.bind(this);l.addHook("didShowPublishActions",t),l.addHook("didBeginSearch",t),l.addHook("didBeginPreview",t),l.addHook("didShowContentPanel",t),l.addHook("endEditingSession",t),l.addHook("didFocusSearchBox",t),l.addHook("didEnterRevisionPreview",t),l.addHook("didFailSettingsSave",t),l.addHook("showKeyboardShortcuts",t),this.$mask=n(".fl-builder--main-menu-panel-mask",window.parent.document),this.$mask.on("click",t),i.init(),s.init()},renderPanel:function(e){var t,i=this.views[e],l=FLBuilderConfig.mainMenu[e];l.handle=e,(l=o.create(l)).init(),t=n(l.render()),l.$el=t,n(".fl-builder--main-menu-panel-views",window.parent.document).append(t),l.bindEvents(),l.$el.find(".fl-builder--menu-item").on("click",this.onItemClick.bind(this)),void 0!==i&&(i.$el.remove(),i.isShowing)&&(this.currentView=l).show(),l.isRootView&&(this.rootView=l,this.currentView=l),this.views[e]=l},show:function(){this.isShowing||(this.$el.addClass("is-showing"),this.$barTitle.addClass("is-showing-menu"),this.currentView.transitionIn(),this.isShowing=!0,this.$mask.show(),l.triggerHook("didOpenMainMenu"))},hide:function(){this.isShowing&&(this.$el.removeClass("is-showing"),this.$barTitle.removeClass("is-showing-menu"),this.isShowing=!1,this.resetViews(),this.$mask.hide())},toggle:function(){this.isShowing?this.hide():n("#fl-ui-root .fl-notifications-panel").length?(this.hide(),l.triggerHook("toggleNotifications")):this.show()},onItemClick:function(e){var t=n(e.currentTarget,window.parent.document);switch(t.data("type")){case"view":var i=t.data("view");this.goToView(i);break;case"event":i=t.data("event");l.triggerHook(i,t)}},goToView:function(e){var t=this.currentView,e=this.views[e];t.transitionOut(),e.transitionIn(),this.currentView=e,this.viewNavigationStack.push(t)},goToBackView:function(){l.triggerHook("toggleNotifications"),t.show()},goToPreviousView:function(){var e=this.currentView,t=this.viewNavigationStack.pop();e.transitionOut(!0),t.transitionIn(!0),this.currentView=t,n(".fl-builder-bar-title-caret",window.parent.document).focus()},resetViews:function(){this.currentView!=this.rootView&&(this.currentView.hide(),this.rootView.show(),this.currentView=this.rootView,this.viewNavigationStack=[])}}),i=(l.MainMenu=t,{init:function(){var e;l.addHook("saveTemplate",this.saveTemplate.bind(this)),l.addHook("saveCoreTemplate",this.saveCoreTemplate.bind(this)),l.addHook("duplicateLayout",this.duplicateLayout.bind(this)),l.addHook("showLayoutSettings",this.showLayoutSettings.bind(this)),l.addHook("showGlobalSettings",this.showGlobalSettings.bind(this)),l.addHook("showGlobalStyles",this.showGlobalStyles.bind(this)),l.addHook("toggleUISkin",this.toggleUISkin.bind(this)),l.addHook("clearLayoutCache",this.clearLayoutCache.bind(this)),l.addHook("launchThemerLayouts",this.launchThemerLayouts.bind(this)),l.addHook("toggleOutlinePanel",this.toggleOutlinePanel.bind(this)),l.addHook("toggleMediaLibrary",this.toggleMediaLibrary.bind(this)),l.addHook("showNotifications",this.showNotifications.bind(this)),"FL"in window&&"Builder"in FL&&(e=FL.Builder.data.getSystemActions(),l.addHook("showKeyboardShortcuts",function(){e.setShouldShowShortcuts(!0)}))},saveTemplate:function(){l._saveUserTemplateClicked(),t.hide()},saveCoreTemplate:function(){FLBuilderCoreTemplatesAdmin._saveClicked(),t.hide()},duplicateLayout:function(){l._duplicateLayoutClicked(),t.hide()},showGlobalSettings:function(){l._globalSettingsClicked(),t.hide()},showGlobalStyles:function(){l._globalStylesClicked(),t.hide()},showNotifications:function(){l.triggerHook("toggleNotifications"),t.hide()},showLayoutSettings:function(){l._layoutSettingsClicked(),t.hide()},clearLayoutCache:function(){l.ajax({action:"clear_cache"},function(){location.href=FLBuilderConfig.editUrl}),l.showAjaxLoader(),t.hide()},toggleUISkin:function(e){var t=FL.Builder.data.getSystemState().colorScheme;let i="";i="light"===t?"dark":"dark"===t?"auto":"light",FL.Builder.data.getSystemActions().setColorScheme(i),n(".current-mode").html("("+i+")")},launchThemerLayouts:function(){FLBuilderConfig.lite?l._showProMessage("Themer Layouts"):window.open(FLBuilderConfig.themerLayoutsUrl),t.hide()},toggleOutlinePanel:function(){FL.Builder.togglePanel("outline")},toggleMediaLibrary:function(){if(!FLBuilderConfig.userCaps.canUpload)return l.alert(FLBuilderStrings.uploadBlocked),!1;var e=wp.media({multiple:!1});e.fl_changed=!1,e.on("open",function(){n(e.el).find(".media-toolbar").hide()}),e.on("selection:toggle",function(){n(e.el).find("button.delete-attachment, a.edit-attachment").on("click",function(){e.fl_changed=!0}),n(e.el).find("textarea, input").on("change",function(){e.fl_changed=!0})}),e.on("library:selection:add",function(){e.fl_changed=!0}),e.on("closed, close, escape",function(){e.fl_changed&&window.parent.location.reload()}),t.hide(),e.open()}}),s={init:function(){l.addHook("beginTour",this.onStartTourClicked.bind(this))},onStartTourClicked:function(){FLBuilderTour.start(),t.hide()}}}(jQuery,FLBuilder),!function(o,n){var s=FLExtendableObject.create({handle:"",name:"",panel:null,shouldShowTabItem:!0,isShowing:!1,views:{},activeView:null,defaultView:null,categorySelector:null,init:function(e){this.categorySelector=i.create({handle:"selector-"+this.handle,tab:this,items:[]}),this.categorySelector.init(),o(this.categorySelector).on("categorySelected",this.onViewSelected.bind(this));var t;e.views;this.initViews(e.views),0===Object.keys(this.views).length&&this.addView(t={handle:"noViews",name:"No Views",templateName:"fl-content-panel-no-view"}),this.activeView||(e=Object.keys(this.views)[0],t=this.views[e],this.activeView=t),this.defaultView=this.activeView,o(this.panel).on("afterRender",this.renderView.bind(this,this.activeView)),o(this.panel).on("onShow onShowTab",this.initScroller.bind(this)),n.addHook("contentItemsChanged",this.onLibraryDataChanged.bind(this))},initViews:function(e){for(var t in e){t=e[t];this.categorySelector.addItem(t),"separator"!==t.type&&this.addView(t)}},addView:function(e){var t=l;switch(this.handle){case"modules":t=r;break;case"rows":t=d;break;case"templates":t=a;break;case"saved":t=u;break;default:t=l}var e=(t=_.isNull(this.viewController)||_.isUndefined(this.viewController)?t:window[this.viewController]).create(e),i=e.handle;e.init(),(this.views[i]=e).isShowing&&(this.activeView=e)},renderView:function(e){var t;this.$el=this.panel.$el.find('.fl-builder--panel-view[data-tab="'+this.handle+'"]'),e=_.isObject(e)?e:this.views[e],_.isObject(e)&&_.isFunction(e.render)&&(t=e.render(),this.$el.find(".fl-nanoscroller-content").html(t),this.activeView=e,n._initSortables(),this===this.panel.activeTab&&this.renderGroupSelector(),this.initScroller(),this.$el.find(".fl-nanoscroller-content").scrollTop(0))},initScroller:function(){this.$el.nanoScroller({documentContext:window.parent.document,alwaysVisible:!0,preventPageScrolling:!0,paneClass:"fl-nanoscroller-pane",sliderClass:"fl-nanoscroller-slider",contentClass:"fl-nanoscroller-content"})},show:function(){o(this.activeView).trigger("onBeforeShow"),this.renderGroupSelector(),this.isShowing=!0,this.$el.addClass("is-showing"),this.$el.find(".fl-nanoscroller-content").scrollTop(0)},hide:function(){this.isShowing=!1,this.$el.removeClass("is-showing"),this.activeView!==this.defaultView&&this.renderView(this.defaultView),_.isObject(this.categorySelector)&&this.categorySelector.close()},renderGroupSelector:function(){var e,t=this.panel.$groupSelect,i=this.panel.$el.find(".fl-builder-panel-search");this.isSearchEnabled?i.show():i.hide(),1<Object.keys(this.views).length&&!_.isUndefined(this.categorySelector)?(e=this.categorySelector.render(),this.panel.$el.find(".fl-builder-content-group-select"),t.html(e),t.show(),this.panel.$el.removeClass("single-view")):(t.hide(),i.hide(),this.panel.$el.addClass("single-view"))},onViewSelected:function(e,t){this.renderView(t),this.categorySelector.close()},onLibraryDataChanged:function(){this.renderView(this.activeView)}}),l=FLExtendableObject.create({templateName:"",name:"",handle:"",query:null,init:function(){this.template=wp.template(this.templateName),o(this).on("afterRender",this.bindEvents.bind(this)),o(this).trigger("afterInit")},filterTemplateData:function(e){return _.isNull(this.query)||_.isUndefined(this.query)||(e.queryResults=n.Search.byQuery(this.query)),e},render:function(){o(this).trigger("beforeRender");var e=this.filterTemplateData(this),e=o(this.template(e));return this.$el=e,o(this).trigger("afterRender"),e},bindEvents:function(){},transitionIn:function(){},transitionOut:function(){}}),r=l.create({templateName:"fl-content-panel-modules-view",bindEvents:function(){this.$sections=this.$el,this.$items=this.$el.find(".fl-builder-block, .fl-builder-blocks-section-title")}}),d=l.create({templateName:"fl-content-panel-row-templates-view",bindEvents:function(){this.$items=this.$el.find(".fl-builder-block, .fl-builder-blocks-section-title")}}),a=l.create({templateName:"fl-content-panel-templates-view",bindEvents:function(){this.$items=this.$el.find(".fl-builder--template-collection-item"),this.$items.on("click",this.onTemplateClick.bind(this)),this.$userTemplateSections=o(".fl-user-templates",window.parent.document),this.$userTemplates=this.$el.find(".fl-user-template, .fl-builder--save-new-user-template"),this.$saveNewTemplateInput=this.$el.find('.fl-save-control input[name="template-name"]'),this.$saveNewTemplateCat=this.$el.find('.fl-save-control input[name="template-category"]'),this.$saveNewTemplateBtn=this.$el.find(".fl-save-control button"),this.$saveNewMask=this.$el.find(".fl-save-control-mask"),this.$saveNewTemplateInput.on("focus",this.onSaveInputFocus.bind(this)),this.$saveNewTemplateInput.on("keyup",this.onSaveInputKeyup.bind(this)),this.$saveNewTemplateBtn.on("click",this.onSaveButtonClick.bind(this)),this.$saveNewMask.on("click",this.resetSaveInput.bind(this))},onSaveInputFocus:function(){this.resetSaveInput(),this.$saveNewMask.show()},resetSaveInput:function(){this.$saveNewTemplateInput.val(""),this.$saveNewTemplateBtn.hide(),this.$saveNewMask.hide()},onSaveInputKeyup:function(e){var e=o(e.currentTarget),t=e.val(),e=e.siblings("button");""!==t?e.show():e.hide()},onSaveButtonClick:function(e){var e=o(e.currentTarget),t=e.siblings('input[name="template-name"]').val(),e=e.siblings('input[name="template-category"]').val();""!==t&&n.ajax({action:"save_user_template",settings:{name:t,category:e}},n._saveUserTemplateSettingsComplete)},onTemplateClick:function(e){var e=o(e.currentTarget),t=e.data("id"),i=e.data("type"),l=e.data("premium");FLBuilderConfig.lite&&l?n._showProMessage(e.find(".fl-builder--template-name").text()):n._requestTemplateInsert(t,i)}}),u=l.create({templateName:"fl-content-panel-saved-view",bindEvents:function(){this.$savedSearchInput=o(this.$el[0]).find('input[name="saved-search-term"]'),this.$savedSearchInput.on("keyup",this.onSavedSearchTermChanged.bind(this))},filterTemplateData:function(e){return e.queryResults=n.Search.byQuery({kind:"template",type:"user",content:["module","column","row"]}),e},onSavedSearchTermChanged:function(e){var t=this.$savedSearchInput.val();this.showSearchResults(t)},showSearchResults:function(e){var t="",i={kind:"template",type:"user",content:["module","column","row"],searchTerm:""};e&&2<=e.length?i.searchTerm=e:i.searchTerm="",this.queryResults=n.Search.byQuery(i),e=this.template(this),i=o(t='<div class="temp-content">'+e+"</div>").find(".fl-builder-panel-saved-search").wrap("</p>").parent().html(),e=o(t.replace(i,"")).html(),o(this.$el).parent().find(".fl-content-panel-saved-view-content").html(e),n._initSortables()}}),i=FLExtendableObject.create({templateName:"fl-content-panel-category-selector",template:null,tab:null,isOpen:!1,items:{},init:function(){this.template=wp.template(this.templateName),o(this).on("afterRender",this.bindEvents.bind(this)),o(this.tab.panel).on("didShowSearchControls",this.close.bind(this))},render:function(){this.close();var e=o(this.template(this));return this.$el=e,o(this).trigger("afterRender"),e},bindEvents:function(){this.$selectorTitle=this.$el.find(".fl-builder--selector-display"),this.$selectorTitle.on("click",this.toggleOpenClose.bind(this)),this.$categories=this.$el.find(".fl-builder--selector-menu .fl-builder--menu-item"),this.$categories.on("click",this.onCategoryClick.bind(this))},addItem:function(e){var t=_.isUndefined(e.handle)?_.uniqueId("sep_"):e.handle;this.items[t]=e},open:function(){this.isOpen||(this.$el.addClass("is-showing"),this.isOpen=!0)},close:function(){this.isOpen&&(this.$el.removeClass("is-showing"),this.isOpen=!1,this.$selectorTitle.find("button").focus())},toggleOpenClose:function(){this.isOpen?this.close():this.open()},onCategoryClick:function(e){var t,e=o(e.target),i=e.data("view");e.hasClass("fl-has-children")?((t=o('[data-parent="'+i+'"]',window.parent.document)).is(":visible")?(this.items[i].hasChildrenOpen=!1,e.removeClass("fl-has-children-showing"),t.hide()):(this.items[i].hasChildrenOpen=!0,e.addClass("fl-has-children-showing"),t.show()),e.blur()):o(this).trigger("categorySelected",i)}});n.ContentPanel=FLExtendableObject.create({templateName:"fl-content-panel-base",template:null,tabs:{},activeTab:null,isShowing:!1,init:function(){if(FLBuilderConfig.panelData){var e,t=FLBuilderConfig.panelData.tabs;for(e in t){var i=t[e],l=s.create(i);l.panel=this,l.views={},l.init(i),(this.tabs[e]=l).isShowing&&(this.activeTab=l),this.activeTab||(i=Object.keys(this.tabs)[0],(l=this.tabs[i]).isShowing=!0,this.activeTab=l)}this.template=wp.template(this.templateName),this.render(),this.renderSearchResults=wp.template("fl-search-results-panel"),this.renderNoResults=wp.template("fl-search-no-results"),n.triggerHook("contentPanelDidInit")}},render:function(){o("body",window.parent.document).prepend(this.template(this)),this.$el=o(".fl-builder--content-library-panel",window.parent.document),this.bindEvents(),this.$groupSelect=this.$el.find(".fl-builder-content-group-select"),o(this).trigger("afterRender")},bindEvents:function(){this.$tabs=this.$el.find(".fl-builder--tabs [data-tab]"),this.$tabs.on("mouseup",this.onTabItemMouseUp.bind(this)),this.$tabs.on("click",this.onTabItemClick.bind(this)),this.$search=this.$el.find(".fl-builder-panel-search"),this.$searchBtn=this.$search.find(".fl-builder-toggle-panel-search"),this.$searchInput=this.$search.find('input[name="search-term"]'),this.$searchBtn.on("click",this.onSearchButtonClicked.bind(this)),this.$search.find(".fl-builder-dismiss-panel-search").on("click",this.onDismissButtonClicked.bind(this)),this.$searchInput.on("keyup",this.onSearchTermChanged.bind(this)),this.$searchPanel=this.$el.find(".fl-builder--search-results-panel"),this.$el.on("mousedown",()=>{o(".fl-builder-workspace-panel").length&&"right"===n.PinnedUI.getPinnedSide()&&FL.Builder.togglePanel("outline")}),n.addHook("showContentPanel",this.show.bind(this)),n.addHook("showModules",this.show.bind(this,"modules")),n.addHook("showRows",this.show.bind(this,"rows")),n.addHook("showTemplates",this.show.bind(this,"templates")),n.addHook("showSaved",this.show.bind(this,"saved")),n.addHook("showSearch",this.goToSearch.bind(this));var e=this.hide.bind(this),e=(n.addHook("hideContentPanel",e),n.addHook("didShowLightbox",e),n.addHook("didShowPublishActions",e),n.addHook("didBeginSearch",e),n.addHook("didInitDrag",e),n.addHook("didOpenMainMenu",e),n.addHook("didApplyTemplate",e),this.toggleShowHide.bind(this));n.addHook("toggleContentPanel",e),n.addHook("didStopDrag",this.hideSearchControls.bind(this))},alignPanelArrow:function(){var e,t=this.$el,i=this.$el.find(".fl-builder--panel-arrow"),l=o(".fl-builder-content-panel-button",window.parent.document),n=this.$el.css("animation-duration");0!=l.length&&(this.$el.css("animation-duration","0s"),this.show(),t=t[0].getBoundingClientRect(),e=i[0].getBoundingClientRect(),this.hide(),this.$el.css("animation-duration",n),n=(l=(n=l[0].getBoundingClientRect()).x+n.width/2)<t.x?20:l-t.x-e.width/2,i.css({right:"auto",left:n+"px"}))},show:function(e){FLBuilderConfig.userTemplateIsLeafModule||FLBuilderConfig.simpleUi||(n.triggerHook("willShowContentPanel"),void 0!==e&&this.showTab(e),this.isShowing)||n._triggerSettingsSave(!1,!0)&&(o("body",window.parent.document).addClass("fl-builder-content-panel-is-showing"),this.isShowing=!0,o(this).trigger("onShow"),n.triggerHook("didShowContentPanel"),"Builder"in FL)&&"data"in FL.Builder&&FL.Builder.data.getSystemActions().hideCurrentPanel()},hide:function(){!this.isShowing||this.$el.hasClass("fl-builder-ui-pinned")||(o("body",window.parent.document).removeClass("fl-builder-content-panel-is-showing"),this.isShowing=!1,o(this).trigger("onHide"),n.triggerHook("didHideContentPanel"))},toggleShowHide:function(){this.isShowing?this.hide():this.show()},showTab:function(e){e=this.tabs[e];_.isObject(e)&&(_.isObject(this.activeTab)&&(this.activeTab.hide(),this.$tabs.filter(".is-showing").removeClass("is-showing")),this.hideSearchControls(),e.show(),this.$tabs.filter('[data-tab="'+e.handle+'"]').addClass("is-showing"),this.activeTab=e,o(this).trigger("onShowTab"))},goToSearch:function(){this.show("modules"),this.$el.find(".fl-builder-toggle-panel-search").trigger("click")},onTabItemMouseUp:function(e){o(e.currentTarget).blur()},onTabItemClick:function(e){e=o(e.target).data("tab");this.showTab(e)},onSearchButtonClicked:function(){this.showSearchControls()},onDismissButtonClicked:function(){this.hideSearchControls(),this.$searchBtn.focus()},showSearchControls:function(){this.$search.addClass("is-showing-input"),this.$search.find('input[name="search-term"]').focus(),o(".fl-builder--selector-display-label",window.parent.document).attr("tabindex",-1),this.$searchBtn.attr("tabindex",-1),o(this).trigger("didShowSearchControls")},hideSearchControls:function(){this.$search.removeClass("is-showing-input"),this.clearSearchInput(),this.hideSearchResults(),o(".fl-builder--selector-display-label",window.parent.document).attr("tabindex",null),this.$searchBtn.attr("tabindex",null)},onSearchTermChanged:function(e){var t=this.$searchInput.val();""!==t&&""!=(t=n.Search.byTerm(t)).term?this.showSearchResults(t):this.hideSearchResults()},clearSearchInput:function(){this.$searchInput.val(""),this.hideSearchResults()},showSearchResults:function(e){var t;0<e.total?(t=o(this.renderSearchResults(e)),this.$searchPanel.html(t),n._initSortables()):(t=o(this.renderNoResults(e)),this.$searchPanel.html(t)),o("body",window.parent.document).addClass("fl-builder-search-results-panel-is-showing")},hideSearchResults:function(){o("body",window.parent.document).removeClass("fl-builder-search-results-panel-is-showing")}})}(jQuery,FLBuilder),!function(p){FLBuilderSettingsForms={config:null,settings:null,legacyXhr:null,subscribers:[],init:function(){this.bind()},bind:function(){FLBuilder.addHook("didDeleteRow",this.closeOnDeleteNode),FLBuilder.addHook("didDeleteColumn",this.closeOnDeleteNode),FLBuilder.addHook("didDeleteModule",this.closeOnDeleteNode)},render:function(e,t){var i=FLBuilderSettingsConfig.forms,l=FLBuilderSettingsConfig.modules;if(e.nodeId&&!e.settings)this.loadNodeSettings(e,t);else if(t=void 0===t?function(){}:t,(e=p.extend({type:"general",id:null,nodeId:null,className:"",attrs:"",title:"",badges:[],tabs:[],activeTab:null,buttons:[],settings:{},legacy:null,rules:null,preview:null,helper:null,messages:null},e)).id){if("general"===e.type&&void 0!==i[e.id])e=p.extend(!0,e,i[e.id]);else if("module"===e.type&&void 0!==l[e.id])e=p.extend(!0,e,l[e.id]),e=this.preprocessModuleConfig(e);else if("dynamic"!==e.type)return;this.config=e,this.renderLightbox(e)&&(e.legacy||!this.renderLegacySettings(e,t)?this.renderComplete(e,t):this.showLightboxLoader()),FLBuilder.isBlockEditor()||null!==(i=FL.Builder.data.getSystemState().currentPanel)&&"outline"!==i&&FL.Builder.data.getSystemActions().hideCurrentPanel()}},preprocessModuleConfig:function(t){var e,i=FLBuilderConfig.contentItems.module.filter(e=>!e.isAlias&&e.slug===t.id).pop(),l=FLBuilderConfig.deprecations[t.id];let n=null;if(i){if(n=FL.Builder.utils.isBlockEditor()?(e=wp.data.select("core/block-editor").getBlock(t.nodeId))&&e.attributes.version?"v"+e.attributes.version:"v1":(e=FL.Builder.data.getNode(t.nodeId)).version?"v"+e.version:"v1",!i.element_setting){let e=!1;(e=l&&l[n]&&l[n].config&&l[n].config.element_setting?!0:e)||delete t.tabs.advanced.sections.css_selectors.fields.container_element}if(!i.include_wrapper){let e=!0;(e=l&&l[n]&&l[n].config&&l[n].config.include_wrapper?!1:e)&&(t.tabs.advanced.sections.margins.fields.margin.preview.selector="")}}return t},reRenderNodeSettings:function(e,t){var e=p('form.fl-builder-settings[data-node="'+e+'"]'),i=e.data("config");e.length&&(i.legacy=null,i.settings=t,i.preview.layout=null,FLBuilder._lightbox.empty(),this.render(i))},cacheCurrentSettings:function(){var e=p(".fl-builder-settings:visible",window.parent.document);return e.closest(".fl-lightbox-wrap[data-parent]").length||(this.settings=FLBuilder._getSettingsForChangedCheck(this.config.nodeId,e),FLBuilder.preview&&(FLBuilder.preview._savedSettings=this.settings)),this.settings},loadNodeSettings:function(t,i){FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"get_node_settings",node_id:t.nodeId},function(e){t.settings=FLBuilder._jsonParse(e),FLBuilderSettingsConfig.nodes[t.nodeId]=t.settings,FLBuilderSettingsForms.render(t,i),FLBuilder.hideAjaxLoader()})},renderLightbox:function(e){var t=wp.template("fl-builder-settings"),i=FLBuilder._lightbox._node.find("form.fl-builder-settings"),l=(p(".fl-lightbox-wrap[data-parent]",window.parent.document),localStorage.getItem("fl-builder-settings-tab"));if(e.nodeId&&e.nodeId===i.data("node")&&!e.lightbox)return FL?.Builder?.settingsForms.focusFirstSettingsControl(),!1;if(!e.hide){if(l)for(var n in e.tabs)n===l.replace("fl-builder-settings-tab-","")&&(e.activeTab=n);if(e.activeTab||(e.activeTab=Object.keys(e.tabs).shift()),e.lightboxId=(this.config.lightbox||FLBuilder._lightbox)._id,e.lightbox)e.lightbox.setContent(t(e));else{if(!FLBuilder._triggerSettingsSave(!0,!0))return!1;FLBuilder.preview&&FLBuilder.preview.cancel(),FLBuilder._closePanel(),FLBuilder._showLightbox(t(e))}p("form.fl-builder-settings:visible").data("config",e);i=(FL?.Builder?.settingsForms)["state"];e.isNode=!!e.nodeId,e.isNested=!("general"!==e.type||!e.lightbox),e.isNested?i.pushForm(e):i.setForm(e),FL.Builder.utils.isBlockEditor()||FL.Builder.data.getOutlinePanelActions().setActiveNode(e.nodeId)}return!0},renderComplete:function(e,t){setTimeout(function(){e.legacy&&this.renderLegacySettingsComplete(e.legacy),t(),FLBuilder._initSettingsForms(),e.rules&&FLBuilder._initSettingsValidation(e.rules,e.messages),e.preview&&(FLBuilder.preview=new FLBuilderPreview(e.preview)),FLBuilder.triggerHook("initCustomPreview",e),e.helper&&e.helper.init(),this.cacheCurrentSettings()}.bind(this),1)},renderFields:function(e,t,i,l,n){var o,s,r=wp.template("fl-builder-settings-row"),d=(wp.template("fl-builder-settings-field-group-row"),""),a=null,u=null,c=null,f=FLBuilderConfig.responsiveFields,t=t||this.config.settings,h=FLBuilderConfig.global;for(a in e)(o=e[a])&&(s=!!o.multiple,supportsResponsive=-1<p.inArray(o.type,f),u=_.isUndefined(t[a])?"":t[a],o.type)&&(_.isUndefined(t[a])&&o.default&&(u=o.default),c=o.responsive&&h.responsive_enabled&&!s&&supportsResponsive?o.responsive:null,d+=r({field:o,name:a,rootName:a,value:u,preview:JSON.stringify(o.preview||{type:"refresh"}),responsive:c,rowClass:o.row_class?" "+o.row_class:"",isMultiple:s,supportsMultiple:"editor"!==o.type&&"service"!==o.type,settings:t,globalSettings:h,template:p("#tmpl-fl-builder-field-"+o.type),node:i,tabId:l,sectionId:n}));return d},renderFieldRow:function(e,t,i,l){var n=wp.template("fl-builder-settings-row"),o=-1<p.inArray(t.type,FLBuilderConfig.responsiveFields),s=void 0!==i[e]?i[e]:"",r=!!t.multiple,d=FLBuilderConfig.global;return responsive=t.responsive&&d.responsive_enabled&&!r&&o?t.responsive:null,n({field:t,name:e,rootName:e,value:s,preview:JSON.stringify(t.preview||{type:"refresh"}),responsive:responsive,rowClass:t.row_class?" "+t.row_class:"",isMultiple:!!t.multiple,supportsMultiple:"editor"!==t.type&&"service"!==t.type,settings:i,globalSettings:FLBuilderConfig.global,template:p("#tmpl-fl-builder-field-"+t.type),node:l})},renderField:function(e){return wp.template("fl-builder-field")(e)},renderSectionTemplate:function(e,t){return wp.template(e.template.id)({section:e,settings:t})},renderTabTemplate:function(e,t){return wp.template(e.template.id)({tab:e,settings:t})},renderLegacySettings:function(t,i){var e=p(".fl-builder-settings:visible",window.parent.document),l=null,n=!1,o={tabs:[],sections:[],fields:[],settings:null,node_id:null};return e.find(".fl-legacy-field").each(function(){l=p(this),o.fields.push(l.attr("data-field")),FLBuilderSettingsForms.showFieldLoader(l),n=!0}),e.find(".fl-legacy-settings-section").each(function(){l=p(this),o.sections.push({tab:l.attr("data-tab"),section:l.attr("data-section")}),n=!0}),e.find(".fl-legacy-settings-tab").each(function(){l=p(this),o.tabs.push(l.attr("data-tab")),n=!0}),e.attr("data-node")&&!FLBuilder.isBlockEditor()?o.node_id=e.attr("data-node"):o.settings=FLBuilder._getOriginalSettings(e,!0),this.legacyXhr&&(this.legacyXhr.abort(),this.legacyXhr=null),this.legacyXhr=FLBuilder.ajax(p.extend(this.getLegacyVars(),{action:"render_legacy_settings",data:o,form:e.attr("data-form-id"),group:e.attr("data-form-group"),lightbox:e.closest(".fl-builder-lightbox").attr("data-instance-id")}),function(e){FLBuilderSettingsForms.renderLegacySettingsComplete(e),n&&FLBuilderSettingsForms.renderComplete(t,i),FLBuilderSettingsForms.hideLightboxLoader()}),n},renderLegacySettingsComplete:function(e){var i="object"==typeof e?e:FLBuilder._jsonParse(e),e=null,t=null,l="",n=null,o=null;if(i.lightbox?t=(e=p(".fl-builder-lightbox[data-instance-id="+i.lightbox+"]",window.parent.document)).length?e.find(".fl-builder-settings"):null:e=(t=p(".fl-builder-settings:visible",window.parent.document)).closest(".fl-builder-lightbox"),t&&t.length){var s=e=>{for(var t in this.config.tabs){var i,l=this.config.tabs[t];for(i in l.sections){var n,o=l.sections[i];for(n in o.fields)if(e===n)return o.fields[n]}}return!1};for(l in i.fields)FL?.Builder?.settingsForms.canDeferField(s(l),i)||(n=p("#fl-field-"+l,window.parent.document).attr("id","")).after(i.fields[l]).remove();for(l in i.extras)n=p("#fl-field-"+l,window.parent.document).find(".fl-field-control-wrapper"),i.extras[l].multiple?n.each(function(e,t){e in i.extras[l].before&&""!=i.extras[l].before[e]&&p(this).prepend('<div class="fl-form-field-before">'+i.extras[l].before[e]+"</div>"),e in i.extras[l].after&&""!=i.extras[l].after[e]&&p(this).append('<div class="fl-form-field-after">'+i.extras[l].after[e]+"</div>")}):(""!=i.extras[l].before&&n.prepend('<div class="fl-form-field-before">'+i.extras[l].before+"</div>"),""!=i.extras[l].after&&n.append('<div class="fl-form-field-after">'+i.extras[l].after+"</div>"));for(o in i.sections)for(l in i.sections[o])p("#fl-builder-settings-section-"+l,window.parent.document).html(i.sections[o][l]);for(l in i.tabs)(o=p("#fl-builder-settings-tab-"+l,window.parent.document)).html(i.tabs[l]);e.data("parent")||(this.settings=FLBuilder._getSettingsForChangedCheck(this.config.nodeId,t),FLBuilder.preview&&(this.settings=p.extend(this.settings,FLBuilder.preview._savedSettings),FLBuilder.preview._savedSettings=this.settings)),_.isUndefined(window.FLThemeBuilderCompoundConnections)||FLThemeBuilderCompoundConnections._initSettingsForms(),_.isUndefined(window.FLThemeBuilderFieldConnections)||FLThemeBuilderFieldConnections._initSettingsForms(),this.legacyXhr=null,FLBuilder.triggerHook("renderLegacySettingsComplete")}},getLegacyVars:function(){var e=p(".fl-builder-settings:visible",window.parent.document),t=e.closest(".fl-builder-lightbox").attr("data-parent"),i={};return t&&(e=(t=p(".fl-builder-lightbox[data-instance-id="+t+"]",window.parent.document)).find("form.fl-builder-settings"),t=FLBuilder._getSettings(e),e=e.attr("data-node"))&&(i.node_id=e,i.node_settings=t),i},settingsHaveChanged:function(){var e=FLBuilder._lightbox._node.find("form.fl-builder-settings"),e=FLBuilder._getSettings(e);return!!this.settings&&JSON.stringify(this.settings)!=JSON.stringify(e)},closeOnDeleteNode:function(e){var t=p(".fl-builder-settings[data-node]",window.parent.document),i=FLBuilder._contentClass+" .fl-node-"+t.data("node");t.length&&!p(i).length&&FLLightbox.closeAll()},showLightboxLoader:function(){p(".fl-builder-settings:visible",window.parent.document).append('<div class="fl-builder-loading"></div>')},hideLightboxLoader:function(e){p(".fl-builder-settings:visible .fl-builder-loading",window.parent.document).remove()},showFieldLoader:function(e){e.closest(".fl-field-control").find(".fl-field-control-wrapper").hide().after('<div class="fl-field-loader">'+FLBuilderStrings.fieldLoading+"</div>")},hideFieldLoader:function(e){var t=e.closest(".fl-field");e.closest(".fl-field-control").find(".fl-field-control-wrapper").show(),t.find(".fl-field-loader").remove()},getField:function(e){return void 0===e?null:new FL.Builder.settingsForms.FieldController(e,this.config)},escapeHTML:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}},FLBuilderSettingsConfig="undefined"==typeof FLBuilderSettingsConfig?{}:FLBuilderSettingsConfig,p.extend(FLBuilderSettingsConfig,{init:function(){FLBuilder.addHook("didSaveNodeSettings",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didSaveNodeSettingsComplete",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didSaveLayoutSettingsComplete",this.updateOnSaveLayoutSettings.bind(this)),FLBuilder.addHook("didSaveGlobalStylesComplete",this.updateOnSaveGlobalStyles.bind(this)),FLBuilder.addHook("didSaveGlobalSettingsComplete",this.updateOnSaveGlobalSettings.bind(this)),FLBuilder.addHook("didSaveGlobalSettingsComplete",this.reload),FLBuilder.addHook("didAddRow",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didAddColumnGroup",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didAddColumn",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didAddModule",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDeleteRow",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDeleteColumn",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDeleteModule",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDuplicateRow",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDuplicateColumn",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didDuplicateModule",this.updateOnNodeEvent.bind(this)),FLBuilder.addHook("didResizeRow",this.updateOnRowResize.bind(this)),FLBuilder.addHook("didResizeColumn",this.updateOnColumnResize.bind(this)),FLBuilder.addHook("didResetRowWidth",this.updateOnResetRowWidth.bind(this)),FLBuilder.addHook("didResetColumnWidths",this.updateOnResetColumnWidths.bind(this)),FLBuilder.addHook("didApplyTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didApplyRowTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didApplyColTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didApplyModuleTemplateComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didSaveGlobalNodeTemplate",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didRestoreRevisionComplete",this.updateOnApplyTemplate.bind(this)),FLBuilder.addHook("didRestoreHistoryComplete",this.updateOnHistoryRestored.bind(this))},reload:function(){var e=FLBuilderConfig.editUrl+"&fl_builder_load_settings_config=core";p('script[src*="fl_builder_load_settings_config=core"]').remove(),p("head").append('<script src="'+e+'"><\/script>')},updateOnSaveGlobalSettings:function(e,t){this.settings.global=t,FLBuilderConfig.global=t},updateOnSaveGlobalStyles:function(e,t){0<t.colors.length&&t.colors.forEach(e=>{let t="";t=e.color.match(/^(var|rgb|hs(l|v))a?\(/)||e.color.startsWith("#")?FLBuilderColor(e.color).toDisplay():"#"+e.color,FLBuilderConfig.globalColorLabels["global_color_"+e.uid]='<span class="prefix">Global -</span>'+e.label+'<span class="swatch" style="background-color:'+t+';"></span>'}),FLBuilderConfig.styles=t},updateOnSaveLayoutSettings:function(e,t){this.settings.layout=t},updateOnNodeEvent:function(){var e,t,i,l,n=arguments[0];-1<n.namespace.indexOf("didAdd")?(e="object"==typeof arguments[1]?arguments[1].nodeId:arguments[1],t="object"==typeof arguments[1]&&arguments[1].settings?arguments[1].settings:null,i="object"==typeof arguments[1]&&arguments[1].newNodes?arguments[1].newNodes:null,l="object"==typeof arguments[1]&&arguments[1].updatedNodes?arguments[1].updatedNodes:null,this.addNode(e,t,i,l)):-1<n.namespace.indexOf("didSaveNodeSettings")?this.updateNode(arguments[1].nodeId,arguments[1].settings):-1<n.namespace.indexOf("didDelete")?this.deleteNodes("object"==typeof arguments[1]?arguments[1].nodeId:arguments[1]):-1<n.namespace.indexOf("didDuplicate")&&this.duplicateNode(arguments[1].oldNodeId,arguments[1].newNodeId)},updateOnRowResize:function(e,t){this.nodes[t.rowId].max_content_width=t.rowWidth},updateOnResetRowWidth:function(e,t){this.nodes[t].max_content_width=""},updateOnColumnResize:function(e,t){this.nodes[t.colId].size=t.colWidth,this.nodes[t.siblingId].size=t.siblingWidth},updateOnResetColumnWidths:function(e,t){var i=this;t.cols.each(function(){var e=p(this),t=e.attr("data-node");i.nodes[t]&&(i.nodes[t].size=parseFloat(e[0].style.width))})},updateOnApplyTemplate:function(e,t){this.nodes=t.nodes,this.attachments=t.attachments},updateOnHistoryRestored:function(e,t){this.nodes=t.config.nodes,this.attachments=t.config.attachments,this.settings.layout=t.settings.layout,this.settings.global=t.settings.global,FLBuilderConfig.global=t.settings.global},addNode:function(e,t,i,l){var n=p(".fl-node-"+e),o=n.hasClass("fl-row"),s=n.hasClass("fl-col"),r=n.hasClass("fl-col-group"),d=n.hasClass("fl-module"),a=this;if(!this.nodes[e]){if(t||(o?t=p.extend({},this.defaults.row):s?t=p.extend({},this.defaults.column):d&&(t=p.extend({},this.defaults.modules[n.attr("data-type")])),o||r?n.find(".fl-col").each(function(){var e=p(this),t=p.extend({},a.defaults.column);t.size=parseFloat(e[0].style.width),a.addNode(e.attr("data-node"),t)}):d&&(a.addNode(n.closest(".fl-row").attr("data-node")),a.addNode(n.closest(".fl-col").attr("data-node")),a.updateOnResetColumnWidths(null,{cols:n.closest(".fl-col-group").find("> .fl-col")}))),t&&(this.nodes[e]=t),i)for(e in i)this.nodes[e]=i[e].settings;if(l)for(e in l)void 0!==l[e].settings&&(this.nodes[e]={...this.nodes[e],...l[e].settings})}},updateNode:function(e,i){var t=p(".fl-node-"+e),l=this;t.hasClass("fl-col")&&t.closest(".fl-col-group").find("> .fl-col").each(function(){var e=p(this),t=e.attr("data-node");l.nodes[t].size=parseFloat(e[0].style.width),l.nodes[t].equal_height=i.equal_height,l.nodes[t].content_alignment=i.content_alignment,l.nodes[t].responsive_order=i.responsive_order}),this.nodes[e]=i},duplicateNode:function(t,i){var e=p(".fl-node-"+i).find("[data-node]"),l=p(".fl-node-"+t).find("[data-node]"),n=this;this.nodes[i]=this.nodes[t],e.each(function(e){t=l.eq(e).attr("data-node"),i=p(this).attr("data-node"),n.nodes[t]&&(n.nodes[i]=n.nodes[t])})},deleteNodes:function(){var e="",t=p(FLBuilder._contentClass).html();if(t)for(e in this.nodes)-1===t.indexOf(e)&&(this.nodes[e]=null,delete this.nodes[e])}}),p(function(){FLBuilderSettingsConfig.init(),FLBuilderSettingsForms.init()})}(jQuery),!function(u){FLBuilderSettingsCopyPaste={init:function(){FLBuilder.addHook("settings-form-init",this.initExportButton),FLBuilder.addHook("settings-form-init",this.initImportButton)},_getClipboard:function(){return window.localStorage.getItem("clipboard")||""},_getClipboardType:function(e){var t=this._getClipboard().match(/{type:([_a-z0-9-]+)}/);return null!==t&&"undefined"!==t[1]?t[1]:""},_setClipboard:function(e,t=!1){window.localStorage.setItem("clipboard",e),t&&this._copyToClipboard(e)},_copyToClipboard:function(e){var t;0!==e.length&&(void 0===navigator.clipboard?((t=document.createElement("textarea")).style.position="absolute",t.style.left="-100%",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)):window.parent.navigator.clipboard.writeText(e))},_copySettings:function(e,t,i=!1,l=!1){let n={},o=e;var s=u(".fl-builder-settings[data-node="+t+"]"),r="/// {type:"+e+"} "+(new Date).toDateString()+" ///";if("row"!==o&&(o="column"===o?"col":"module"),n=0<s.length?FLBuilder._getSettings(s):(n=FLBuilderSettingsConfig.nodes[t],FLBuilderSettingsCopyPaste._copySettingsEncoded(e,n)),0<s.length&&l)for(var d in n){let e=!1,t=null,i=null;if("connections"===d){var a={};for(subkey in n[d])t=s.find('[name="'+subkey+'"]'),i=s.find('[name*="'+subkey+'["]'),t.length?e=t.closest(".fl-field").data("is-style"):i.length&&(e=i.closest(".fl-field").data("is-style")),e&&(a[subkey]=n[d][subkey]);n[d]=a}else t=s.find('[name="'+d+'"]'),i=s.find('[name*="'+d+'["]'),t.length?e=t.closest(".fl-field").data("is-style"):i.length&&(e=i.closest(".fl-field").data("is-style")),e||delete n[d]}return this._setClipboard(r+"\n"+JSON.stringify(n),i),u("body").attr("data-clipboard",e),u(".fl-quick-paste-active").removeClass("fl-quick-paste-active"),u('[data-node="'+t+'"]').find(".fl-"+o+"-quick-paste").addClass("fl-quick-paste-active"),this._getClipboard()},_copySettingsEncoded:function(e,t){if(FLBuilderSettingsConfig.modules[e]){t={...t};var i,l=FLBuilderSettingsConfig.modules[e].tabs;for(i in l)if(l[i].sections)for(var n in l[i].sections)if(l[i].sections[n].fields)for(var o in l[i].sections[n].fields){var s=l[i].sections[n].fields[o];"form"!==s.type||!t[o]||!1!==s.multiple&&void 0!==s.multiple||(t[o]=JSON.stringify(t[o]))}}return t},_importSettings:function(e,t,i){var l=i.match(/{type:([_a-z0-9-]+)}/);if("undefined"!==l[1]&&e===l[1])try{var n=JSON.parse(i.replace(/\/\/\/.+\/\/\//,"")),o=("column"===e&&("size"in n&&delete n.size,"size_large"in n&&delete n.size_large,"size_medium"in n&&delete n.size_medium,"size_responsive"in n)&&delete n.size_responsive,u.extend({},FLBuilderSettingsConfig.nodes[t],n));return FLBuilderSettingsConfig.nodes[t]=o,FL.Builder.data.getLayoutActions().updateNodeSettings(t,o,FLBuilder._saveSettingsComplete.bind(this,!0)),FLBuilder.triggerHook("didSaveNodeSettings",{nodeId:t,settings:o}),FLBuilder._lightbox.close(),!0}catch{}return!1},_importFromClipboard:function(e,t){return 0<this._getClipboard().length&&FLBuilderSettingsCopyPaste._importSettings(e,t,this._getClipboard())},_importFromJSON:function(e,t,i){return null!=i&&0<i.length&&FLBuilderSettingsCopyPaste._importSettings(e,t,i)},_bindCopyToElement:function(e,t,i,l=!1,n=!1){const o=e.text();FLBuilderSettingsCopyPaste._copySettings(t,i,l,n),e.text(FLBuilderStrings.module_import.copied),setTimeout(()=>{e.text(o)},1e3)},initExportButton:function(){u("button.row-export-all").on("click",function(){var e=u(".fl-builder-row-settings").data("node");FLBuilderSettingsCopyPaste._bindCopyToElement(u(this),"row",e,!0)}),u("button.row-export-style").on("click",function(){var e=u(".fl-builder-row-settings").data("node");FLBuilderSettingsCopyPaste._bindCopyToElement(u(this),"row",e,!0,!0)}),u("button.col-export-all").on("click",function(){var e=u(".fl-builder-col-settings").data("node");FLBuilderSettingsCopyPaste._bindCopyToElement(u(this),"column",e,!0)}),u("button.col-export-style").on("click",function(){var e=u(".fl-builder-col-settings").data("node");FLBuilderSettingsCopyPaste._bindCopyToElement(u(this),"column",e,!0,!0)}),u("button.module-export-all").on("click",function(){var e=u(".fl-builder-module-settings").data("node"),t=u(".fl-builder-module-settings").data("type");FLBuilderSettingsCopyPaste._bindCopyToElement(u(this),t,e,!0)}),u("button.module-export-style").on("click",function(){var e=u(".fl-builder-module-settings").data("node"),t=u(".fl-builder-module-settings").data("type");FLBuilderSettingsCopyPaste._bindCopyToElement(u(this),t,e,!0,!0)})},initImportButton:function(){u("button.row-import-apply").on("click",function(){var e=u(".fl-builder-row-settings").data("node"),t=u(".row-import-input").val();FLBuilderSettingsCopyPaste._importFromJSON("row",e,t)||u(".row-import-error").html(FLBuilderStrings.module_import.error).show()}),u("button.col-import-apply").on("click",function(){var e=u(".fl-builder-col-settings").data("node"),t=u(".col-import-input").val();FLBuilderSettingsCopyPaste._importFromJSON("column",e,t)||u(".col-import-error").html(FLBuilderStrings.module_import.error).show()}),u("button.module-import-apply").on("click",function(){var e=u(".fl-builder-module-settings").data("type"),t=u(".fl-builder-module-settings").data("node"),i=u(".module-import-input").val();FLBuilderSettingsCopyPaste._importFromJSON(e,t,i)||u(".module-import-error").html(FLBuilderStrings.module_import.error).show()})}},u(function(){FLBuilderSettingsCopyPaste.init()})}(jQuery),!function(d){var e={minWidth:310,maxWidth:600,minHeight:400,init:function(){this.initPanel(),this.pinOrUnpin(),this.bind()},bind:function(){var e=d(window.parent),t=d("body",window.parent.document);e.on("resize",_.throttle(this.windowResize.bind(this),250)),t.on("click",".fl-builder-ui-pinned-collapse",this.collapse),t.on("click",".fl-builder--content-library-panel .fl-builder--tabs",this.closeLightboxOnPanelClick),FLBuilder.addHook("didShowLightbox",this.pinLightboxOnOpen.bind(this)),FLBuilder.addHook("didHideAllLightboxes",this.pinnedLightboxClosed.bind(this)),FLBuilder.addHook("endEditingSession",this.hide.bind(this)),FLBuilder.addHook("didHideEditingUI",this.hide.bind(this)),FLBuilder.addHook("publishButtonClicked",this.hide.bind(this)),FLBuilder.addHook("restartEditingSession",this.show.bind(this)),FLBuilder.addHook("didShowEditingUI",this.show.bind(this)),FLBuilder.addHook("didShowLightbox",this.uncollapse.bind(this)),FLBuilder.addHook("willShowContentPanel",this.uncollapse.bind(this)),FLBuilder.addHook("willShowContentPanel",this.closeLightboxOnPanelClick.bind(this))},isPinned:function(){return d(".fl-builder--content-library-panel",window.parent.document).hasClass("fl-builder-ui-pinned")},getPinnedSide:function(){var e=d(".fl-builder--content-library-panel",window.parent.document);return!!this.isPinned()&&(e.hasClass("fl-builder-ui-pinned-right")?"right":"left")},pin:function(e,t){this.pinPanel(e),this.pinLightboxes(),t&&this.savePosition(),FLBuilder._resizeLayout(),FLBuilder.triggerHook("didPinContentPanel")},unpin:function(e){this.unpinLightboxes(),this.unpinPanel(),e&&this.savePosition(),FLBuilder._resizeLayout(),FLBuilder.triggerHook("didUnpinContentPanel")},pinOrUnpin:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=this.isPinned();e.hasClass("fl-builder-ui-pinned-hidden")||(window.parent.innerWidth<=this.maxWidth?(t&&this.unpin(!1),this.disableDragAndResize()):(t||this.restorePosition(),this.enableDragAndResize()))},show:function(){var e=d(".fl-builder--content-library-panel",window.parent.document);e.hasClass("fl-builder-ui-pinned-hidden")&&(e.removeClass("fl-builder-ui-pinned-hidden"),e.show(),this.restorePosition())},hide:function(){var e=d("body",window.parent.document),t=d(".fl-builder--content-library-panel",window.parent.document);this.isPinned()&&(this.uncollapse(),t.addClass("fl-builder-ui-pinned-hidden"),t.hide(),e.css("margin",""),e.removeClass("fl-builder-ui-is-pinned fl-builder-ui-is-pinned-left fl-builder-ui-is-pinned-right"),FLBuilder._resizeLayout())},collapse:function(){var e=d(this).find("i:visible"),t=d("body",window.parent.document),i=e.data("toggle"),e=e.data("position"),l=d(".fl-builder--content-library-panel",window.parent.document),n=l.outerWidth();"hide"===i?(l.css(e,"-"+n+"px"),t.css("margin-"+e,""),t.addClass("fl-builder-ui-pinned-is-collapsed")):(l.css(e,"0px"),t.css("margin-"+e,n+"px"),t.removeClass("fl-builder-ui-pinned-is-collapsed"))},uncollapse:function(){this.isCollapsed()&&d(".fl-builder-ui-pinned-collapse:visible",window.parent.document).trigger("click")},isCollapsed:function(){return d("body",window.parent.document).hasClass("fl-builder-ui-pinned-is-collapsed")},initPanel:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=0==d(".fl-builder-content-panel-button",window.parent.document).length?".fl-builder--tabs, .fl-lightbox-header":".fl-builder--tabs",i=getComputedStyle(document.documentElement),l=parseInt(i.getPropertyValue("--fl-builder-panel-min-width")),n=parseInt(i.getPropertyValue("--fl-builder-panel-min-height")),i=parseInt(i.getPropertyValue("--fl-builder-panel-max-width"));e.draggable({cursor:"move",handle:t,cancel:".fl-builder--tabs button",scroll:!1,drag:this.drag.bind(this),stop:this.dragStop.bind(this),start:this.dragStart.bind(this),iframeFix:!0}).resizable({handles:"e, w",minHeight:n,minWidth:l,maxWidth:i,start:this.resizeStart.bind(this),stop:this.resizeStop.bind(this)}),e.addClass("fl-builder-ui-pinned-container"),e.find(".ui-resizable-e, .ui-resizable-w").hide()},pinPanel:function(e){var t=d(".fl-builder--content-library-panel",window.parent.document),i=t.outerWidth(),l=d("body",window.parent.document),n=d(".fl-responsive-preview, .fl-responsive-preview-mask",window.parent.document),o=d(FLBuilder._contentClass).parentsUntil("body").last();l.addClass("fl-builder-ui-is-pinned fl-builder-ui-is-pinned-"+e),l.addClass("fl-builder-content-panel-is-showing"),l.css("margin-"+e,i+"px"),n.css("margin-"+e,i+"px"),o.addClass("fl-builder-ui-pinned-content-transform"),t.addClass("fl-builder-ui-pinned fl-builder-ui-pinned-"+e),t.find(".ui-resizable-"+("left"===e?"e":"w")).show(),t.on("resize",_.throttle(this.resize.bind(this),250)),t.attr("style",""),FLBuilder.ContentPanel.isShowing=!0,0==d(".fl-builder-content-panel-button",window.parent.document).length&&d(".fl-builder-panel-drag-handle",window.parent.document).show()},unpinPanel:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=e.find(".fl-builder--panel-content .is-showing").data("tab"),i=d("body",window.parent.document),l=d(".fl-responsive-preview, .fl-responsive-preview-mask",window.parent.document),n=d(FLBuilder._contentClass).parentsUntil("body").last();i.css("margin-left",""),i.css("margin-right",""),i.removeClass("fl-builder-ui-is-pinned"),i.removeClass("fl-builder-ui-is-pinned-left"),i.removeClass("fl-builder-ui-is-pinned-right"),l.css("margin-left",""),l.css("margin-right",""),n.removeClass("fl-lightbox-content-transform"),e.removeClass("fl-builder-ui-pinned"),e.removeClass("fl-builder-ui-pinned-left"),e.removeClass("fl-builder-ui-pinned-right"),e.find(".ui-resizable-handle").hide(),e.off("resize"),e.attr("style",""),e.find(".fl-builder--tabs [data-tab="+t+"]").addClass("is-showing")},pinLightboxes:function(){var e=this;d(".fl-lightbox-resizable",window.parent.document).each(function(){e.pinLightbox(d(this))}),FLBuilder._reinitEditorFields()},pinLightbox:function(e){var t=d(".fl-builder--content-library-panel",window.parent.document),i=e.closest(".fl-lightbox-wrap");i.closest(".fl-builder-ui-pinned").length||(t.append(i),e.attr("style",""),e.draggable("disable"),e.resizable("disable")),e.is(":visible")&&t.find(".fl-builder--tabs .is-showing").removeClass("is-showing")},pinLightboxOnOpen:function(e,t){t=t._node.find(".fl-lightbox-resizable");t.length&&(t.hasClass("fl-builder-ui-pinning-initialized")||(t.draggable("option","start",this.dragStart.bind(this)),t.draggable("option","drag",this.drag.bind(this)),t.draggable("option","stop",this.dragStop.bind(this)),t.addClass("fl-builder-ui-pinning-initialized")),this.isPinned()&&this.pinLightbox(t),FLBuilder.addHook("responsive-editing-switched",this.resize))},pinnedLightboxClosed:function(){var e=d(".fl-builder--content-library-panel",window.parent.document);tab=null,this.isPinned()&&(tab=e.find(".fl-builder--panel-content .is-showing").data("tab"),e.find(".fl-builder--tabs [data-tab="+tab+"]").addClass("is-showing")),d(".fl-lightbox",window.parent.document).removeClass("fl-lightbox-prevent-animation")},unpinLightboxes:function(){var n=d("body",window.parent.document),o=d(".fl-builder--content-library-panel",window.parent.document);o.find(".fl-lightbox-wrap").each(function(){var e,t,i=d(this),l=i.find(".fl-lightbox");l.draggable("enable"),l.resizable("enable"),l.find(".ui-resizable-handle").show(),n.append(i),l.is(":visible")?(e=parseInt(o.css("top"))-parseInt(i.css("top"))-parseInt(i.css("padding-top")),t=parseInt(o.css("left"))-parseInt(i.css("padding-left")),i=parseInt(o.css("right"))-parseInt(i.css("padding-right")),l.css("top",(e<0?0:e)+"px"),l.css(FLBuilderConfig.isRtl?"right":"left",(FLBuilderConfig.isRtl?i:t)+"px"),l.addClass("fl-lightbox-prevent-animation"),n.removeClass("fl-builder-content-panel-is-showing"),FLBuilder.ContentPanel.isShowing=!1):l.css({top:"25px",left:"25px"})}),FLBuilder._reinitEditorFields()},closeLightboxOnPanelClick:function(){FLBuilder._triggerSettingsSave(!1,!0)},windowResize:function(){this.pinOrUnpin()},resizeStart:function(){d("body",window.parent.document).addClass("fl-builder-resizable-is-resizing"),FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays()},resize:function(){var e=d("body",window.parent.document),t=d(".fl-responsive-preview, .fl-responsive-preview-mask",window.parent.document),i=d(".fl-builder--content-library-panel",window.parent.document),l=i.outerWidth();i.is(":visible")?i.hasClass("fl-builder-ui-pinned-left")?(e.css("margin-left",l+"px"),e.css("--fl-builder-panel-width",l+"px"),t.css("margin-left",l+"px")):i.hasClass("fl-builder-ui-pinned-right")&&(e.css("margin-right",l+"px"),e.css("--fl-builder-panel-width",l+"px"),t.css("margin-right",l+"px")):e.css("margin","")},resizeStop:function(){d("body",window.parent.document).removeClass("fl-builder-resizable-is-resizing"),FLBuilder._bindOverlayEvents(),FLBuilder._resizeLayout(),this.savePosition()},dragStart:function(e,t){var i=d("body",window.parent.document),e=(d(e.target,window.parent.document),d(".fl-builder-bar-actions",window.parent.document));d(".fl-lightbox-resizable:visible",window.parent.document).length||e.addClass("fl-builder-content-panel-pin-zone"),i.addClass("fl-builder-draggable-is-dragging"),i.append('<div class="fl-builder-ui-pin-zone fl-builder-ui-pin-zone-left"></div>'),i.append('<div class="fl-builder-ui-pin-zone fl-builder-ui-pin-zone-right"></div>'),FLBuilder._destroyOverlayEvents()},drag:function(e,t){var i=d("body",window.parent.document),l=d(".fl-responsive-preview",window.parent.document),n=d(window.parent),l=(l.length?l:n).width(),n=n.scrollTop(),o=d(".fl-builder--content-library-panel",window.parent.document).offset().top,s=d(".fl-builder-bar-actions",window.parent.document),r=d(e.target,window.parent.document);r.hasClass("fl-builder--content-library-panel")&&(e.clientX<l-75&&o-n<46?s.addClass("fl-builder-content-panel-pin-zone-hover"):s.removeClass("fl-builder-content-panel-pin-zone-hover")),r.hasClass("fl-builder-ui-pinned")?this.unpinPanel():e.clientX<75?i.addClass("fl-builder-ui-show-pin-zone fl-builder-ui-show-pin-zone-left"):e.clientX>l-75?i.addClass("fl-builder-ui-show-pin-zone fl-builder-ui-show-pin-zone-right"):(i.removeClass("fl-builder-ui-show-pin-zone"),i.removeClass("fl-builder-ui-show-pin-zone-left"),i.removeClass("fl-builder-ui-show-pin-zone-right"))},dragStop:function(e,t){d(window.parent);var i=d("body",window.parent.document),l=d(".fl-builder-bar-actions",window.parent.document),n=d(".fl-builder-ui-pin-zone",window.parent.document),o=d(".fl-builder--content-library-panel",window.parent.document),s=d(".fl-lightbox-resizable:visible",window.parent.document);d(e.target,window.parent.document);i.removeClass("fl-builder-draggable-is-dragging"),l.removeClass("fl-builder-content-panel-pin-zone"),l.removeClass("fl-builder-content-panel-pin-zone-hover"),n.remove(),s.length&&parseInt(s.css("top"))<0&&s.css("top","0"),i.hasClass("fl-builder-ui-show-pin-zone")?(i.hasClass("fl-builder-ui-show-pin-zone-left")?this.pin("left",!0):this.pin("right",!0),i.removeClass("fl-builder-ui-show-pin-zone"),i.removeClass("fl-builder-ui-show-pin-zone-left"),i.removeClass("fl-builder-ui-show-pin-zone-right")):o.find(".fl-lightbox").length?(this.unpin(!0),"module"!==FLBuilderConfig.userTemplateType&&!FLBuilderConfig.simpleUi||o.hide()):(o.attr("style",""),this.savePosition()),FLBuilder._bindOverlayEvents()},disableDragAndResize:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=d(".fl-lightbox-resizable",window.parent.document);e.draggable("disable"),e.resizable("disable"),t.draggable("disable"),t.resizable("disable")},enableDragAndResize:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=d(".fl-lightbox-resizable:not(.fl-lightbox-width-full)",window.parent.document);e.draggable("enable"),e.resizable("enable"),this.isPinned()||(t.draggable("enable"),t.resizable("enable"))},savePosition:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=d(".fl-lightbox-resizable:visible",window.parent.document),i={pinned:{width:e.outerWidth(),position:null}};e.hasClass("fl-builder-ui-pinned-left")?i.pinned.position="left":e.hasClass("fl-builder-ui-pinned-right")?i.pinned.position="right":t.length&&(i.lightbox={width:t.width(),height:t.height(),top:parseInt(t.css("top"))<0?"0px":t.css("top"),left:t.css("left")}),FLBuilderConfig.userSettings.pinned=i.pinned,i.lightbox&&(FLBuilderConfig.userSettings.lightbox=i.lightbox),FLBuilder.ajax({action:"save_pinned_ui_position",data:i})},restorePosition:function(){var e=d(".fl-builder--content-library-panel",window.parent.document),t=FLBuilderConfig.userSettings.pinned;t&&t.position&&(e.css("width",t.width+"px"),this.pin(t.position,!1),e.css("width",t.width+"px"))}};d(function(){FLBuilder.PinnedUI=e,FLBuilder.PinnedUI.init()})}(jQuery),!function(R){R.extend(FLBuilder,{_selectedNode:null,_initOverlays:function(){FLBuilder._bindGeneralOverlayEvents()},_bindGeneralOverlayEvents:function(){var e=FLBuilderLayout._isTouch(),t=R("body"),i=R("body",window.parent.document);t.on("contextmenu",".fl-block-overlay",FLBuilder._onOverlayContextMenu),FLBuilder.addHook("didStartNodeLoading",FLBuilder._removeAllOverlays),FLBuilder.addHook("didInitDrag",FLBuilder._deselectNodeOverlay),R(document).add(window.parent.document).on("keyup",FLBuilder._deselectNodeOverlayOnEsc),t.on("click",".fl-block-overlay",FLBuilder._deselectNodeOverlayOnClick),t.on("click",".fl-block-overlay-actions *",FLBuilder._deselectNodeOverlayOnActionsClick),i.on("click",".fl-builder-module-settings .fl-lightbox-footer button",FLBuilder._deselectNodeOverlay),i.on("click",".fl-builder-col-settings .fl-lightbox-footer button",FLBuilder._deselectNodeOverlay),i.on("click",".fl-builder-row-settings .fl-lightbox-footer button",FLBuilder._deselectNodeOverlay),i.on("click",FLBuilder._deselectNodeOverlay),t.on("click",FLBuilder._deselectNodeOverlay),t.on("click",".fl-block-overlay .fl-block-select-parent",FLBuilder._selectNodeParentOnIconClick),t.on("click",".fl-block-overlay .fl-block-select-parent-menu > li > a",FLBuilder._selectNodeParentOnMenuClick),t.on("mouseenter",".fl-block-overlay .fl-block-select-parent-menu a",FLBuilder._highlightNodeParentOnMenuHover),t.on("mouseleave",".fl-block-overlay .fl-block-select-parent-menu a",FLBuilder._removeNodeParentHighlight),t.on("mousedown",".fl-block-overlay .fl-block-select-parent-menu a",FLBuilder._removeNodeParentHighlight),t.on("click touchend",".fl-builder-has-submenu",FLBuilder._submenuParentClicked),t.on("mouseenter",".fl-builder-submenu-hover",FLBuilder._hoverMenuParentMouseEnter),t.on("mouseleave",".fl-builder-submenu-hover",FLBuilder._hoverMenuParentMouseLeave),t.on("click touchend",".fl-builder-has-submenu a",FLBuilder._submenuChildClicked),t.on("mouseenter",".fl-builder-submenu",FLBuilder._submenuMouseenter),t.on("mouseleave",".fl-builder-submenu",FLBuilder._submenuMouseleave),t.on("mouseenter",".fl-builder-submenu .fl-builder-has-submenu",FLBuilder._submenuNestedParentMouseenter),t.on("click touchend",".fl-block-overlay .fl-block-move-up",FLBuilder._moveNodeUpClicked),t.on("click touchend",".fl-block-overlay .fl-block-move-down",FLBuilder._moveNodeDownClicked),t.on("click touchend",".fl-block-overlay .fl-block-settings",FLBuilder._nodeSettingsClicked),t.on("click touchend",".fl-block-overlay .fl-block-copy",FLBuilder._nodeDuplicateClicked),t.on("click touchend",".fl-block-overlay .fl-block-remove",FLBuilder._nodeRemoveClicked),t.on("mousedown",".fl-row-overlay .fl-block-move, .fl-row-move",FLBuilder._rowDragInit),t.on("touchstart",".fl-row-overlay .fl-block-move, .fl-row-move",FLBuilder._rowDragInitTouch),t.on("click touchend",".fl-row-quick-copy",FLBuilder._rowCopySettingsClicked),t.on("click touchend",".fl-row-quick-paste",FLBuilder._rowPasteSettingsClicked),i.on("click",".fl-builder-row-settings .fl-builder-settings-save",FLBuilder._saveSettings),e?t.on("touchend",".fl-row-overlay",FLBuilder._rowSettingsClicked):t.on("click",".fl-row-overlay",FLBuilder._rowSettingsClicked),t.on("click touchend",".fl-builder-submenu .fl-block-row-reset",FLBuilder._resetRowWidthClicked),t.on("mousedown",".fl-col-overlay .fl-block-move, .fl-col-move",FLBuilder._colDragInit),t.on("touchstart",".fl-col-overlay .fl-block-move, .fl-col-move",FLBuilder._colDragInitTouch),t.on("click touchend",".fl-col-quick-copy",FLBuilder._colCopySettingsClicked),t.on("click touchend",".fl-col-quick-paste",FLBuilder._colPasteSettingsClicked),t.on("click touchend",".fl-builder-submenu .fl-block-col-reset",FLBuilder._resetColumnWidthsClicked),i.on("click",".fl-builder-col-settings .fl-builder-settings-save",FLBuilder._saveSettings),e?t.on("touchend",".fl-col-overlay",FLBuilder._colSettingsClicked):t.on("click",".fl-col-overlay",FLBuilder._colSettingsClicked),t.on("mousedown",".fl-module-overlay .fl-block-move, .fl-module-move",FLBuilder._moduleDragInit),t.on("touchstart",".fl-module-overlay .fl-block-move, .fl-module-move",FLBuilder._moduleDragInitTouch),t.on("click touchend",".fl-module-quick-copy",FLBuilder._moduleCopySettingsClicked),t.on("click touchend",".fl-module-quick-paste",FLBuilder._modulePasteSettingsClicked),t.on("click touchend",".fl-module-overlay .fl-block-col-settings",FLBuilder._colSettingsClicked),i.on("click",".fl-builder-module-settings .fl-builder-settings-save",FLBuilder._saveModuleClicked),e?t.on("touchend",".fl-module-overlay",FLBuilder._moduleSettingsClicked):t.on("click",".fl-module-overlay",FLBuilder._moduleSettingsClicked)},_bindOverlayEvents:function(){var e=R(FLBuilder._contentClass);e.on("mouseenter touchstart",".fl-row",FLBuilder._rowMouseenter),e.on("mouseleave",".fl-row",FLBuilder._rowMouseleave),e.on("mouseenter touchstart",".fl-col",FLBuilder._colMouseenter),e.on("mouseleave",".fl-col",FLBuilder._colMouseleave),e.on("mouseenter touchstart",".fl-module",FLBuilder._moduleMouseenter),e.on("mouseleave",".fl-module",FLBuilder._moduleMouseleave)},_destroyOverlayEvents:function(){var e=R(FLBuilder._contentClass);e.undelegate(".fl-row","mouseenter touchstart",FLBuilder._rowMouseenter),e.undelegate(".fl-row","mouseleave",FLBuilder._rowMouseleave),e.undelegate(".fl-col","mouseenter touchstart",FLBuilder._colMouseenter),e.undelegate(".fl-col","mouseleave",FLBuilder._colMouseleave),e.undelegate(".fl-module","mouseenter touchstart",FLBuilder._moduleMouseenter),e.undelegate(".fl-module","mouseleave",FLBuilder._moduleMouseleave)},_onOverlayContextMenu:function(e){R(this).hide()},_selectNodeOverlay:function(e,t=!0){var i=R("body"),l=R(".fl-node-selected");e.length&&(l.removeClass("fl-node-selected"),e.addClass("fl-node-selected"),i.removeClass("fl-block-overlay-muted"),FLBuilder._selectedNode=e.data("node"),FLBuilder._removeModuleOverlays(),FLBuilder._removeColOverlays(),FLBuilder._hideTipTips(),e.trigger("mouseover"),t)&&e.find("> .fl-block-overlay .fl-block-settings:not(.fl-builder-submenu-link)").eq(0).trigger("click")},_selectNodeParentOnIconClick:function(e){var t=R(this).closest("[data-node]").parents("[data-node]:not(.fl-col-group)").eq(0);FLBuilder._selectNodeOverlay(t),e.stopPropagation()},_selectNodeParentOnMenuClick:function(e){var t=R(this).data("target-node"),t=R(this).closest(`[data-node=${t}]`);FLBuilder._selectNodeOverlay(t),FLBuilder._removeNodeParentHighlight(),e.stopPropagation()},_highlightNodeParentOnMenuHover:function(){var e=R(this).data("target-node"),e=R(this).closest(`[data-node=${e}]`);FLBuilder._removeNodeParentHighlight(),e.hasClass("fl-block-overlay-active")?e.addClass("fl-overlay-highlight"):e.addClass("fl-node-highlight")},_removeNodeParentHighlight:function(){R(".fl-node-highlight").removeClass("fl-node-highlight"),R(".fl-overlay-highlight").removeClass("fl-overlay-highlight")},_getNodeParentMenuData:function(i){var e=i.parentsUntil(FLBuilder._contentClass,".fl-row, .fl-col, .fl-module").add(i),l=[];return e.length<=1?null:(e.each(function(e){var t=R(this);if(t.hasClass("fl-node-global")){if(t.hasClass("fl-row")&&"row"===FLBuilderConfig.userTemplateType)return;if(t.hasClass("fl-col")&&"column"===FLBuilderConfig.userTemplateType)return;if(t.hasClass("fl-module")&&"module"===FLBuilderConfig.userTemplateType&&t.data("node")===i.data("node"))return}l[e]={node:t.data("node")},t.hasClass("fl-row")?(l[e].name=FLBuilderStrings.row,l[e].type="row"):t.hasClass("fl-col")?(l[e].name=FLBuilderStrings.column,l[e].type="col"):(l[e].name=t.data("name"),l[e].type="module",l[e].moduleType=t.data("type"))}),l)},_deselectNodeOverlay:function(){var e=R(".fl-node-selected");e.removeClass("fl-node-selected"),e.removeClass("fl-block-overlay-active"),e.find("> .fl-block-overlay").remove(),FLBuilder._selectedNode=null},_deselectNodeOverlayOnEsc:function(e){"Escape"===e.key&&FLBuilder._deselectNodeOverlay()},_deselectNodeOverlayOnClick:function(e){R(this).closest("[data-node]").hasClass("fl-node-selected")&&e.stopImmediatePropagation(),FLBuilder._deselectNodeOverlay()},_deselectNodeOverlayOnActionsClick:function(e){R(this).closest("[data-node]").hasClass("fl-node-selected")||FLBuilder._deselectNodeOverlay()},_removeAllOverlays:function(){FLBuilder._removeRowOverlays(),FLBuilder._removeColOverlays(),FLBuilder._removeModuleOverlays(),FLBuilder._hideTipTips(),FLBuilder._closeAllSubmenus()},_removeRowOverlays:function(){var e=R(".fl-row:not(.fl-node-selected)");e.removeClass("fl-block-overlay-active"),e.find(".fl-row-overlay").remove(),e.find(".fl-module").removeClass("fl-module-adjust-height"),R("body").removeClass("fl-builder-row-resizing"),FLBuilder._closeAllSubmenus(),FL.Builder.data.getOutlinePanelActions().setFocusNode(!1)},_rowMouseenter:function(){var e,t,i,l,n,o,s,r,d,a,u;void 0!==FLBuilderSettingsConfig.nodes&&(t=(e=R(this)).attr("data-node"),i=e.offset().top,n=l=null,o=wp.template("fl-row-overlay"),s=FLBuilderResponsiveEditing._mode,r=FLBuilderSettingsConfig.nodes[t],d=t===FLBuilder._selectedNode,a=0===(u=e.parent().find("> .fl-row")).index(e),u=u.index(e)===u.length-1,d?FLBuilder._removeRowOverlays():e.closest(".fl-builder-node-loading").length||e.find(".fl-row-overlay").length||e.hasClass("fl-block-overlay-active")||(FLBuilder._removeRowOverlays(),n=FLBuilder._appendOverlay(e,o({node:t,global:e.hasClass("fl-node-global"),hasRules:e.hasClass("fl-node-has-rules"),rulesTextRow:e.attr("data-rules-text"),rulesTypeRow:e.attr("data-rules-type"),nodeLabel:r?.node_label,isFirst:a,isLast:u})),e.find(".fl-node-content:visible").each(function(){var e=R(this).offset().top;l=null===l||e<l?e:l}),null!==l&&l<i&&n.css("top",l-i-30+"px"),("default"===s&&n.offset().top<43||"default"!==s&&0===e.index())&&n.addClass("fl-row-overlay-header-bottom"),e.find(".fl-module").each(function(){var e=R(this);e.outerHeight(!0)<20&&e.addClass("fl-module-adjust-height")}),e.find(".fl-node-selected").length&&R("body").addClass("fl-block-overlay-muted"),e.hasClass("fl-node-has-rules"))||FLBuilder._buildOverlayOverflowMenu(n))},_rowMouseleave:function(e){var t=R(e.target),e=R(e.toElement)||R(e.relatedTarget),i=e.hasClass("fl-row-overlay"),l=0<e.closest(".fl-row-overlay").length,n=e.is("#tiptip_holder"),e=0<e.closest("#tiptip_holder").length;t.closest(".fl-block-col-resize").length||i||l||n||e||FLBuilder._removeRowOverlays()},_removeColOverlays:function(){var e=R(".fl-col:not(.fl-node-selected)");e.removeClass("fl-block-overlay-active"),e.find("> .fl-col-overlay").remove(),FLBuilder._closeAllSubmenus(),FL.Builder.data.getOutlinePanelActions().setFocusNode(!1)},_colMouseenter:function(e){var t,i,l,n,o,s,r,d,a,u,c,f,h,p,g,m,b,v,w,_,F,L,C;void 0===FLBuilderSettingsConfig.nodes||((r=(t=R(this)).closest(".fl-col-group")).attr("data-node"),i=r.hasClass("fl-col-group-has-child-loading"),l=t.hasClass("fl-node-global"),n=0<t.parents(".fl-node-global").length,o=t.closest(".fl-col-group").find("> .fl-col").length,s=0===(r=r.find("> .fl-col").index(t)),r=o===r+1,d=0<t.find(".fl-col").length,a=0<t.find(".fl-module").length,g=(p=t.parents(".fl-col")).closest(".fl-col-group"),u=0<p.length,c=void 0!==t.data("template-url"),f="column"==FLBuilderConfig.userTemplateType&&!u,h=u?g.find("> .fl-col").length:0,g=g.find("> .fl-col").index(p),p=u&&0===g,g=u&&h===g+1,m=!!t.closest(".fl-row").find(".fl-row-fixed-width").addBack(".fl-row-fixed-width").length,b=FLBuilderConfig.rowResize.userCanResizeRows,v=t.hasClass("fl-node-has-rules"),w=wp.template("fl-col-overlay"),_=null,F=t.attr("data-node"),F=FLBuilderSettingsConfig.nodes[F],L=t.hasClass("fl-node-selected"),C=FLBuilder._getNodeParentMenuData(t),FLBuilderConfig.simpleUi&&!l)||R(e.relatedTarget).closest(".fl-block-move-dir").length||l&&!L&&n&&a&&!c||l&&!L&&"column"==FLBuilderConfig.userTemplateType&&a||!l&&!L&&0<t.find(".fl-module").length||0<t.find(".fl-builder-node-loading-placeholder").length||!a&&d&&!L||n&&d&&!c||t.closest(".fl-builder-node-loading").length||t.parents(".fl-node-selected").length||(t.hasClass("fl-block-overlay-active")||(FLBuilder._removeColOverlays(),FLBuilder._removeModuleOverlays(),_=FLBuilder._appendOverlay(t,w({global:l,groupLoading:i,numCols:o,isFirst:s,isLast:r,isRootCol:f,hasChildCols:d,hasParentCol:u,parentFirst:p,parentLast:g,numParentCols:h,rowIsFixedWidth:m,userCanResizeRows:b,hasRules:v,nodeLabel:F?.node_label,parentMenu:C})),FLBuilder._buildOverlayOverflowMenu(_),FLBuilder._initColDragResizing()),t.closest(".fl-row.fl-node-selected").length)||R("body").addClass("fl-block-overlay-muted")},_colMouseleave:function(e){var t=R(this),e=R(e.toElement)||R(e.relatedTarget),i=0<t.find(".fl-module").length,l=(t.hasClass("fl-node-global"),void 0!==t.data("template-url")),n=e.is("#tiptip_holder"),e=0<e.closest("#tiptip_holder").length,t=t.hasClass("fl-node-selected");n||e||i&&!l||t||(R("body").removeClass("fl-block-overlay-muted"),FLBuilder._removeColOverlays(),FLBuilder._removeNodeParentHighlight(),FLBuilder._closeAllSubmenus())},_removeModuleOverlays:function(){var e=R(".fl-module:not(.fl-node-selected)");e.removeClass("fl-block-overlay-active"),e.find("> .fl-module-overlay").remove(),FLBuilder._closeAllSubmenus(),FL.Builder.data.getOutlinePanelActions().setFocusNode(!1)},_moduleMouseenter:function(e){var t,i,l,n,o,s,r,d,a,u,c,f,h,p,g,m,b,v,w,_,F,L,C,y,B,S,k,x,T,P,I;void 0===FLBuilderSettingsConfig.nodes||(S=(t=R(this)).attr("data-node"),i=FLBuilderSettingsConfig.nodes[S],l=t.attr("data-type"),n=t.attr("data-name"),o=t.hasClass("fl-node-global"),x=t.parent(),s=0<t.parents(".fl-node-global").length,r=t.parents(".fl-col-group").last().hasClass("fl-col-group-has-child-loading"),d=t.closest(".fl-col-group").find("> .fl-col").length,a=(L=t.closest(".fl-col")).index()<=0,L.attr("data-node"),u=d===L.index()+1,f=(c=0<(p=L.parents(".fl-col")).length)?p.closest(".fl-col-group").find("> .fl-col").length:0,h=c&&0===p.index(),p=c&&f===p.index()+1,(g=t.closest(".fl-row")).hasClass("fl-node-global"),g=!!g.find(".fl-row-fixed-width").addBack(".fl-row-fixed-width").length,m=FLBuilderConfig.rowResize.userCanResizeRows,b=t.hasClass("fl-node-has-rules"),v=t.attr("data-rules-text"),w=t.attr("data-rules-type"),_=L.attr("data-rules-text"),F=L.attr("data-rules-type"),L=L.hasClass("fl-node-has-rules"),C=FLBuilder._getNodeParentMenuData(t),y=0<t.parents(".fl-module").length,y="module"===FLBuilderConfig.userTemplateType&&!y,B=0<t.find('[data-parent="'+S+'"]').length,S=S===FLBuilder._selectedNode,k=0===(x=x.find("> [data-node]")).index(t),x=x.index(t)===x.length-1,T=FLBuilder._getNodeLayoutDirection(t),P=wp.template("fl-module-overlay"),I=null,R(e.relatedTarget).closest(".fl-block-move-dir").length)||o&&s&&!FLBuilderConfig.userTemplateType||(!o||FLBuilderConfig.userTemplateType)&&B&&!S||t.parents(".fl-node-selected").length||t.closest(".fl-builder-node-loading").length||t.find(".fl-inline-editor:visible").length||(t.hasClass("fl-block-overlay-active")||(FLBuilder._removeColOverlays(),FLBuilder._removeModuleOverlays(),(I=FLBuilder._appendOverlay(t,P({global:o,moduleType:l,moduleName:n,nodeLabel:i?.node_label,groupLoading:r,numCols:d,colFirst:a,colLast:u,hasParentCol:c,numParentCols:f,parentFirst:h,parentLast:p,rowIsFixedWidth:g,userCanResizeRows:m,hasRules:b,rulesTextModule:v,rulesTypeModule:w,rulesTextCol:_,rulesTypeCol:F,colHasRules:L,parentMenu:C,isRootModule:y,isFirst:k,isLast:x,layoutDirection:T}))).css({top:"-"+t.css("margin-top"),right:"-"+t.css("margin-right"),bottom:"-"+t.css("margin-bottom"),left:"-"+t.css("margin-left"),height:"auto"}),FLBuilder._buildOverlayOverflowMenu(I),FLBuilder._initColDragResizing()),t.closest(".fl-row.fl-node-selected").length)||R("body").addClass("fl-block-overlay-muted")},_moduleMouseleave:function(e){var t=R(this),i=0<t.parents(".fl-module.fl-node-global").length,e=R(e.toElement)||R(e.relatedTarget),l=e.is("#tiptip_holder"),e=0<e.closest("#tiptip_holder").length,t=t.hasClass("fl-node-selected");i||l||e||t||(R("body").removeClass("fl-block-overlay-muted"),FLBuilder._removeModuleOverlays(),FLBuilder._removeNodeParentHighlight())},_appendOverlay:function(e,t){var i=0,l=null,n=e.hasClass("fl-row"),o=e.attr("data-node"),n=n?e.find("> .fl-row-content-wrap"):e.find("> .fl-node-content"),s=parseInt(n.css("margin-top"),10),n=parseInt(n.css("margin-bottom"),10);return e.append(t),e.addClass("fl-block-overlay-active"),FL.Builder.data.getOutlinePanelActions().setFocusNode(o),FLBuilder._initTipTips(),l=e.find("> .fl-block-overlay"),s<0&&(i=parseInt(l.css("top"),10),i=isNaN(i)?0:i,l.css("top",s+i+"px")),n<0&&(i=parseInt(l.css("bottom"),10),i=isNaN(i)?0:i,l.css("bottom",n+i+"px")),l},_resizeOverlay:function(e){var t,i,l,n;e.hasClass("fl-module-overlay")&&(n=(t=e.closest(".fl-module")).parents(".fl-module"),l=FLBuilder._getNodeLayoutDirection(t),n.length)&&"horizontal"===l&&!t.next(".fl-module").length&&(l=t.siblings(".fl-module"),i=0,l.each(function(){i+=R(this).outerWidth(!0)}),e.width(n.width()-i),l=e[0].getBoundingClientRect(),n=n[0].getBoundingClientRect(),l.right>n.right&&e.width(l.width-(l.right-n.right)),e.width()<t.width())&&e.width(t.width())},_buildOverlayOverflowMenu:function(e){var t,i=e.find(".fl-block-overlay-header"),l=e.find(".fl-block-overlay-actions"),n=e.find(".fl-block-has-rules"),o=l.data("original"),s=null,r=0,d=null,a=0,u=[],c=[],f=[],h=wp.template("fl-overlay-overflow-menu");for(FLBuilder._resizeOverlay(e),null!=o&&(l.after(o),l.remove(),l=o),l.data("original",l.clone()),e=parseInt(l.css("padding-left")),o=parseInt(l.css("padding-right")),t=l.outerWidth()-e-o,s=l.find(" > i, > span"),n.length&&t+n.outerWidth()>i.outerWidth()&&(r+=n.outerWidth()),l.css("max-width","none");a<s.length;a++)d=s.eq(a),t<(r+=Math.floor(d[0].getBoundingClientRect().width))?(c.push(d),d.remove()):u.push(d);if(l.css("max-width","100%"),0<c.length){for(0<u.length&&c.unshift(u.pop().remove()),a=0;a<c.length;a++)c[a].is(".fl-builder-has-submenu")?f.push({type:"submenu",label:c[a].find(".fa, .fas, .far, svg, span").data("title"),submenu:c[a].find(".fl-builder-submenu")[0].outerHTML,className:c[a].find("> span, > i, > svg").removeClass(function(e,t){return t.replace(/fl-block-([^\s]+)/,"")}).attr("class")}):f.push({type:"action",label:c[a].data("title"),className:c[a].removeClass(function(e,t){return t.replace(/fl-block-([^\s]+)/,"")}).attr("class")});l.append(h(f)),FLBuilder._initTipTips()}}}),R(function(){FLBuilder._initOverlays()})}(jQuery),!function(r){var i={init:function(){this.setupMainMenuData(),r(".fl-builder--revision-actions select",window.parent.document).on("change",this.selectChanged),r(".fl-cancel-revision-preview",window.parent.document).on("click",this.exitPreview.bind(this)),r(".fl-apply-revision-preview",window.parent.document).on("click",this.applyClicked.bind(this)),FLBuilder.addHook("revisionItemClicked",this.itemClicked.bind(this)),FLBuilder.addHook("didPublishLayout",this.refreshItems.bind(this))},setupMainMenuData:function(){var e,t,i=FLBuilderConfig.revisions.posts,l=FLBuilderConfig.revisions.authors,n=wp.template("fl-revision-list-item"),o=r(".fl-builder--revision-actions select",window.parent.document),s=0;if(FLBuilderConfig.mainMenu.revisions.items=[],o.html(""),0===i.length)FLBuilderConfig.mainMenu.revisions.items.push({eventName:"noRevisionsMessage",type:"event",label:wp.template("fl-no-revisions-message")()});else for(;s<i.length;s++)e=FLBuilderStrings.revisionDate.replace("%s",i[s].date.diff),e+=" ("+i[s].date.published+")",t=FLBuilderStrings.revisionAuthor.replace("%s",l[i[s].author].name),FLBuilderConfig.mainMenu.revisions.items.push({eventName:"revisionItemClicked",type:"event",label:n({id:i[s].id,date:e,author:t,avatar:l[i[s].author].avatar})}),o.append('<option value="'+i[s].id+'">'+e+"</option>");void 0!==FLBuilder.MainMenu&&FLBuilder.MainMenu.renderPanel("revisions")},refreshItems:function(){FLBuilderConfig.iframeEnabled||FLBuilder.ajax({action:"refresh_revision_items"},this.refreshItemsComplete.bind(this))},refreshItemsComplete:function(e){FLBuilderConfig.revisions=FLBuilder._jsonParse(e),this.setupMainMenuData()},itemClicked:function(e,t){t=r(t).find(".fl-revision-list-item").attr("data-revision-id");FLBuilder._triggerSettingsSave(!1,!0)&&(r(".fl-builder--revision-actions select",window.parent.document).val(t),this.preview(t))},selectChanged:function(e){i.preview(r(this).val())},applyClicked:function(e){var t=r(".fl-builder--revision-actions select",window.parent.document).val();i.restore(t)},preview:function(e){r(".fl-builder--revision-actions",window.parent.document).css("display","flex"),FLBuilder.triggerHook("didEnterRevisionPreview"),FLBuilder.showAjaxLoader(),FLBuilder.ajax({action:"render_revision_preview",revision_id:e},this.previewRenderComplete.bind(this))},previewRenderComplete:function(e){FLBuilder._renderLayout(e,function(){FLBuilder._destroyOverlayEvents(),FLBuilder._removeAllOverlays()})},exitPreview:function(){r(".fl-builder--revision-actions",window.parent.document).hide(),FLBuilder.triggerHook("didExitRevisionPreview"),FLBuilder._bindOverlayEvents(),FLBuilder._updateLayout()},restore:function(e){r(".fl-builder--revision-actions",window.parent.document).hide(),FLBuilder.triggerHook("didExitRevisionPreview"),FLBuilder.showAjaxLoader(),FLBuilder._bindOverlayEvents(),FLBuilder.ajax({action:"restore_revision",revision_id:e},i.restoreComplete)},restoreComplete:function(e){e=FLBuilder._jsonParse(e);FLBuilder._renderLayout(e.layout),FLBuilder.triggerHook("didRestoreRevisionComplete",e.config),void 0!==(settings=e.settings).css&&null!==settings.css&&(FLBuilderSettingsConfig.settings.layout.css=settings.css),void 0!==settings.js&&null!==settings.js&&(FLBuilderSettingsConfig.settings.layout.js=settings.js)}};r(function(){i.init()})}(jQuery),!function(){var t={query:function(e){var t,i={},l={library:{}};if(e=this.normalizeQuery(e),_.isNull(e.kind))i=FLBuilderConfig.contentItems;else for(var n in e.kind)i[n=e.kind[n]]=FLBuilderConfig.contentItems[n];return t=this.findMatches(e,i),l.library=this.formatResults(t,e),l},normalizeQuery:function(e){return e=_.extend({kind:null,type:null,category:null,group:null,enabled:!0,global:null,searchTerm:null,categorized:!1},e),_.isString(e.kind)&&(e.kind=[e.kind]),e},findMatches:function(e,t){var i,l,n,o,s={},r=null,d=null;for(r in t)for(d in i=t[r],s[r]={items:[]},i)if(l=i[d],_.isUndefined(e.category)||_.isNull(e.category)||this.matchesCategory(l.category,e.category)){switch(r){case"template":if(!(_.isUndefined(e.content)||_.isNull(e.content)||(n=_.includes(e.content,l.content),o=e.content===l.content,n)||o))continue;if(!_.isUndefined(e.type)&&!_.isNull(e.type)&&e.type!==l.type)continue;if(!_.isNull(e.group)){var a=e.group,u=l.group;if(_.isString(a)&&(a=[a]),_.isString(u)&&(u=[u]),_.isEmpty(a)||_.isEmpty(u))continue;var c=!1;for(d in a){var f=a[d];_.includes(u,f)&&(c=!0)}if(!c)continue}break;case"module":if(!_.isNull(e.group)){if(!1===e.group&&0<l.group.length)continue;if(!1!==e.group&&!_.includes(l.group,e.group))continue}}(_.isUndefined(e.searchTerm)||_.isNull(e.searchTerm)||this.matchesSearchTerm(l,e.searchTerm))&&s[r].items.push(l)}return s},matchesCategory:function(e,t){var i,l,n,o;if(e===t)return!0;for(l in t=_.isString(t)?[t]:t){if(i=t[l],_.isString(e)&&e===i)return!0;if(_.isArray(e))for(n in e)if(e[n]===i)return!0;if(_.isObject(e))for(o in e)if(e[o]===i||o===i)return!0}return!1},matchesSearchTerm:function(e,t){var i=t.toLowerCase();return!((_.isUndefined(e.slug)||!e.slug.toLowerCase().includes(i))&&(_.isUndefined(e.name)||!e.name.toLowerCase().includes(i))&&(!_.isString(e.category)||!e.category.toLowerCase().includes(i))&&(_.isUndefined(e.description)||!e.description.toLowerCase().includes(i))&&(_.isUndefined(e.id_base)||!e.id_base.includes(t))&&(!e.isWidget||!"widget".includes(i))&&(_.isUndefined(e.editor_export)||!"module".includes(i)))},formatResults:function(e,t){if(t.categorized)for(type in e){var i=e[type].items;e[type].categorized=this.groupBy(i,"category")}return e},groupBy:function(e,i){var n,o,s={};return _.forEach(e,function(l,e,t){n=l[i],_.isNull(n)||_.isUndefined(n)||_.isString(n)&&""===l[n]||(_.isString(n)&&(s[n]=s[n]||[],s[n].push(l)),_.isArray(n)&&(o=n,_.forEach(o,function(e,t,i){s[e]=s[e]||[],s[e].push(l)})),_.isObject(n)&&(o=n,_.forEach(o,function(e,t,i){s[e]=s[e]||[],s[e].push(l)})))}),s},search:function(e){var t=this.query({searchTerm:e}),i={total:0,term:e,sections:{}};if(!_.isUndefined(t.library.module.items)){var l,n={};for(l in t.library.module.items){var o=t.library.module.items[l],s=o.group[0],r=o.category;o.name;_.isUndefined(n[s])&&(n[s]={}),_.isUndefined(n[s][r])&&(n[s][r]=[]),n[s][r].push(o)}i.grouped=n}for(l in t.library){var d=t.library[l];!_.isUndefined(d.items)&&0<d.items.length&&(i.sections[l]={name:FLBuilderStrings.typeLabels[l],handle:l,type:"",items:d.items},i.total+=d.items.length)}return i}};FLBuilder.Search={byQuery:function(e){return t.query(e)},byTerm:function(e){return t.search(e)}}}(jQuery),!function(i,l){var n={layoutNeedsPublish:!1,defaultIndicatorMessage:"",defaultTooltipMessage:"",messages:null,init:function(){this.messages=FLBuilderStrings.savedStatus,this.$savingIndicator=i(".fl-builder--saving-indicator",window.parent.document),l.addHook("didBeginAJAX",this.onLayoutSaving.bind(this)),l.addHook("didCompleteAJAX",this.onLayoutSaved.bind(this)),l.addHook("didPublishLayout",this.onLayoutPublished.bind(this)),l.addHook("publishAndRemain",this.onPublishAndRemain.bind(this)),l.addHook("didShowLightbox",this.setLayoutNeedsPublish.bind(this)),!FLBuilderConfig.layoutHasDraftedChanges&&FLBuilderConfig.builderEnabled||(this.setLayoutNeedsPublish(),this.resetStatusMessage())},setLayoutNeedsPublish:function(){this.layoutNeedsPublish||(this.layoutNeedsPublish=!0,i("body").add("body",window.parent.document).addClass("fl-builder--layout-has-drafted-changes"))},onLayoutSaving:function(e,t){this.isPublishingLayout(t.action)?this.showStatusMessage(this.messages.publishing,this.messages.publishingTooltip):this.isUpdatingLayout(t.action)&&(this.setLayoutNeedsPublish(),this.showStatusMessage(this.messages.saving,this.messages.savingTooltip))},isPublishingLayout:function(e){return"save_layout"==e},isUpdatingLayout:function(e){return!(this.isPublishingLayout()||(e.startsWith("render")?!e.startsWith("render_new"):e.startsWith("duplicate")||e.startsWith("refresh")||"save_ui_skin"==e||"save_lightbox_position"==e||"save_pinned_ui_position"==e||"fl_builder_notifications"==e||-1<e.indexOf("history")))},onLayoutSaved:function(e,t){var i;this.isUpdatingLayout(t.fl_builder_data.action)&&(this.showStatusMessage(this.messages.saved,this.messages.savedTooltip),i=this,setTimeout(function(){i.resetStatusMessage()},2e3))},onLayoutPublished:function(){this.layoutNeedsPublish=!1,i("body").add("body",window.parent.document).removeClass("fl-builder--layout-has-drafted-changes"),this.resetStatusMessage()},showStatusMessage:function(e,t){this.$savingIndicator.html(e),l.isUndefined(t)||(this.$savingIndicator.attr("title",t),i(".fl-builder--saving-indicator",window.parent.document).tipTip({defaultPosition:"bottom",edgeOffset:14}))},resetStatusMessage:function(){this.layoutNeedsPublish?(this.defaultIndicatorMessage=this.messages.edited+'<i class="fas fa-question-circle"></i>',this.defaultTooltipMessage=this.messages.editedTooltip):(this.defaultIndicatorMessage="",this.defaultTooltipMessage=""),this.showStatusMessage(this.defaultIndicatorMessage,this.defaultTooltipMessage)},onPublishAndRemain:function(){var e;l.MainMenu.hide(),this.layoutNeedsPublish||FLBuilderSettingsForms.settingsHaveChanged()?l._publishLayout(!1,!0):(this.showStatusMessage(this.messages.noChanges),e=this,setTimeout(function(){e.resetStatusMessage()},2e3))}};l.SaveManager={layoutNeedsPublish:function(){return n.layoutNeedsPublish},showStatusMessage:function(e,t){n.showStatusMessage(e,t)},resetStatusMessage:function(){n.resetStatusMessage()}},i(function(){n.init()})}(jQuery,FLBuilder),!function(n){FLBuilderHistoryManager={states:[],position:0,rendering:!1,init:function(){var e=FLBuilderConfig.history,l=this;this.states=e.states,this.position=parseInt(e.position),this.setupMainMenuData(),n.each(e.hooks,function(e,i){FLBuilder.addHook(e,function(e,t){l.saveCurrentState(i,t)})}),FLBuilder.addHook("didPublishLayout",this.clearStatesOnPublish.bind(this)),FLBuilder.addHook("restartEditingSession",this.saveCurrentStateOnRestartSession.bind(this)),FLBuilder.addHook("historyItemClicked",this.itemClicked.bind(this)),FLBuilder.addHook("undo",this.onUndo.bind(this)),FLBuilder.addHook("redo",this.onRedo.bind(this))},saveCurrentState:function(e,t){var i=null;void 0!==(t=void 0===t?{}:t).moduleType&&t.moduleType&&(i=t.moduleType),FL.Builder.data.getLayoutActions().saveHistoryState(e,i)},saveCurrentStateOnRestartSession:function(e){this.states.length||this.saveCurrentState("draft_created")},clearStatesOnPublish:function(e,t){this.states=[],this.position=0,this.setupMainMenuData(),FL.Builder.data.getLayoutActions().clearHistoryStates(FLBuilderConfig.postId,t.shouldExit)},renderState:function(e){var t,i=this;this.rendering||!this.states.length||n(".fl-builder-settings:visible",window.parent.document).length||(t=setTimeout(FLBuilder.showAjaxLoader,2e3),this.rendering=!0,FL.Builder.data.getLayoutActions().renderHistoryState(e,function(e){e=FLBuilder._jsonParse(e);e.error||(i.position=parseInt(e.position),FLBuilder.triggerHook("didRestoreHistoryComplete",e),FLBuilder._renderLayout(e.layout),i.setupMainMenuData()),clearTimeout(t),i.rendering=!1}))},onUndo:function(){FL.Builder.data.getLayoutActions().undo()},onRedo:function(){FL.Builder.data.getLayoutActions().redo()},setupMainMenuData:function(){var e=FLBuilderConfig.history.labels,t="";FLBuilderConfig.mainMenu.history.items=[];for(var i=this.states.length-1;0<=i;i--)"string"==typeof this.states[i]?t=e[this.states[i]]||this.states[i]:(t=e[this.states[i].label]||this.states[i].label,(this.states[i].moduleType||-1<this.states[i].label.indexOf("module"))&&(t=t.replace("%s",this.getModuleName(this.states[i].moduleType)))),FLBuilderConfig.mainMenu.history.items.push({eventName:"historyItemClicked",type:"event",label:wp.template("fl-history-list-item")({label:t,current:i===this.position?1:0,position:i})});FLBuilderConfig.history.enabled?this.states.length<1&&FLBuilderConfig.mainMenu.history.items.push({eventName:"historyItemClicked",type:"event",label:wp.template("fl-history-list-item")({label:"No history found",current:0,position:0})}):FLBuilderConfig.mainMenu.history.items.push({eventName:"historyItemClicked",type:"event",label:wp.template("fl-history-list-item")({label:FLBuilderConfig.history.labels.history_disabled,current:0,position:0})}),void 0!==FLBuilder.MainMenu&&FLBuilder.MainMenu.renderPanel("history")},getModuleName:function(e){var t=FLBuilderConfig.contentItems.module,i=0;if("widget"===e)return FLBuilderStrings.widget;for(;i<t.length;i++)if(void 0!==t[i].slug&&e===t[i].slug)return t[i].name;return FLBuilderStrings.module},itemClicked:function(e,t){var t=n(t).find(".fl-history-list-item"),i=t.attr("data-position"),l=n(".fl-history-list-item[data-current=1]",window.parent.document);n(".fl-builder-settings:visible",window.parent.document).length&&(FLBuilder._closeNestedSettings(),FLBuilder._lightbox.close()),l.attr("data-current",0),t.attr("data-current",1),this.renderState(i)}},n(function(){FLBuilderHistoryManager.init()})}(jQuery),!function(n){const o={types:["loop"],init:()=>{FLBuilder.addHook("didAddModule",o.moduleAdded),FLBuilder.addHook("didMoveNode",o.moduleAdded),FLBuilder.addHook("didAddRow",o.rowAdded),FLBuilder.addHook("didAddColumnGroup",o.columnAdded),FLBuilder.addHook("didSaveNodeSettings",o.moduleAdded),FLBuilder.addHook("didDuplicateModule",o.copyModule),FLBuilder.addHook("didApplyModuleTemplateComplete",o.moduleTemplateAdded)},getLoopContainer:e=>{var t,i=n(".fl-node-"+e);for(t in o.types){var l=i.parents(`[data-type="${o.types[t]}"]`).last();if(l.length)return l}return null},updateLoopForChild:e=>{e=o.getLoopContainer(e);e&&FLBuilder._updateNode(e.attr("data-node"))},copyModule:(e,{oldNodeId:t})=>{o.updateLoopForChild(t)},moduleTemplateAdded:(e,{nodes:t})=>{n.each(t,function(e){setTimeout(function(){n(".fl-node-"+e);1==n(".fl-module.fl-node-"+e).length&&o.updateLoopForChild(e)},20)})},moduleAdded:(e,{nodeId:t})=>{o.updateLoopForChild(t)},columnAdded:(e,t)=>{t=n(".fl-node-"+t).find(".fl-col-content").find(".fl-module").attr("data-node");1<n(".fl-node-"+t).length&&o.updateLoopForChild(t)},rowAdded:(e,t)=>{t=n(".fl-node-"+t).find(".fl-row-content").find(".fl-module").attr("data-node");1<n(".fl-node-"+t).length&&o.updateLoopForChild(t)}};n(o.init)}(jQuery),!function(exports){"use strict";exports.stringify=function(e){return JSON.stringify(e,function(e,t){var i;return t instanceof Function||"function"==typeof t?(i=t.toString()).length<8||"function"!==i.substring(0,8)?"_NuFrRa_"+i:i:t instanceof RegExp?"_PxEgEr_"+t:t})},exports.parse=function(str,date2obj){var iso8061=!!date2obj&&/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;return JSON.parse(str,function(key,value){var prefix;return"string"!=typeof value?value:value.length<8?value:(prefix=value.substring(0,8),iso8061&&value.match(iso8061)?new Date(value):"function"===prefix?eval("("+value+")"):"_PxEgEr_"===prefix||"_NuFrRa_"===prefix?eval(value.slice(8)):value)})},exports.clone=function(e,t){return exports.parse(exports.stringify(e),t)}}("undefined"==typeof exports?window.JSONfn={}:exports);